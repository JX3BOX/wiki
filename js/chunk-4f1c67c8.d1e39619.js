(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f1c67c8"],{"037d":function(e,t,n){"use strict";n("f347")},"07bd":function(e,t,n){"use strict";n.r(t);n("99af"),n("b0c0");var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-knowledge-mobile-index c-var"},[t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],ref:"pageContainer",staticClass:"m-page-container",attrs:{"infinite-scroll-disabled":"disabled","infinite-scroll-distance":"10"}},[e.searchKey||e.type?e._e():t("div",{staticClass:"m-big-search",on:{click:e.openDrawer}},[t("svg",{class:"u-search-icon",attrs:{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M16.25 14h-.79l-.28-.27a6.47 6.47 0 001.57-4.23 6.5 6.5 0 10-6.5 6.5c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L21.24 19l-4.99-5zm-6 0c-2.49 0-4.5-2.01-4.5-4.5S7.76 5 10.25 5s4.5 2.01 4.5 4.5-2.01 4.5-4.5 4.5z",fill:"currentColor"}})]),e._m(0)]),e.searchKey||e.type?t("div",{staticClass:"m-section-header"},[t("span",{staticClass:"u-title"},[e._v(e._s(e.typeName||"搜索结果"))]),e.type||e.searchKey?t("span",{staticClass:"u-back",on:{click:e.goHome}},[e._v("返回首页")]):e._e()]):e._e(),e.searchKey||e.type?t("div",{staticClass:"m-content-body"},[t("div",{staticClass:"m-list list"},e._l(e.list,(function(n,s){return t("div",{key:s,staticClass:"m-knowledge-card",on:{click:function(t){return e.handleItemClick(n)}}},[t("div",{staticClass:"m-knowledge-title"},[e._v(" "+e._s(n.name)+" ")]),t("i",{staticClass:"el-icon-arrow-right"})])})),0),t("div",{staticClass:"m-status"},[e.loading?t("div",{staticClass:"u-loading"},[t("i",{staticClass:"el-icon-loading"}),e._v(" 加载中...")]):e._e(),e.finished&&e.list.length?t("div",{staticClass:"u-no-more"},[e._v("End")]):e._e(),e.finished&&!e.list.length?t("div",{staticClass:"u-empty"},[e._v("暂无相关数据")]):e._e()])]):[t("div",{staticClass:"m-home-sections"},e._l(e.homeSections,(function(n,s){return t("div",{key:"".concat(n.key).concat(s),staticClass:"m-section"},[t("div",{staticClass:"m-section-header"},[t("span",{staticClass:"u-title"},[e._v(e._s(n.label))]),t("span",{staticClass:"u-more",on:{click:function(t){return e.enterCategory(n.key)}}},[e._v(" 更多 ")])]),n.blocks?e._l(n.blocks,(function(n,s){return t("div",{key:s,staticClass:"m-section-body",class:n.layout||"list"},e._l(n.list,(function(n,s){return t("div",{key:s,staticClass:"m-knowledge-card",on:{click:function(t){return e.handleItemClick(n)}}},[t("div",{staticClass:"m-knowledge-title",domProps:{innerHTML:e._s(n.name)}}),t("i",{staticClass:"el-icon-arrow-right"})])})),0)})):t("div",{staticClass:"m-section-body",class:n.layout||"list"},e._l(n.list,(function(n,s){return t("div",{key:s,staticClass:"m-knowledge-card",on:{click:function(t){return e.handleItemClick(n)}}},[t("div",{staticClass:"m-knowledge-title",domProps:{innerHTML:e._s(n.name)}}),t("i",{staticClass:"el-icon-arrow-right"})])})),0)],2)})),0)]],2),t("knowledge-search-drawer",{ref:"drawer",attrs:{menus:e.menus}}),t("suspend-common",{ref:"suspendCommon",staticClass:"u-suspend-common",staticStyle:{width:"100%"},attrs:{"btn-options":{showHome:!0,showIcon:!1,showMore:!0},"drawer-options":{hideType:["collect","rss","laterOn","user","report","pin"],direction:"btt"}},on:{search:e.openDrawer},scopedSlots:e._u([{key:"default",fn:function(){return[t("div",{staticClass:"m-more-action"},[t("div",{staticClass:"u-action",on:{click:e.openDrawer}},[t("svg",{attrs:{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[t("path",{attrs:{d:"M16.25 14h-.79l-.28-.27a6.47 6.47 0 001.57-4.23 6.5 6.5 0 10-6.5 6.5c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L21.24 19l-4.99-5zm-6 0c-2.49 0-4.5-2.01-4.5-4.5S7.76 5 10.25 5s4.5 2.01 4.5 4.5-2.01 4.5-4.5 4.5z",fill:"currentColor"}})]),e._v(" "+e._s(e.displaySearchDesc||"搜索内容")+" ")])])]},proxy:!0}])})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"u-info"},[t("span",{staticClass:"u-title"},[e._v("通识百科")]),t("span",{staticClass:"u-tip"},[e._v("点击开始搜索内容")])])}],a=n("c7eb"),c=n("b85c"),r=n("1da1"),o=n("2909"),l=(n("4de4"),n("7db0"),n("caad"),n("a15b"),n("d81d"),n("14d9"),n("fb6a"),n("d3b7"),n("2532"),n("3ca3"),n("9911"),n("159b"),n("ddb0"),function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",e._b({staticClass:"c-knowledge-drawer-mobile c-var",staticStyle:{width:"100%"},attrs:{visible:e.visible,direction:"btt","show-close":!1,"with-header":!1,"custom-class":"knowledge-search-drawer","append-to-body":"",size:"500px"},on:{close:e.onClose},scopedSlots:e._u([{key:"default",fn:function(){return[t("div",{staticClass:"m-knowledge-search-drawer"},[e.showMode?e._e():[t("div",{staticClass:"m-title"},[e._v("关键词")]),t("el-input",{staticClass:"u-input",attrs:{placeholder:"请输入关键词",clearable:""},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),t("div",{staticClass:"m-title"},[e._v("分类")]),t("div",{staticClass:"u-menu",on:{click:function(t){return e.openMenu("type")}}},[e._v(" "+e._s(e.currentMenuLabel||"全部")+" "),t("i",{staticClass:"el-icon-arrow-right"})])],"type"==e.showMode?[t("div",{staticClass:"m-header"},[t("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){e.showMode=""}}}),t("span",{staticClass:"m-title-center"},[e._v("选择分类")])]),t("div",{staticClass:"m-options-list"},[t("div",{staticClass:"m-options-item",class:{"is-active":!e.type},on:{click:function(t){return e.changeType(null)}}},[e._v(" 全部 "),e.type?e._e():t("div",{staticClass:"w-checkbox__icon"},[t("div",{staticClass:"w-checkbox__checkmark"})])]),e._l(e.menus,(function(n,s){return t("div",{key:s,staticClass:"m-options-item",class:{"is-active":n.name==e.type},on:{click:function(t){return e.changeType(n.name)}}},[e._v(" "+e._s(n.label)+" "),n.name==e.type?t("div",{staticClass:"w-checkbox__icon"},[t("div",{staticClass:"w-checkbox__checkmark"})]):e._e()])}))],2)]:e._e(),e.showMode?e._e():t("div",{staticClass:"m-op"},[t("button",{staticClass:"u-reset",on:{click:e.resetVal}},[e._v("重置")]),t("button",{staticClass:"u-confirm",on:{click:e.changeValue}},[e._v("确定")])])],2)]},proxy:!0}])},"el-drawer",e.$attrs,!1))],1)}),u=[],d={name:"KnowledgeSearchDrawer",props:{menus:{type:Array,default:function(){return[]}}},data:function(){return{visible:!1,showMode:"",searchKey:"",type:null,callback:{}}},computed:{currentMenuLabel:function(){var e,t=this;return this.type?(null===(e=this.menus.find((function(e){return e.name==t.type})))||void 0===e?void 0:e.label)||this.type:"全部"}},methods:{open:function(e){var t=this;return this.visible=!0,this.searchKey=(null===e||void 0===e?void 0:e.searchKey)||"",this.type=(null===e||void 0===e?void 0:e.type)||null,new Promise((function(e,n){t.callback={resolve:e,reject:n}}))},onClose:function(){this.visible=!1,this.callback.reject&&this.callback.reject()},resetVal:function(){this.searchKey="",this.type=null},changeValue:function(){this.visible=!1,this.callback.resolve&&this.callback.resolve({searchKey:this.searchKey,type:this.type})},openMenu:function(e){this.showMode=e},changeType:function(e){this.type=e,this.showMode=""}}},h=d,p=(n("037d"),n("2877")),f=Object(p["a"])(h,l,u,!1,null,null,null),v=f.exports,m=n("c1cc"),y=n("434b"),b={name:"MobileKnowledgeIndex",components:{KnowledgeSearchDrawer:v,SuspendCommon:m["a"]},data:function(){return{loading:!1,list:[],page:1,total:0,per:20,searchKey:"",type:null,menus:[],homeSections:[]}},computed:{finished:function(){return!(this.page<=1)&&this.list.length>=this.total},disabled:function(){return!this.type&&!this.searchKey||(this.loading||this.finished)},typeName:function(){var e,t=this;return this.type?(null===(e=this.menus.find((function(e){return e.name==t.type})))||void 0===e?void 0:e.label)||this.type:""},displaySearchDesc:function(){var e="";return this.type&&(e+=this.typeName),this.searchKey&&(e&&(e+=","),e+=this.searchKey),e}},methods:{loadMore:function(){var e=this;if((this.type||this.searchKey)&&!this.loading&&!this.finished){this.loading=!0;var t={page:this.page,per:this.per};this.searchKey&&(t._search=this.searchKey),this.type&&(t.type=this.type),Object(y["b"])(t).then((function(t){var n=t.data.data;1===e.page?(e.list=n.list||[],e.total=n.total):e.list=[].concat(Object(o["a"])(e.list),Object(o["a"])(n.list||[])),e.page++})).finally((function(){e.loading=!1}))}},openDrawer:function(){var e=this;this.$refs.drawer.open({searchKey:this.searchKey,type:this.type}).then((function(t){t&&(e.searchKey=t.searchKey,e.type=t.type,e.reset())})).catch((function(e){}))},reset:function(){this.page=1,this.list=[],this.total=0,this.loadMore(),window.scrollTo(0,0)},goHome:function(){this.type=null,this.searchKey="",this.list=[]},enterCategory:function(e){this.type=e,this.reset()},loadMenus:function(){var e=this;Object(y["c"])().then((function(t){e.menus=t.data.data||[],e.initHomeSections()}))},initHomeSections:function(){var e=this;return Object(r["a"])(Object(a["a"])().mark((function t(){var n,s,i,r,l,u,d,h,p,f,v,m,b,w,g,k,C,_,x;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=[],s=e.menus.find((function(e){return"game"===e.name})),!s){t.next=16;break}return i=["guide-pve","guide-pvp","guide-pvx"],t.prev=4,t.next=7,Object(y["d"])({key:i.join(",")});case 7:r=t.sent,l=[],i.forEach((function(e){var t=r.find((function(t){return t.name===e}));t&&t.menus&&l.push.apply(l,Object(o["a"])(t.menus.slice(0,2).map((function(e){return{name:e.label,link:e.link}}))))})),n.push({key:"game",label:"玩法",layout:"grid",list:l}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](4),console.error("Failed to load guide groups",t.t0);case 16:u=["game","player","organization"],d=e.menus.filter((function(e){return!u.includes(e.name)})),h=Object(c["a"])(d),t.prev=19,f=Object(a["a"])().mark((function e(){var t,s;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=p.value,s={key:t.name,label:t.label,layout:"list",list:[]},Object(y["b"])({type:s.key,per:5,page:1}).then((function(e){s.list=e.data.data.list||[]})),n.push(s);case 4:case"end":return e.stop()}}),e)})),h.s();case 22:if((p=h.n()).done){t.next=26;break}return t.delegateYield(f(),"t1",24);case 24:t.next=22;break;case 26:t.next=31;break;case 28:t.prev=28,t.t2=t["catch"](19),h.e(t.t2);case 31:return t.prev=31,h.f(),t.finish(31);case 34:if(v=e.menus.find((function(e){return"player"===e.name})),!v){t.next=45;break}return t.next=38,Object(y["b"])({type:"player",per:4,page:1}).catch((function(){return{data:{data:{list:[]}}}}));case 38:return k=t.sent,t.next=41,Object(y["b"])({type:"organization",per:2,page:1}).catch((function(){return{data:{data:{list:[]}}}}));case 41:C=t.sent,_=(null===(m=k.data)||void 0===m||null===(b=m.data)||void 0===b?void 0:b.list)||[],x=(null===(w=C.data)||void 0===w||null===(g=w.data)||void 0===g?void 0:g.list)||[],(_.length||x.length)&&n.push({key:"player",label:"玩家&组织",blocks:[{layout:"grid",list:_},{layout:"list",list:x}]});case 45:e.homeSections=n;case 46:case"end":return t.stop()}}),t,null,[[4,13],[19,28,31,34]])})))()},handleItemClick:function(e){e.link?window.location.href=e.link:e.id&&this.$router.push({name:"view",params:{source_id:e.id}})},toDetail:function(e){this.$router.push({name:"view",params:{source_id:e}})}},created:function(){this.loadMenus()}},w=b,g=(n("6fe3"),Object(p["a"])(w,s,i,!1,null,null,null));t["default"]=g.exports},"434b":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return r}));var s=n("41cb");function i(e){return Object(s["a"])().get("api/cms/helper/knowledge",{params:e})}function a(e){return Object(s["a"])().get("/api/cms/menu-group",{params:e}).then((function(e){return e.data.data}))}function c(){return Object(s["a"])().get("/api/cms/helper/knowledge/types")}function r(e){return Object(s["a"])().get("/api/cms/helper/knowledge/count",{params:e})}},"6fe3":function(e,t,n){"use strict";n("bf42")},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("d9e2"),n("d3b7"),n("3ca3"),n("ddb0");var s=n("06c5");function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(s["a"])(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){o=!0,c=e},f:function(){try{r||null==n["return"]||n["return"]()}finally{if(o)throw c}}}}},bf42:function(e,t,n){},f347:function(e,t,n){}}]);