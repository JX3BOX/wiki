(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f50e23c6"],{1330:function(e,t,n){"use strict";n("cdb2")},"5d74":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-search-view"},[e.isEmpty?t("span",{staticClass:"u-list-empty"},[e._v("👻 暂无记录")]):e._e(),e.isLogin&&e.isVirtual&&!e.isEmpty?t("div",{staticClass:"m-normal-op"},[t("el-checkbox",{attrs:{border:"",size:"small"},on:{change:e.switchAll},model:{value:e.isAll,callback:function(t){e.isAll=t},expression:"isAll"}},[e._v("全选")]),e.selectedAchievements.length?[t("el-button",{attrs:{plain:"",icon:"el-icon-check",size:"small"},on:{click:function(t){return t.stopPropagation(),e.finishVirtual.apply(null,arguments)}}},[e._v(" 批量设为完成("+e._s(e.selectedAchievements.length)+") ")]),t("el-button",{attrs:{type:"info",icon:"el-icon-close",size:"small"},on:{click:function(t){return t.stopPropagation(),e.cancelVirtual.apply(null,arguments)}}},[e._v(" 批量取消完成("+e._s(e.selectedAchievements.length)+") ")])]:e._e()],2):e._e(),t("Achievements",{attrs:{achievements:e.achievements}}),t("el-pagination",{attrs:{background:"",total:e.achievements_count,"hide-on-single-page":"",layout:"prev, pager, next","current-page":e.page,"page-size":e.length,"prev-html":"&laquo;","next-html":"&raquo;"},on:{"current-change":e.page_change_handle}})],1)},a=[],c=n("c7eb"),s=n("5530"),r=n("1da1"),o=(n("99af"),n("4de4"),n("a630"),n("caad"),n("a15b"),n("d81d"),n("14d9"),n("e9f5"),n("910d"),n("ab43"),n("d3b7"),n("6062"),n("1e70"),n("79a4"),n("c1a1"),n("8b00"),n("a4e7"),n("1e5a"),n("72c3"),n("2532"),n("3ca3"),n("ddb0"),n("ba02")),l=n("262e"),u=n("c9d2"),h={name:"SearchPage",components:{Achievements:o["a"]},props:[],data:function(){return{achievements:[],achievements_count:0,page:1,length:15,isAll:!1,keyword:"",scene:""}},computed:{isEmpty:function(){var e;return!(null!==(e=this.achievements)&&void 0!==e&&e.length)},isLogin:function(){return u["a"].isLogin()},currentRole:function(){return this.$store.state.role},selectedAchievements:function(){return this.achievements.filter((function(e){return e.checked}))},isVirtual:function(){var e;return!(null!==(e=this.currentRole)&&void 0!==e&&e.jx3id)},achievementsVirtual:function(){return this.$store.state.achievementsVirtual}},watch:{$route:{immediate:!0,handler:function(){var e=this;return Object(r["a"])(Object(c["a"])().mark((function t(){var n,i,a,r,o,l,u;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isAll=!1,r=(null===(n=e.$route.query)||void 0===n?void 0:n.scene)||"",o=(null===(i=e.$route.params)||void 0===i?void 0:i.keyword)||"",r&&e.scene!=r||o&&e.keyword!=o?e.page_change_handle(1):e.page=parseInt(e.$route.query.page)||1,e.scene=r,e.keyword=o,t.next=8,e.get_achievements();case 8:l=t.sent,u=(null===(a=l.achievements)||void 0===a?void 0:a.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})})))||[],e.achievements=u,e.achievements_count=l.total;case 12:case"end":return t.stop()}}),t)})))()}}},methods:{switchAll:function(e){this.achievements=this.achievements.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{checked:e})}))},get_achievements:function(){var e={limit:this.length,page:this.page};return this.scene&&(e["scene"]=this.scene),this.keyword&&(e["keyword"]=this.keyword),new Promise((function(t,n){Object(l["r"])(e).then((function(e){e=e.data,t(e.data)}),(function(){t(!1)}))}))},page_change_handle:function(e){this.$router.push({name:"search",params:{keyword:this.$route.params.keyword},query:Object(s["a"])(Object(s["a"])({},this.$route.query),{},{page:e})})},finishVirtual:function(){var e,t=this,n=null===(e=this.selectedAchievements)||void 0===e?void 0:e.map((function(e){return e.ID+""}));if(n.length){var i={achievements:n.join()};Object(l["s"])(i).then((function(e){t.$notify({title:"操作成功",message:"已将选中成就标记为已完成",type:"success"});var i=Array.from(new Set(t.achievementsVirtual.concat(n)));t.$store.commit("SET_STATE",{key:"achievementsVirtual",value:i}),t.isAll=!1,t.achievements=t.achievements.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})}))}))}},cancelVirtual:function(){var e,t=this,n=null===(e=this.selectedAchievements)||void 0===e?void 0:e.map((function(e){return e.ID+""})),i={achievements:n.join()};Object(l["a"])(i).then((function(e){t.$notify({title:"操作成功",message:"已将选中成就标记为待完成",type:"success"});var i=t.achievementsVirtual.filter((function(e){return!n.includes(e)}));t.$store.commit("SET_STATE",{key:"achievementsVirtual",value:i}),t.isAll=!1,t.achievements=t.achievements.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})}))}))}}},m=h,v=(n("1330"),n("2877")),d=Object(v["a"])(m,i,a,!1,null,null,null);t["default"]=d.exports},ba02:function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"m-achievement-singles"},e._l(e.achievements,(function(n,i){return t("AchievementSingle",{key:i,attrs:{achievement:n,target:e.target,jump:e.jump,initFold:!0}})})),1)},a=[],c=(n("b0c0"),n("1c47")),s={name:"Achievements",props:["achievements","target","jump"],components:{AchievementSingle:c["a"]},watch:{achievements:function(){var e=this;this.$route&&"undefined"!==typeof this.$store.state.scroll_tops[this.$route.name]&&setTimeout((function(){window.scrollTo(0,e.$store.state.scroll_tops[e.$route.name])}),200)}}},r=s,o=n("2877"),l=Object(o["a"])(r,i,a,!1,null,null,null);t["a"]=l.exports},cdb2:function(e,t,n){}}]);
//# sourceMappingURL=chunk-f50e23c6.1ae2e12a.js.map