(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-648f9da5"],{"01ea":function(t,e,i){"use strict";i.d(e,"e",(function(){return s})),i.d(e,"d",(function(){return c})),i.d(e,"f",(function(){return o})),i.d(e,"b",(function(){return u})),i.d(e,"a",(function(){return l})),i.d(e,"c",(function(){return d})),i.d(e,"g",(function(){return m}));var n=i("5530"),a=i("65c2"),r=Object(n["a"])(Object(n["a"])({},a),{},{__dataPath:"https://data.jx3box.com/",__imgPath:"https://img.jx3box.com/",__iconPath:"https://icon.jx3box.com/"}),s=r.__imgPath,c=(r.__dataPath,r.__iconPath),o=(r.__cms,r.__down,r.__node,r.__ossMirror,r.__ossRoot,r.__visibleMap,r.default_avatar),u=r.__Root,l=r.__OriginRoot,d=(r.__Github,r.__Preview,r.__server,r.__sso,r.__spider,r.__spider2,r.__next,r.__pay,r.__team,r.__lua,r.__dbm,r.__helperUrl,r.__os,r.__jx3,r.__cdn),m=(r.__staticPath,r.__clients,r.__postType,r.__wikiType,r.__appType,r.__gameType,r.__sourceType,r.__userGroup,r.__userLevel,r.__userLevelColor,r.__Links,r.feedback)},"16ca":function(t,e,i){"use strict";i("f596")},"262e":function(t,e,i){"use strict";i.d(e,"f",(function(){return s})),i.d(e,"p",(function(){return c})),i.d(e,"q",(function(){return o})),i.d(e,"d",(function(){return l})),i.d(e,"i",(function(){return d})),i.d(e,"b",(function(){return m})),i.d(e,"h",(function(){return h})),i.d(e,"c",(function(){return f})),i.d(e,"r",(function(){return v})),i.d(e,"j",(function(){return p})),i.d(e,"e",(function(){return _})),i.d(e,"o",(function(){return g})),i.d(e,"l",(function(){return b})),i.d(e,"k",(function(){return w})),i.d(e,"n",(function(){return C})),i.d(e,"s",(function(){return k})),i.d(e,"a",(function(){return y})),i.d(e,"m",(function(){return S})),i.d(e,"g",(function(){return j}));var n=i("5530"),a=(i("caad"),i("2532"),i("41cb")),r=Object(a["d"])();function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wiki_cj_ac";return Object(a["a"])().get("/api/cms/breadcrumb/".concat(t)).then((function(t){return t.data.data.html||""}))}function c(t,e){return t?r.get("api/node/achievement/".concat(t),e):null}function o(t){return t?r.get("/api/node/achievement/".concat(t,"/relations")):null}var u=location.href.includes("origin")?"origin":"std";function l(){return r.get("/api/node/achievement/count",{params:{client:u}})}function d(t){return r.get("/api/node/achievement/menus",{params:t})}function m(t){return r.get("/api/node/achievement/points",{params:{general:t,client:u}})}function h(t,e,i){var r="/api/cms/helper/achievements/".concat(t);return e&&(r+="/".concat(e)),Object(a["a"])().get(r,{params:Object(n["a"])({client:u},i)})}function f(t){return r.post("/api/node/achievement/list",Object.assign(t,{client:u}))}function v(t){return r.get("/api/node/achievement/search",{params:Object.assign(t,{client:u})})}function p(t){return r.get("/api/node/achievement/newest",{params:{page:t,client:u}})}function _(t){return r.get("/api/node/achievement/adventure",{params:{page:t,client:u}})}function g(t){return Object(a["a"])().get("/api/cms/helper/achievements/waiting",{params:{page:t,client:u}})}function b(t){return r.get("/api/node/achievement/rare",{params:{page:t,client:u}})}function w(t){return Object(a["b"])().get("/api/achievements/out_print",{params:{page:t,client:u}})}function C(){return Object(a["c"])().get("/api/next2/virtual-achievements")}function k(t){return Object(a["c"])().post("/api/next2/virtual-achievements",t)}function y(t){return Object(a["c"])().post("/api/next2/virtual-achievements/cancel",t)}function S(t){return Object(a["c"])().get("/api/next2/user-achievements",{params:{jx3id:t}})}function j(t){return r.get("/api/node/v2/map/list",{params:t})}},"2e95":function(t,e,i){},"2f3d":function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return t.item?e("div",{staticClass:"m-cj-item",on:{click:function(e){return t.$emit("detail",t.item)}}},[e("div",{staticClass:"m-cj-item__header"},[e("div",{staticClass:"m-sub-cj-list"},[t._l(t.item.SeriesAchievementList,(function(i){return e("div",{key:i.ID,staticClass:"u-sub-item",class:[i.ID===t.item.ID?"is-active":""]})})),t.item.SeriesAchievementList?t._e():e("div",{staticClass:"u-sub-item is-active"})],2),e("div",{staticClass:"u-cj-status",class:[t.hadCompleted(t.item.ID)?"is-complete":""]},[e("div",{staticClass:"u-top"},[e("div",{staticClass:"u-num"},[t._v(" "+t._s(t.item.Point)+" ")]),e("div",{staticClass:"u-icon"},[e("svg",{attrs:{"data-name":"图层 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{staticClass:"cls-1",attrs:{fill:"currentColor",d:"M114.2 171.14c-20.33 4.3-22.22 28.45-25.82 44.73-.85 3.85-2.36 13.49-6.85 14.91-8.16 2.57-4.4-18.14-4.27-21.91a525.52 525.52 0 016.46-64c2.11-13.48-.62-27.41-4-40.43-2-7.54-2.9-16.5-8.21-22.61-2.93-3.37-6.78-4.37-10.84-5.66A124.51 124.51 0 0040 72c-.24 0-.52 0-.62-.27s.15-.41.31-.57c7-7.34 20.48-15.44 30.88-14.44 5 .48 13 4.84 17.89 2.26 6.54-3.52 4.67-14.2 4.34-20.18-.26-4.69-.66-6.6 5.07-6.5 1.45 0 3.16.18 3.92 1.42a4.36 4.36 0 01.44 2.18c.23 8.07-1.09 16.22.61 24.21 2 9.29 11 16.15 20.64 11.94 4.78-2.08 8-6.06 12.17-9 12.83-8.85 28.41-13.26 43.87-14.14 17.77-1 36.11 1.37 49.66 13.94 1.23 1.14 2.48 2.51 2.53 4.19.09 3.41-5.88 3.27-8.12 3.5-14.59 1.51-29.87 4.71-42.5 12.46-13.82 8.47-20.93 20.72-22.86 36.66-2.28 18.84-.6 37 3.65 55.31 2.56 11 2.46 21.16 2.55 32.4 0 5.43.31 6.4-.16 12-.25 2.95-.61 9.3-2.91 11.41-4.54 4.15-8.07-19.31-8.7-21.73-3.34-12.94-10.15-25.37-20.48-33.94-4.76-3.92-12.01-5.23-17.98-3.97z"}})])])]),t.hadCompleted(t.item.ID)?e("div",{staticClass:"u-complete"},[t._v("完成")]):t._e()])]),e("div",{staticClass:"u-title"},[t._v(t._s(t.item.Name))]),e("div",{staticClass:"m-cj-item__content",class:[t.contentAlignClass]},[e("div",{staticClass:"u-img"},[e("img",{attrs:{src:t.icon_url(t.item.IconID)},on:{"~error":function(e){return function(){e.target.src=t.icon_url()}.apply(null,arguments)}}})]),e("div",{ref:"desc",staticClass:"u-desc"},[t._v(" "+t._s(t.item.Desc)+" ")])])]):t._e()},a=[],r=(i("caad"),i("2532"),i("85e4")),s={name:"WikiItem",props:{item:{type:Object,default:function(){}}},emits:["detail"],data:function(){return{isOneLine:!0}},computed:{contentAlignClass:function(){return this.isOneLine?"is-center":"is-start"},currentRole:function(){return this.$store.state.role},completeAchievements:function(){return this.$store.state.achievements||[]},achievementsVirtual:function(){return this.$store.state.achievementsVirtual||[]}},mounted:function(){var t=this;this.$nextTick((function(){t.checkLineCount()}))},updated:function(){var t=this;this.$nextTick((function(){t.checkLineCount()}))},methods:{icon_url:function(t){return Object(r["l"])(t,this.client)},hadCompleted:function(t){var e=this.isVirtual?this.achievementsVirtual:this.completeAchievements;return e.includes(t+"")},checkLineCount:function(){var t=this.$refs.desc;if(t){var e=t.scrollHeight;this.isOneLine=e<=20}}}},c=s,o=(i("16ca"),i("2877")),u=Object(o["a"])(c,n,a,!1,null,null,null);e["a"]=u.exports},"38cf":function(t,e,i){"use strict";var n=i("23e7"),a=i("1148");n({target:"String",proto:!0},{repeat:a})},"7db5":function(t,e,i){"use strict";i("a94b")},8718:function(t,e,i){"use strict";i("99af");var n=i("01ea");e["a"]=function(t){return isNaN(parseInt(t))?"".concat(n["e"],"image/common/nullicon.png"):"".concat(n["d"],"icon/").concat(t,".png")}},8975:function(t,e,i){"use strict";i.r(e),i.d(e,"date_format",(function(){return n})),i.d(e,"description",(function(){return a})),i.d(e,"icon_url",(function(){return r["a"]})),i.d(e,"item_color",(function(){return s})),i.d(e,"item_attribute_percent",(function(){return c})),i.d(e,"item_bind",(function(){return o})),i.d(e,"item_price",(function(){return u})),i.d(e,"item_quality",(function(){return d})),i.d(e,"item_require_1_type",(function(){return l})),i.d(e,"star",(function(){return m})),i.d(e,"author_url",(function(){return f}));i("99af");var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{polished:!0,separator:"-"},i=new Date(1e3*parseInt(t)),n=i.getFullYear(),a=i.getMonth()+1,r=i.getDate(),s=e.polished?"".concat(n).concat(e.separator).concat(c(a)).concat(e.separator).concat(c(r)):"".concat(n).concat(e.separator).concat(a).concat(e.separator).concat(r);return s;function c(t){return t<10?"0"+t:t}},a=(i("ac1f"),i("5319"),function(t){return t||""}),r=i("8718"),s=function(t){switch(t){case 0:return"rgb(167,167,167)";case 1:return"rgb(255,255,255)";case 2:return"rgb(0,210,75)";case 3:return"rgb(0,126,255)";case 4:return"rgb(254,45,254)";case 5:return"rgb(255,165,0)";default:return"rgb(0,0,0)"}},c=(i("b680"),function(t,e){var i="";switch(e=e?parseInt(e):0,t){case"atAllTypeCriticalStrike":case"atLunarCriticalStrike":case"atMagicCriticalStrike":case"atNeutralCriticalStrike":case"atPhysicsCriticalStrike":case"atPoisonCriticalStrike":case"atSolarAndLunarCriticalStrike":case"atSolarCriticalStrike":i="+".concat((e/35737.5*100).toFixed(2),"%");break;case"atAllTypeCriticalDamagePowerBase":case"atLunarCriticalDamagePowerBase":case"atMagicCriticalDamagePowerBase":case"atNeutralCriticalDamagePowerBase":case"atPhysicsCriticalDamagePowerBase":case"atPoisonCriticalDamagePowerBase":case"atSolarAndLunarCriticalDamagePowerBase":case"atSolarCriticalDamagePowerBase":i="+".concat((e/12506.25*100).toFixed(2),"%");break;case"atToughnessBase":i="+".concat((e/35737.5*100).toFixed(2),"% +").concat((e/9588.75*100).toFixed(2),"%会心减害");break;case"atDecriticalDamagePowerBase":i="";break;case"atAllTypeHitValue":case"atLunarHitValue":case"atMagicHitValue":case"atNeutralHitValue":case"atPhysicsHitValue":case"atPoisonHitValue":case"atSolarAndLunarHitValue":case"atSolarHitValue":i="+".concat((e/25991.25*100).toFixed(2),"%");break;case"atDodge":i="";break;case"atParryBase":i="";break;case"atStrainBase":i="+".concat((e/34458.75*100).toFixed(2),"%");break;case"atPhysicsDefenceAdd":case"atPhysicsShieldAdditional":case"atPhysicsShieldBase":i="";break;case"atLunarMagicShieldBase":case"atMagicShield":case"atNeutralMagicShieldBase":case"atPoisonMagicShieldBase":case"atSolarMagicShieldBase":i="";break;case"atLunarOvercomeBase":case"atMagicOvercome":case"atNeutralOvercomeBase":case"atPhysicsOvercomeBase":case"atPoisonOvercomeBase":case"atSolarAndLunarOvercomeBase":case"atSolarOvercomeBase":i="+".concat((e/35737.5*100).toFixed(2),"%");break;case"atHasteBase":i="+".concat((e/43856.25*100).toFixed(2),"%");break;default:break}return i?" (".concat(i,")"):""}),o=function(t){switch(t){case 1:return"可交易";case 2:return"装备前可交易";case 3:return"不可交易";default:return"未知"}},u=function(t){var e=parseInt(t/100/100/1e4),i=parseInt(t/100/100%1e4),n=parseInt(t/100%100),a=parseInt(t%100),r="";return e&&(r+=e+"砖"),i&&(r+=i+"金"),n&&(r+=n+"银"),r+=a+"铜",r},l=function(t){return 5===t?"需要等级":t},d=function(t){switch(t){case 0:return"破败";case 1:return"普通";case 2:return"精巧";case 3:return"卓越";case 4:return"珍奇";case 5:return"稀世";default:return"未知"}},m=(i("38cf"),function(t){return"⭐️".repeat(t||1)}),h=i("85e4"),f=function(t){return Object(h["a"])(t)}},"8ee8":function(t,e,i){"use strict";i("2e95")},"9a1b":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return r}));var n=i("41cb");function a(){return Object(n["a"])().get("/api/cms/user/my/info").then((function(t){return t.data.data}))}function r(t){return Object(n["a"])().post("/api/cms/system/common/reporter")}},a94b:function(t,e,i){},b984:function(t,e,i){"use strict";i.r(e);var n=function(){var t,e,i,n=this,a=n._self._c;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"c-var p-achievement-detail"},[a("div",{staticClass:"m-main-box"},[a("div",{staticClass:"m-achievement-info"},[a("div",{staticClass:"m-sub-list"},n._l((null===(t=n.source)||void 0===t?void 0:t.SeriesAchievementList)||[],(function(t){return a("div",{key:t.ID,staticClass:"u-sub-achievement",on:{click:function(){return n.changeCurrent(t)}}},[a("img",{attrs:{src:n.iconUrl(t.IconID)}})])})),0),a("wiki-item",{attrs:{item:n.source}}),a("button",{staticClass:"m-confirm",class:{complete:n.isComplete,disabled:!n.isVirtual},on:{click:n.setConfirm}},[n._v(n._s(n.isComplete?"已完成":"设为已完成"))])],1),a("div",{staticClass:"m-wiki"},[a("div",{staticClass:"m-wiki-header"},[a("div",{staticClass:"u-title"},[n._v("成就攻略")]),a("div",{staticClass:"u-avatar-list"},n._l(n.authors,(function(t){return a("div",{key:t.user_id,staticClass:"u-avatar"},[a("img",{attrs:{src:n.showAvatar(t.user_avatar)}})])})),0),a("div",{staticClass:"u-time"},[n._v(" "+n._s(n.updated_at)+" ")])]),a("div",{staticClass:"m-content-box"},[a("Article",{attrs:{id:"wikiArticle",content:n.clearContent(null===(e=n.wiki_post)||void 0===e||null===(i=e.post)||void 0===i?void 0:i.content)}})],1),a("div",{staticClass:"u-show-log"},[n._v("查看历史修订")])])]),a("div",{staticClass:"m-comments"},[a("miniprogram-comment-list",{attrs:{"source-id":n.id,type:"achievement"}})],1),n.isFromTarget?n._e():a("suspend-common",{ref:"suspendCommon",staticClass:"u-suspend-common",staticStyle:{width:"100%"},attrs:{"btn-options":n.btnOptions,"drawer-options":n.drawerOptions},on:{search:n.onSearch},scopedSlots:n._u([{key:"default",fn:function(){var t,e;return[a("div",{staticClass:"m-more-action"},[a("div",{staticClass:"u-action",on:{click:function(){return n.userSelectShow=!0}}},[a("svg",{attrs:{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M17.5 12a2.25 2.25 0 012.25 2.25V15c0 2.956-2.79 6-7.5 6s-7.5-3.044-7.5-6v-.75A2.25 2.25 0 017 12h10.5zm-5.25-9.75a4.125 4.125 0 110 8.25 4.125 4.125 0 010-8.25z",fill:"#FEDAA3"}})])]),a("div",{staticClass:"u-action",on:{click:function(){return n.$refs.suspendCommon.clickDrawer({type:"collect",text:"收藏"},1)}}},[null!==(t=n.$refs.suspendCommon)&&void 0!==t&&t.isCollect?a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M467.584 153.568c11.136-13.312 26.208-25.952 44.544-25.632 21.76-.064 38.016 16.992 50.272 33.056 23.968 32.576 42.336 68.768 62.368 103.808 10.112 17.472 18.944 35.776 30.944 52.096 8.48 11.616 22.08 17.824 35.712 21.056 41.6 10.4 83.744 18.528 125.152 29.792 21.6 6.304 44.192 12.64 61.952 27.136 15.04 12.096 20.992 33.408 15.552 51.776-6.752 23.456-22.208 42.976-36.832 62.048-23.584 29.536-48.576 57.92-72.992 86.784C662.688 473.28 540.384 351.904 418.88 229.664c15.072-26.048 29.408-52.8 48.704-76.096zm-261.696 10.688c2.624.128 7.872.32 10.464.448l-.384 2.816c9.92.928 18.688 6.432 25.568 13.376 39.424 39.488 78.976 78.848 118.304 118.4 45.024 42.464 87.808 87.232 131.904 130.656C577.6 515.808 663.36 601.728 749.312 687.488c38.24 40.672 78.656 79.232 117.76 119.04 9.824 10.336 22.208 19.36 27.2 33.216 3.552 14.464 1.76 31.328-9.568 42.016-14.528 17.792-44.448 19.168-60.544 2.816-18.272-17.984-36.544-36.032-54.336-54.496-.384 20.736-4.704 44.672-22.784 57.536-17.76 12.8-41.184 8.64-60.704 2.72-38.56-12.352-74.752-30.816-111.648-47.296-17.632-7.616-34.624-17.312-53.44-21.792-14.848-3.392-29.472 2.72-42.848 8.544-38.368 17.12-76.128 35.648-115.072 51.456C344.32 888.544 324.672 896 304 896.032c-15.68.16-31.328-7.968-39.296-21.632-10.368-17.44-10.88-38.528-11.072-58.304 1.088-50.336 7.936-100.288 11.968-150.432 1.088-14.304 1.504-29.568-5.568-42.56-8.832-16.032-21.952-29.024-33.472-43.072-26.752-31.968-55.168-62.752-78.816-97.184-12.576-18.88-24.896-42.016-17.568-65.248 6.176-20.832 26.688-32.352 45.664-39.648 36.256-13.536 74.496-20.544 112.032-29.536-35.2-34.912-70.08-70.144-105.248-105.12-7.616-7.424-14.272-16.544-15.264-27.424l-2.848.608.384-13.696 2.656.896c2.624-18.88 19.616-34.656 38.496-36.608l-.16-2.816z",fill:"#FEDAA3"}})]):a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M10.288 4.836c.778-1.289 2.646-1.289 3.424 0l1.15 1.903a2 2 0 001.257.914l2.166.505c1.465.341 2.043 2.119 1.058 3.256l-1.455 1.681a2 2 0 00-.48 1.48l.188 2.215c.128 1.5-1.384 2.598-2.77 2.012l-2.049-.864a2 2 0 00-1.554 0l-2.049.864c-1.387.585-2.898-.513-2.77-2.012l.189-2.216a2 2 0 00-.48-1.479l-1.456-1.68c-.985-1.138-.407-2.916 1.058-3.257l2.166-.505a2 2 0 001.258-.914l1.149-1.903z",fill:"#FEDAA3",stroke:"#FEDAA3","stroke-width":"1.5"}})])]),a("div",{staticClass:"u-action",on:{click:function(){return n.$refs.suspendCommon.clickDrawer({type:"pin",text:"固定按钮"},1)}}},[null!==(e=n.$refs.suspendCommon)&&void 0!==e&&e.fixIsActive?a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M15 4.5l-4 4L7 10l-1.5 1.5 7 7L14 17l1.5-4 4-4M9 15l-4.5 4.5M14.5 4L20 9.5",stroke:"#FEDAA3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})]):a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M624.864 119.424c6.144-7.872 13.696-16.928 24.672-16.64 7.68-.736 14.24 3.808 19.2 9.184 81.984 82.304 164.32 164.192 246.08 246.688 7.776 5.92 7.456 16.416 6.016 25.088-2.304 7.488-9.152 11.968-14.848 16.736-58.272 49.504-116.512 99.072-174.784 148.544-4.48 4.416-10.912 5.44-16.768 6.912-5.696 40.8-13.376 81.28-18.08 122.208 6.528 16.32 5.28 34.368 8.16 51.488 1.984 8.864-1.728 17.792-7.84 24.128-24.608 23.552-47.776 48.544-72.544 71.936-8.96 9.056-24.864 6.912-32.96-2.272-51.136-51.008-101.92-102.368-153.056-153.312-71.616 70.784-142.272 142.624-213.632 213.664-11.424 11.008-21.44 24.384-35.968 31.424-14.144 4.8-31.008 4.512-43.84-3.776-10.336-7.616-19.36-18.144-21.76-31.072-3.808-16.288 2.208-33.984 14.592-45.056 77.344-78.144 155.424-155.616 232.768-233.728-56.736-56.032-112.64-113.024-169.216-169.248-8.128-9.088-7.648-26.016 2.368-33.632 24.416-24.672 48.992-49.12 73.44-73.696 3.808-3.424 9.056-4.16 13.984-4.096 18.112.192 36.064 2.944 53.984 5.408 41.824-4.8 83.744-8.992 125.408-15.264.608-6.048 2.624-11.904 6.528-16.64 49.44-58.24 98.848-116.544 148.096-174.976z",fill:"#D9D9D9"}})])])])]},proxy:!0}],null,!1,2389856281)}),a("user-select-drawer",{attrs:{visible:n.userSelectShow,"current-role":n.currentRole},on:{"update:visible":function(t){n.userSelectShow=t},change:n.setRole}}),a("confirm-ok-drawer",{attrs:{visible:n.conformShow},on:{"update:visible":function(t){n.conformShow=t},confirm:n.confirmOk}})],1)},a=[],r=i("5530"),s=i("c14f"),c=i("1da1"),o=(i("99af"),i("4de4"),i("a630"),i("caad"),i("a15b"),i("d81d"),i("14d9"),i("e9f5"),i("d866"),i("910d"),i("7d54"),i("ab43"),i("d3b7"),i("ac1f"),i("6062"),i("1e70"),i("79a4"),i("c1a1"),i("8b00"),i("a4e7"),i("1e5a"),i("72c3"),i("2532"),i("3ca3"),i("5319"),i("159b"),i("ddb0"),i("c1cc")),u=i("85e4"),l=i("9616"),d=i("262e"),m=i("500d"),h=i("16e5"),f=i("c9d2"),v=i("cc9a"),p=i("9a1b"),_=i("8975"),g=i("8718"),b=i("a974"),w=i("06da"),C=i("c404"),k=i("2f3d"),y=i("3aef"),S={name:"CjMobileDetail",components:{ConfirmOkDrawer:y["a"],WikiItem:k["a"],MiniprogramCommentList:C["a"],UserSelectDrawer:w["a"],SuspendCommon:o["a"],Article:b["a"]},data:function(){return{source:{},wiki_post:"",compatible:!1,is_empty:!0,imageCount:0,loadedImageCount:0,images:[],imagesLoaded:!1,userSelectShow:!1,currentRole:this.$store.state.role,loading:!1,conformShow:!1}},computed:{show:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},id:function(){return this.$route.params.source_id},post_id:function(){return this.$route.params.post_id},isRevision:function(){return!!this.$route.params.post_id},author_id:function(){var t;return~~(null===(t=this.wiki_post.post)||void 0===t?void 0:t.user_id)},client:function(){return this.$store.state.client},user_name:function(){var t,e;return null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_nickname},updated_at:function(){var t,e;return Object(u["t"])(null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.updated)},authors:function(){var t,e,i;return this.isRevision?[]:(null===(t=this.wiki_post)||void 0===t||null===(e=t.users)||void 0===e||null===(i=e.filter((function(t){return t.id})))||void 0===i?void 0:i.map((function(t){return{user_id:t.id,user_avatar:t.avatar,display_name:t.nickname}})))||[]},favTitle:function(){var t,e;return null===(t=this.wiki_post)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.Name},prefix:function(){return"std"===this.client?"www":"origin"},isFromTarget:function(){return!1},drawerOptions:function(){var t,e;return{hideType:["report"],direction:"btt",drawerTitle:this.source.Name,author:{name:null===(t=this.author_info)||void 0===t?void 0:t.display_name,avatar:null===(e=this.author_info)||void 0===e?void 0:e.user_avatar,author_id:this.author_id},subscribeType:"wiki",postType:"achievement",id:this.post_id,title:this.source.Name||document.title||"",url:window.location.href,laterOn:{author_id:this.author_id||0,content_meta_id:this.post_id}}},btnOptions:function(){return{showHome:!0,showIcon:!1,showMore:!0}},completeAchievements:function(){return this.$store.state.achievements||[]},achievementsVirtual:function(){return this.$store.state.achievementsVirtual||[]},isComplete:function(){return this.hadCompleted(this.id)},isVirtual:function(){var t;return!(null!==(t=this.currentRole)&&void 0!==t&&t.jx3id)}},watch:{id:{handler:function(){this.loadData()}},post_id:{handler:function(){this.loadRevision()}},currentRole:{deep:!0,handler:function(t){if(t){localStorage.setItem("wiki_last_sync",t.jx3id||0),this.$store.commit("SET_STATE",{key:"role",value:t});var e=t.jx3id;e?(this.$store.commit("SET_STATE",{key:"achievementsVirtual",value:[]}),this.loadRoleAchievements(e)):(0===e&&this.loadVirtualAchievements(),this.$store.commit("SET_STATE",{key:"achievements",value:[],isSession:!0}))}}}},methods:{iconUrl:g["a"],showAvatar:u["r"],icon_url:_["icon_url"],next:function(){},onSearch:function(){isMiniProgram()&&wx.miniProgram.navigateTo({url:"/pages/search/search-detail/search-detail?app=wiki&filter_category=成就"})},setRole:function(t){this.currentRole=t,this.userSelectShow=!1},openChild:function(){this.childrenShow=!0,console.log(111)},clearContent:function(t){return(t||"").replace(/ style="[^"]*"/g,"").replace(/<i?frame.*?src="(.*?)".*?>/g,(function(t,e){return'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")})).replace(/<i?frame.*?src="(.*?)".*?>.*?<\/i?frame>/g,(function(t,e){return'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")}))},publish_url:u["p"],triggerStat:function(){"origin"==this.client?Object(l["d"])("origin_cj",this.id):Object(l["d"])("cj",this.id)},changeCurrent:function(t){this.$router.push({name:"view",params:{source_id:t.ID}})},initImageLoader:function(){var t=this;this.$nextTick((function(){var e=document.getElementById("wikiArticle");if(e){var i=e.querySelectorAll("img");t.images=i,t.imageCount=i.length,0!==t.imageCount?t.preloadAllImages(i):t.setGlobalReady()}else t.setGlobalReady()}))},preloadAllImages:function(t){var e=this,i=0;Array.from(t).forEach((function(n,a){var r=n.src;if(n.complete)e.handleImageLoad();else{var s=new Image;s.onload=function(){i++,n.src=r,e.checkImageLoadCompletion(t,i)},s.onerror=function(){console.error("图片加载失败: ".concat(r)),n.src=r,e.handleImageLoad()},s.src=r}}))},checkImageLoadCompletion:function(t,e){var i=this;t.length!==this.loadedImageCount?setTimeout((function(){var e=Array.from(t).every((function(t){return t.complete}));(e||i.loadedImageCount===t.length)&&i.setGlobalReady()}),3e3):this.setGlobalReady()},handleImageLoad:function(){this.loadedImageCount++,this.loadedImageCount===this.imageCount&&this.setGlobalReady()},setGlobalReady:function(){this.imagesLoaded||(this.imagesLoaded=!0,window.__READY__=!0,console.log("全局状态设置成功: __READY__ = ",window.__READY__))},loadData:function(){var t=Object(c["a"])(Object(s["a"])().m((function t(){var e=this;return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:if(!this.id){t.n=2;break}return this.loading=!0,t.n=1,Object(d["p"])(this.id,{client:this.client}).then((function(t){var i,n;e.source=(null===t||void 0===t||null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.achievement)||""}));case 1:return t.n=2,m["a"].mix({type:"achievement",id:this.id,client:this.client}).then((function(t){var i=t.post,n=t.source,a=t.compatible,r=t.isEmpty,s=t.users;e.wiki_post={post:i,source:n,users:s},e.is_empty=r,e.compatible=a,Object(h["b"])({caller:"cj_detail",data:{href:"".concat(e.prefix,":/cj/view/").concat(e.id)}}),f["a"].isLogin()&&Object(l["c"])({source_type:"origin"==e.client?"origin_cj":"cj",source_id:~~e.id,link:location.href,title:i.title})})).finally((function(){e.loading=!1}));case 2:this.isRobot&&this.initImageLoader(),this.triggerStat();case 3:return t.a(2)}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadRevision:function(){var t=this;m["a"].getById(this.post_id).then((function(e){var i;t.wiki_post=Object(r["a"])(Object(r["a"])({},t.wiki_post),{},{post:null===(i=e.data.data)||void 0===i?void 0:i.post})})),this.triggerStat()},ts2str:u["t"],loadConfig:function(){Object(v["b"])({key:"test_user_ua"}).then((function(t){var e=~~t.data.data.val;e&&Object(p["b"])()}))},loadRoleAchievements:function(t){var e=this;Object(d["m"])(t).then((function(t){var i,n,a,r,s=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.achievements)||"",c=null===(a=t.data)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.jx3id;e.isSync=!!c;var o=s.split(",");e.$store.commit("SET_STATE",{key:"achievements",value:o,isSession:!0})}))},showSchoolIcon:u["s"],loadVirtualAchievements:function(){var t=this;this.currentRole&&!this.currentRole.jx3id&&Object(d["n"])().then((function(e){var i,n,a=(null===(i=e.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.achievements)||"",r=a.split(",");t.$store.commit("SET_STATE",{key:"achievementsVirtual",value:r})}))},confirmOk:function(){this.finishVirtual([this.id])},hadCompleted:function(t){var e=this.isVirtual?this.achievementsVirtual:this.completeAchievements;return e.includes(t+"")},setConfirm:function(){this.isVirtual&&(this.isComplete?this.cancelVirtual([this.id]):this.conformShow=!0)},finishVirtual:function(t){var e=this,i=t||this.selectedAchievements.map((function(t){return t.ID+""})),n={achievements:i.join()};Object(d["s"])(n).then((function(t){e.$notify({title:"操作成功",message:"已将选中成就标记为已完成",type:"success"});var n=Array.from(new Set(e.achievementsVirtual.concat(i)));e.$store.commit("SET_STATE",{key:"achievementsVirtual",value:n}),e.isAll=!1,e.achievements=e.achievements.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{checked:!1})}))}))},cancelVirtual:function(t){var e=this,i=t||this.selectedAchievements.map((function(t){return t.ID+""})),n={achievements:i.join()};Object(d["a"])(n).then((function(t){e.$notify({title:"操作成功",message:"已将选中成就标记为待完成",type:"success"});var n=e.achievementsVirtual.filter((function(t){return!i.includes(t)}));e.$store.commit("SET_STATE",{key:"achievementsVirtual",value:n}),e.isAll=!1,e.achievements=e.achievements.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{checked:!1})}))}))}},mounted:function(){this.post_id?this.loadRevision():this.loadData(),this.loadConfig()}},j=S,O=(i("8ee8"),i("2877")),x=Object(O["a"])(j,n,a,!1,null,null,null);e["default"]=x.exports},c404:function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-comment-list",attrs:{id:"macro-comment"}},[t._l(t.comments,(function(i){var n;return e("div",{key:i.id,staticClass:"m-comment-item"},[e("div",{staticClass:"m-main-content"},[e("div",{staticClass:"u-commenter-name",on:{click:function(e){return t.toDetail(i.user_id)}}},[t._v(" "+t._s(i.user_nickname)+" ")]),e("div",{staticClass:"u-comment-content"},[t._v(" "+t._s(i.content)+" ")]),e("div",{staticClass:"u-comment-time"},[t._v(" "+t._s(t.dayjs(null===i||void 0===i?void 0:i.commentDate).format("YYYY-MM-DD"))+" ")])]),null!==(n=i.children)&&void 0!==n&&n.length?e("div",{staticClass:"m-child-comment"},t._l(i.children,(function(i){return e("div",{key:i.id,staticClass:"m-reply-item"},[e("div",{staticClass:"u-replier-name",on:{click:function(e){return t.toDetail(i.user_id)}}},[t._v(" "+t._s(i.user_nickname)+" ")]),e("span",{staticClass:"u-reply"},[t._v("回复")]),e("div",{staticClass:"u-replier-name",on:{click:function(e){i.parent.user_id&&t.toDetail(i.parent.user_id)}}},[t._v(" "+t._s(i.parent.user_nickname)+" ")]),e("span",{staticClass:"u-reply"},[t._v("：")]),e("div",{staticClass:"u-reply-content"},[t._v(" "+t._s(i.content)+" ")])])})),0):t._e()])})),t.loading?e("div",{staticClass:"u-loading-more"},[t._v("加载中...")]):t._e(),t.noMoreData?e("div",{staticClass:"u-no-more"},[t._v("没有更多评论了")]):t._e()],2)},a=[],r=(i("99af"),i("caad"),i("d81d"),i("14d9"),i("b0c0"),i("e9f5"),i("ab43"),i("d3b7"),i("2532"),i("5a0c")),s=i.n(r),c=i("500d"),o=i("c9d2"),u={name:"MiniprogramCommentList",props:["type","sourceId"],data:function(){return{comments:[],reply_form:{content:"",user_nickname:o["a"].getInfo().name},page:1,pageSize:10,total:0,loading:!1}},computed:{isWujie:function(){var t;return(null===(t=this.$route.name)||void 0===t?void 0:t.indexOf("wujie"))>-1},client:function(){return location.href.includes("classic")||location.href.includes("origin")?"origin":"std"},noMoreData:function(){return this.comments.length>=this.total&&this.total>0}},mounted:function(){this._onScroll=this.handleScroll.bind(this),window.addEventListener("scroll",this._onScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this._onScroll)},methods:{dayjs:s.a,handleScroll:function(){if(!this.loading&&!this.noMoreData){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,e=window.innerHeight,i=document.documentElement.scrollHeight;t+e+100>=i&&this.loadMore()}},loadMore:function(){this.loading||this.noMoreData||(this.page++,this.get_comments(!0))},get_comments:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];function i(t,e){var n=[],a=function(){var a=t[r];if(!a)return 1;if(a.parent_id===e){var s=i(a.children,a.id);a.children=s.map((function(t){return t.parent={user_id:a.user_id,user_nickname:a.user_nickname,id:a.id},t.reply_form={show:!1,content:"",user_nickname:o["a"].getInfo().name},t})),n.push(a)}};for(var r in t)a();return n}this.type&&this.sourceId&&(this.loading=!0,c["b"].list({type:this.type,id:this.sourceId},{client:this.client,page:this.page}).then((function(n){n=n.data;for(var a=n.data.list,r=0;r<a.length;r++)a[r]["reply_form"]={show:!1,content:"",user_nickname:o["a"].getInfo().name};t.page=n.data.page,t.total=n.data.total,t.comments=e?t.comments.concat(i(a,0)):i(a,0),t.loading=!1})))},create_comment:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.content){var n={type:this.type,source_id:String(this.sourceId),parent_id:i,user_nickname:t.user_nickname||o["a"].getInfo().name,content:t.content,client:this.client};c["b"].post(n).then((function(i){i=i.data,t.content="",e.$message({message:"提交成功，请等待审核",type:"success"})})).finally((function(){t.show=!1}))}else this.$message({message:"请先填写评论内容再尝试提交",type:"warning"})},handleCurrentChange:function(t){this.page=t,this.get_comments()},star_comment:function(t,e){var i=this;c["b"].star(t.id,{is_star:e}).then((function(){i.page=1,i.get_comments()}))},top_comment:function(t,e){var i=this;c["b"].top(t.id,{is_top:e}).then((function(){i.page=1,i.get_comments()}))},toDetail:function(){}},watch:{sourceId:{immediate:!0,handler:function(){this.page=1,this.get_comments()}}}},l=u,d=(i("7db5"),i("2877")),m=Object(d["a"])(l,n,a,!1,null,null,null);e["a"]=m.exports},d866:function(t,e,i){"use strict";var n=i("23e7"),a=i("c65b"),r=i("2266"),s=i("59ed"),c=i("825a"),o=i("46c4"),u=i("2a62"),l=i("f99f"),d=l("every",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:d},{every:function(t){c(this);try{s(t)}catch(n){u(this,"throw",n)}if(d)return a(d,this,t);var e=o(this),i=0;return!r(e,(function(e,n){if(!t(e,i++))return n()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},f596:function(t,e,i){}}]);
//# sourceMappingURL=chunk-648f9da5.175b1737.js.map