(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8603766e"],{"0768":function(t,e,s){t.exports=s.p+"img/tog_17.6d3efb0a.svg"},"07ac":function(t,e,s){"use strict";var i=s("23e7"),a=s("6f53").values;i({target:"Object",stat:!0},{values:function(t){return a(t)}})},"0dee":function(t,e,s){"use strict";s("4c53");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-search-section"},[e("div",{staticClass:"u-search-box",on:{click:t.handleSearchClick}},[e("img",{staticClass:"u-search-icon",attrs:{src:s("46b2")("./".concat(t.isDark?"Dark":"Light","/search.svg"))}}),e("span",{staticClass:"u-search-text"},[t._v(t._s(t.placeholder||"搜索"))])]),t.showFilter?e("div",{staticClass:"u-filter-box",on:{click:function(e){return t.handleFilterClick()}}},[e("img",{staticClass:"u-search-icon",attrs:{src:s("5710")("./".concat(t.isDark?"Dark":"Light","/shaixuan.svg"))}}),e("span",{staticClass:"u-search-text"},[t._v("筛选")])]):t._e(),e("el-drawer",{staticClass:"p-search-drawer",attrs:{visible:t.drawerSearchVisible,direction:"btt",size:"420px"},on:{close:t.handleClose}},[e("template",{slot:"title"},[e("div",{staticClass:"u-search-title"},[t._v(t._s(t.title)),t.sub_title&&1!=t.step?e("span",[t._v("  - "+t._s(t.sub_title))]):t._e()])]),e("div",{staticClass:"search-list-wrapper"},[1==t.step?e("div",{staticClass:"search-step"},[e("div",{staticClass:"u-map-box"},[e("div",{staticClass:"search-step-content u-first-map",on:{click:function(e){return t.handleMapClick(null,1)}}},[t._v(" "+t._s(t.selectMapName||"请选择地图")+" ")]),e("div",{staticClass:"search-step-content u-two-map",style:{opacity:t.selectMapId?1:.5},on:{click:function(e){return t.handleMapClick(null,2)}}},[t._v(" "+t._s(t.selectSubName||"请选择地图")+" ")])]),e("div",{staticClass:"u-search-title"},[t._v("关键词")]),e("div",{staticClass:"search-step-content"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKeyword,expression:"searchKeyword"}],attrs:{type:"text",placeholder:"输入成就名称/成就描述/称号/奖励物品"},domProps:{value:t.searchKeyword},on:{input:function(e){e.target.composing||(t.searchKeyword=e.target.value)}}})]),e("div",{staticClass:"search-button-group"},[t.searchKeyword||t.selectMapId?e("div",{staticClass:"u-reset",on:{click:t.resetSelection}},[t._v("清空搜索项")]):t._e(),e("div",{staticClass:"u-submit",on:{click:function(e){return t.handleKeywordSearch()}}},[e("img",{staticClass:"u-search-icon",attrs:{src:s("3a30")}}),e("span",[t._v("搜索")])])])]):e("div",{staticClass:"search-step"},[e("div",{ref:"searchListContainer",staticClass:"search-list-container",class:{crosswise:2==t.step}},t._l(2==t.step?t.mapList:t.childrenList,(function(s){return e("div",{key:s.value,staticClass:"search-item",class:{selected:s.value==(2==t.step?t.selectMapId:t.selectSubId)},on:{click:function(e){return t.handleMapClick(s,3)}}},[e("div",{staticClass:"search-name"},[t._v(t._s(s.label))])])})),0),e("div",{staticClass:"search-button-group"},[e("div",{staticClass:"u-reset",on:{click:t.handleReset}},[t._v("重置")]),e("div",{staticClass:"u-submit",on:{click:t.handleSubmit}},[t._v("确定")])])]),t.showMask?e("div",{staticClass:"bottom-mask"}):t._e()])],2),e("el-drawer",{staticClass:"p-search-drawer",attrs:{visible:t.drawerFilterVisible,direction:"btt",size:"420px"},on:{close:t.handleCloseFilter}},[e("template",{slot:"title"},[e("div",{staticClass:"u-search-title"},[t._v("筛选")])]),e("div",{staticClass:"search-list-wrapper"},[e("div",{staticClass:"search-step"},[e("div",{ref:"filterListContainer",staticClass:"search-list-container"},t._l(t.filterOptions,(function(s){return e("div",{key:s.value,staticClass:"search-item",class:{selected:s.value==t.selectFilterId},on:{click:function(e){return t.handleFilterClick(s)}}},[e("div",{staticClass:"search-name"},[t._v(t._s(s.label)+" "),e("div",{staticClass:"search-sub"},[t._v(t._s(s.sub))])]),"已完成"===s.sub?e("div",{staticClass:"search-server"},[e("span",{domProps:{innerHTML:t._s("<隐藏掉[".concat(s.label,"]未完成的成就>"))}})]):"未完成"===s.sub?e("div",{staticClass:"search-server"},[e("span",{domProps:{innerHTML:t._s("<隐藏[".concat(s.label,"]已完成的成就>"))}})]):t._e()])})),0),e("div",{staticClass:"search-button-group"},[e("div",{staticClass:"u-reset",on:{click:t.handleFilterReset}},[t._v("重置")]),e("div",{staticClass:"u-submit",on:{click:t.handleFilterSubmit}},[t._v("确定")])])]),t.showFilterMask?e("div",{staticClass:"bottom-mask"}):t._e()])],2)],1)},a=[],n=(s("99af"),s("7db0"),s("14d9"),s("13d5"),s("b0c0"),s("e9c4"),s("a9e3"),s("d3b7"),s("07ac"),s("159b"),s("262e")),r={name:"CompareSearch",components:{},props:{showFilter:{type:Boolean,default:!1},roles:{type:Array,default:function(){return[]}}},computed:{isDark:function(){var t=window.matchMedia("(prefers-color-scheme: dark)");return t.matches}},watch:{step:function(t,e){var s=this;1!==t?this.$nextTick((function(){s.$refs.searchListContainer&&(s.$refs.searchListContainer.addEventListener("scroll",s.checkScrollPosition),s.checkScrollPosition())})):this.removeScrollListener()},drawerFilterVisible:function(t,e){var s=this;t?this.$nextTick((function(){s.$refs.filterListContainer&&(s.$refs.filterListContainer.addEventListener("scroll",s.checkScrollPosition),s.checkScrollPosition())})):this.removeScrollListener()}},beforeDestroy:function(){this.removeScrollListener()},data:function(){return{placeholder:"搜索",title:"地图",drawerSearchVisible:!1,showMask:!1,step:1,sub_title:null,searchKeyword:null,mapList:[],mapChildList:[],selectMapId:null,selectMapName:null,selectSubId:null,selectSubName:null,filterOptions:[],selectFilterId:null,drawerFilterVisible:!1,showFilterMask:!1}},created:function(){this.loadMapList()},mounted:function(){this.handleRoleFilter()},methods:{removeScrollListener:function(){this.$refs.searchListContainer&&this.$refs.searchListContainer.removeEventListener("scroll",this.checkScrollPosition),this.$refs.filterListContainer&&this.$refs.filterListContainer.removeEventListener("scroll",this.checkFilterScrollPosition)},checkScrollPosition:function(){if(this.$refs.searchListContainer){var t=this.$refs.searchListContainer,e=t.scrollHeight,s=t.clientHeight,i=t.scrollTop,a=e-(s+i);this.showMask=a>40}if(this.$refs.filterListContainer){var n=this.$refs.filterListContainer,r=n.scrollHeight,c=n.clientHeight,l=n.scrollTop,o=r-(c+l);this.showFilterMask=o>40}},handleRoleFilter:function(){var t=[{label:"全部",value:null}];this.roles.forEach((function(e){t.push({label:e.name,server:e.server,sub:"已完成",value:e.ID+"_completed"}),t.push({label:e.name,server:e.server,sub:"未完成",value:e.ID+"_uncompleted"})})),this.filterOptions=t},handleFilterClick:function(t){t?this.selectFilterId=t.value:this.drawerFilterVisible=!0},handleCloseFilter:function(){this.drawerFilterVisible=!1},handleFilterReset:function(){this.selectFilterId=null},handleFilterSubmit:function(){var t=this,e=this.filterOptions.find((function(e){return e.value==t.selectFilterId}));console.log(((null===e||void 0===e?void 0:e.label)||"")+((null===e||void 0===e?void 0:e.sub)||"")),this.$emit("filterSubmit",{filterId:this.selectFilterId,filterLabel:((null===e||void 0===e?void 0:e.label)||"")+((null===e||void 0===e?void 0:e.sub)||"")}),this.handleCloseFilter()},resetSelection:function(){this.searchKeyword=null,this.selectMapId=null,this.selectMapName=null,this.selectSubId=null,this.selectSubName=null,this.placeholder="搜索"},handleSearchClick:function(){this.step=1,this.drawerSearchVisible=!0},handleKeywordSearch:function(){this.getSearchAchievements()},handleClose:function(){this.drawerSearchVisible=!1},handleMapClick:function(t,e){return t||1!=e?!t&&2==e&&this.selectMapId?this.step=3:(2==this.step&&(this.selectMapId=t.value,this.sub_title=t.label,this.selectMapName=t.label,this.childrenList=t.children||[],this.childrenList.length>0&&(this.selectSubId=this.childrenList[0].value,this.selectSubName=this.childrenList[0].label)),void(3==this.step&&(this.selectSubId=t.value,this.selectSubName=t.label))):this.step=2},handleReset:function(){2==this.step&&(this.selectMapId=null,this.selectMapName=null,this.selectSubId=null,this.selectSubName=null,this.sub_title=null,this.childrenList=[]),3==this.step&&(this.selectSubId=this.childrenList[0].value,this.selectSubName=this.childrenList[0].label)},handleSubmit:function(){this.step=1},loadMapList:function(){var t=this,e=this.$store.state.client||"std",s={client:e,_no_page:1};Object(n["g"])(s).then((function(e){var s=e.data.data||[],i=Object.values(s.reduce((function(t,e){return e.RegionName?(t[e.RegionName]||(t[e.RegionName]={value:Number(e.Region),label:e.RegionName,children:[]}),t[e.RegionName].children.push({value:Number(e.ID),label:e.MapName,parent:Number(e.Region)}),t):t}),{}));t.mapList=i}))},getSearchAchievements:function(){var t=this,e={keyword:this.searchKeyword,scene:this.selectSubId,client:this.$store.state.client||"std",_no_page:1,limit:99999};Object(n["r"])(e).then((function(e){var s=e.data.data.achievements||[],i=[];s.forEach((function(t){i.push(t),t.SeriesAchievementList&&t.SeriesAchievementList.forEach((function(t,e){e>0&&i.push(t)}))})),t.$emit("submit",i),sessionStorage.setItem("search_achievements",JSON.stringify(i)),t.placeholder="".concat(t.selectMapName||"").concat(t.selectSubName?"/"+t.selectSubName:"").concat(t.searchKeyword?"/"+t.searchKeyword:""),t.drawerSearchVisible=!1}))}}},c=r,l=(s("a36b"),s("2877")),o=Object(l["a"])(c,i,a,!1,null,null,null);e["a"]=o.exports},"11f9":function(t,e,s){t.exports=s.p+"img/finish.c82022e3.svg"},"1aa3":function(t,e,s){t.exports=s.p+"img/tog_2.8ae213ab.svg"},2681:function(t,e,s){t.exports=s.p+"img/tog_6.fd7052b7.svg"},"27aa":function(t,e,s){t.exports=s.p+"img/tog_41.867bbf38.svg"},"2b7a":function(t,e,s){t.exports=s.p+"img/unfinished.e9a234a5.svg"},"2cfb":function(t,e,s){t.exports=s.p+"img/tog_13.741ac369.svg"},"3a30":function(t,e,s){t.exports=s.p+"img/search_black.8d2ab45b.svg"},"45e1":function(t,e,s){t.exports=s.p+"img/tog_9.b91da4f4.svg"},"46b2":function(t,e,s){var i={"./Dark/search.svg":"dfcb","./Light/search.svg":"9bd5"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="46b2"},"484b":function(t,e,s){t.exports=s.p+"img/tog_4.cc4bee1c.svg"},5710:function(t,e,s){var i={"./Dark/shaixuan.svg":"ea5b","./Light/shaixuan.svg":"a106"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="5710"},"5c30":function(t,e,s){},"6f53":function(t,e,s){"use strict";var i=s("83ab"),a=s("d039"),n=s("e330"),r=s("e163"),c=s("df75"),l=s("fc6a"),o=s("d1e7").f,u=n(o),d=n([].push),h=i&&a((function(){var t=Object.create(null);return t[2]=2,!u(t,2)})),v=function(t){return function(e){var s,a=l(e),n=c(a),o=h&&null===r(a),v=n.length,f=0,p=[];while(v>f)s=n[f++],i&&!(o?s in a:u(a,s))||d(p,t?[s,a[s]]:a[s]);return p}};t.exports={entries:v(!0),values:v(!1)}},"7a8e":function(t,e,s){t.exports=s.p+"img/tog_1.ee8ab329.svg"},8029:function(t,e,s){t.exports=s.p+"img/tog_11.fe0a7d76.svg"},"852b":function(t,e,s){t.exports=s.p+"img/tog_10.2f0ed734.svg"},"8f5e":function(t,e,s){"use strict";s("9e9b")},"984b":function(t,e,s){t.exports=s.p+"img/tog_12.f3a07dcf.svg"},"9bd5":function(t,e,s){t.exports=s.p+"img/search.781ce470.svg"},"9ca0":function(t,e,s){t.exports=s.p+"img/tog_15.2b6a6cf7.svg"},"9e9b":function(t,e,s){},a01f:function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;return e("img",{attrs:{src:t.showAvatar(t.mount,t.body_type)}})},a=[],n=s("01ea"),r={name:"roleAvatar",props:["mount","body_type"],components:{},data:function(){return{}},computed:{},methods:{showAvatar:function(t,e){return n["c"]+"design/avatar/xisai/"+t+"-"+e+".png"}},filters:{},created:function(){},mounted:function(){}},c=r,l=s("2877"),o=Object(l["a"])(c,i,a,!1,null,null,null);e["a"]=o.exports},a36b:function(t,e,s){"use strict";s("5c30")},b4e8:function(t,e,s){t.exports=s.p+"img/tog_7.0dea2d20.svg"},bbdc:function(t,e,s){t.exports=s.p+"img/tog_3.a580ed01.svg"},be26:function(t,e,s){t.exports=s.p+"img/tog_16.ffa7d0d0.svg"},d1be:function(t,e,s){t.exports=s.p+"img/tog_5.40c9a70c.svg"},d1e9:function(t,e,s){t.exports=s.p+"img/tog_8.df78604c.svg"},da83:function(t,e,s){var i={"./tog_1.svg":"7a8e","./tog_10.svg":"852b","./tog_11.svg":"8029","./tog_12.svg":"984b","./tog_13.svg":"2cfb","./tog_15.svg":"9ca0","./tog_16.svg":"be26","./tog_17.svg":"0768","./tog_2.svg":"1aa3","./tog_3.svg":"bbdc","./tog_4.svg":"484b","./tog_40.svg":"fc87","./tog_41.svg":"27aa","./tog_5.svg":"d1be","./tog_6.svg":"2681","./tog_7.svg":"b4e8","./tog_8.svg":"d1e9","./tog_9.svg":"45e1"};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="da83"},dfcb:function(t,e,s){t.exports=s.p+"img/search.4918b175.svg"},fa1f:function(t,e,s){"use strict";s("b0c0"),s("4c53");var i=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"c-catalogue-pop",attrs:{visible:t.visible,direction:"btt",size:"auto"},on:{close:t.handleClose},scopedSlots:t._u([{key:"title",fn:function(){return[t.visible?e("div",{staticClass:"u-category-title"},[e("img",{staticClass:"u-category-icon-img",attrs:{src:t.getIconPath(t.category.sub)}}),e("span",{staticClass:"u-category-name"},[t._v(t._s(t.category.name))])]):t._e()]},proxy:!0}])},[t.visible?e("div",{ref:"infoTop",staticClass:"m-info-top"},[e("div",{staticClass:"m-avatar-list"},[e("div",{staticClass:"m-avatar-item"},[e("div",{staticClass:"u-avatar-placeholder"}),e("div",{staticClass:"m-avatar-info"})]),t._l(t.compareRoles,(function(s){return e("div",{key:s.jx3id,staticClass:"m-avatar-item"},[e("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:s.mount,body_type:s.body_type}}),e("div",{staticClass:"m-avatar-info"},[e("div",{staticClass:"u-avatar-name"},[t._v(t._s(s.name))]),e("div",{staticClass:"u-avatar-server"},[t._v(t._s(s.server))])])],1)})),t._l(3-t.compareRoles.length,(function(t){return e("div",{key:t,staticClass:"m-avatar-item m-avatar-item--add"})}))],2),e("div",{staticClass:"m-progress-section m-progress-section--total"},[e("div",{staticClass:"u-progress-label"},[t._v("总进度")]),t._l(t.category.roleAchievements||[],(function(s,i){return e("div",{key:i,staticClass:"m-progress-value"},[e("div",{staticClass:"u-value-text"},[t._v(t._s(s.progress))]),e("div",{staticClass:"u-percent-symbol"},[t._v("%")])])}))],2),e("div",{staticClass:"m-progress-section m-progress-section--achievement"},[e("div",{staticClass:"u-progress-label"},[t._v("成就数")]),t._l(t.category.roleAchievements||[],(function(s,i){var a;return e("div",{key:i,staticClass:"m-progress-value"},[e("span",{staticClass:"u-value-text"},[t._v(t._s((null===s||void 0===s||null===(a=s.ownAchievements)||void 0===a?void 0:a.length)||s.achievementCount||0))])])}))],2),e("div",{staticClass:"m-progress-section m-progress-section--seniority"},[e("div",{staticClass:"u-progress-label"},[t._v("总资历")]),t._l(t.category.roleAchievements||[],(function(s,i){return e("div",{key:i,staticClass:"m-progress-value"},[e("span",{staticClass:"u-value-text w"},[t._v(t._s(t.setNumber(s.ownPoints,"w")))]),e("span",{staticClass:"u-value-text"},[t._v(t._s(t.setNumber(s.ownPoints)))])])}))],2),t.showDetailBtn?e("div",{staticClass:"u-btn",on:{click:t.handleDetailClick}},[t._v(" 查看详情 ")]):t._e()]):t._e()])},a=[],n=(s("fb6a"),s("d3b7"),s("25f0"),s("a01f")),r={components:{RoleAvatar:n["a"]},props:{category:{type:Object,default:function(){}},compareRoles:{type:Array,default:function(){}},visible:{type:Boolean,default:!1},showDetailBtn:{type:Boolean,default:!0}},computed:{isDark:function(){var t=window.matchMedia("(prefers-color-scheme: dark)");return t.matches}},data:function(){return{title:"",list:[]}},created:function(){},mounted:function(){},methods:{handleClose:function(){this.$emit("update:visible",!1)},getIconPath:function(t){return t?s("da83")("./tog_".concat(t,".svg")):""},setNumber:function(t,e){if(!t)return"";var s=t.toString();return"w"==e?s.length>4?s.slice(0,-4):"":s.length>4?s.slice(-4):s},handleDetailClick:function(){this.$emit("handleDetailClick")}}},c=r,l=(s("8f5e"),s("2877")),o=Object(l["a"])(c,i,a,!1,null,null,null);e["a"]=o.exports},fc87:function(t,e,s){t.exports=s.p+"img/tog_40.ef7c5acf.svg"}}]);