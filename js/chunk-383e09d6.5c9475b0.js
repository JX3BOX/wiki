(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-383e09d6"],{"07ac":function(e,t,i){"use strict";var n=i("23e7"),a=i("6f53").values;n({target:"Object",stat:!0},{values:function(e){return a(e)}})},"13d5":function(e,t,i){"use strict";var n=i("23e7"),a=i("d58f").left,l=i("a640"),s=i("1212"),c=i("9adc"),o=!c&&s>79&&s<83,r=o||!l("reduce");n({target:"Array",proto:!0,forced:r},{reduce:function(e){var t=arguments.length;return a(this,e,t,t>1?arguments[1]:void 0)}})},1450:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("41cb"),a=function(){return Object(n["f"])().get("api/team/my-game-roles?nopage&custom=0")}},"48b2":function(e,t,i){"use strict";i("6f82")},"498a":function(e,t,i){"use strict";var n=i("23e7"),a=i("58a8").trim,l=i("c8d2");n({target:"String",proto:!0,forced:l("trim")},{trim:function(){return a(this)}})},"4c53":function(e,t,i){"use strict";var n=i("23e7"),a=i("857a"),l=i("af03");n({target:"String",proto:!0,forced:l("sub")},{sub:function(){return a(this,"sub","","")}})},"54b6":function(e,t,i){},"6f53":function(e,t,i){"use strict";var n=i("83ab"),a=i("d039"),l=i("e330"),s=i("e163"),c=i("df75"),o=i("fc6a"),r=i("d1e7").f,u=l(r),d=l([].push),m=n&&a((function(){var e=Object.create(null);return e[2]=2,!u(e,2)})),h=function(e){return function(t){var i,a=o(t),l=c(a),r=m&&null===s(a),h=l.length,v=0,f=[];while(h>v)i=l[v++],n&&!(r?i in a:u(a,i))||d(f,e?[i,a[i]]:a[i]);return f}};e.exports={entries:h(!0),values:h(!1)}},"6f82":function(e,t,i){},7471:function(e,t,i){"use strict";i("7503")},7503:function(e,t,i){},"8b86":function(e,t,i){},"8e86":function(e,t,i){},9485:function(e,t,i){"use strict";var n=i("23e7"),a=i("2266"),l=i("59ed"),s=i("825a"),c=i("46c4"),o=i("2a62"),r=i("f99f"),u=i("2ba4"),d=i("d039"),m=TypeError,h=d((function(){[].keys().reduce((function(){}),void 0)})),v=!h&&r("reduce",m);n({target:"Iterator",proto:!0,real:!0,forced:h||v},{reduce:function(e){s(this);try{l(e)}catch(d){o(this,"throw",d)}var t=arguments.length<2,i=t?void 0:arguments[1];if(v)return u(v,this,t?[e]:[e,i]);var n=c(this),r=0;if(a(n,(function(n){t?(t=!1,i=n):i=e(i,n,r),r++}),{IS_RECORD:!0}),t)throw new m("Reduce of empty iterator with no initial value");return i}})},"9b30":function(e,t,i){e.exports=i.p+"img/leap_empty.6e4af458.png"},b85c:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("a4d3"),i("e01a"),i("d28b"),i("d9e2"),i("d3b7"),i("3ca3"),i("ddb0");var n=i("06c5");function a(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Object(n["a"])(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,l=function(){};return{s:l,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return c=e.done,e},e:function(e){o=!0,s=e},f:function(){try{c||null==i["return"]||i["return"]()}finally{if(o)throw s}}}}},c2e7:function(e,t,i){"use strict";i("8e86")},c30e:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-leap-main"},[e.mobile?t("mobile"):t("pc")],1)},a=[],l=(i("caad"),i("d3b7"),i("2532"),i("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-leap-pc"},[t("div",{staticClass:"m-title"},[t("div",{staticClass:"u-label-box"},[t("div",{staticClass:"u-label"},[e._v("渡劫方案")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.list.length>0,expression:"list.length > 0"}],staticClass:"u-btn-created",on:{click:function(t){e.showForm=!0}}},[t("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"}),e._v("定制方案 ")])]),t("div",{staticClass:"m-info-user",style:{opacity:e.currentRole?1:.5}},[t("span",{staticClass:"u-name"},[e._v(e._s(e.currentRole.name)+" "+e._s(e.currentRole.server&&"·")+" "+e._s(e.currentRole.server))]),t("el-dropdown",{attrs:{trigger:"click"}},[t("div",{staticClass:"u-toggle-btn"},[t("img",{attrs:{src:i("e5dd"),alt:""}})]),t("el-dropdown-menu",{staticClass:"m-role-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.roleList,(function(i){return t("el-dropdown-item",{key:i.ID},[t("div",{staticClass:"m-role-item",class:{active:i.jx3id===e.currentRole.jx3id},on:{click:function(t){return e.onChangeRole(i)}}},[t("span",[e._v(e._s(i.name))]),t("span",[e._v(e._s(i.server))])])])})),1)],1),t("div",{staticClass:"u-user-all_achievement"},[e._v(" 当前资历："),t("span",[e._v(e._s(e.currentRole.total||0))])])],1)]),e.showDetail?e._e():t("div",{staticClass:"m-main"},[e._m(0),t("div",{staticClass:"m-tables"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,stripe:"","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[t("el-table-column",{attrs:{prop:"title"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("router-link",{attrs:{target:"_blank",to:{name:"leap",query:{id:i.row.id}}}},[t("div",{staticStyle:{"text-align":"left",height:"24px"}},[e._v(e._s(i.row.title))])])]}}],null,!1,1018025156)},[t("template",{slot:"header"},[t("div",{staticClass:"u-table-cell_left"},[e._v("方案名称")])])],2),t("el-table-column",{attrs:{label:"方案资历总点数",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i;return[e._v(" "+e._s((null===(i=e.getSchemePoints(t.row.schema))||void 0===i?void 0:i.all)||0)+" ")]}}],null,!1,2162533873)}),t("el-table-column",{attrs:{width:"180"},scopedSlots:e._u([{key:"default",fn:function(i){var n;return[t("div",{staticStyle:{"text-align":"right"}},[e._v(e._s((null===(n=e.getSchemePoints(i.row.schema))||void 0===n?void 0:n.diffNum)||0))])]}}],null,!1,4223628313)},[t("template",{slot:"header"},[t("div",{staticClass:"u-table-cell_right"},[e._v("可提升资历点数")])])],2),t("el-table-column",{attrs:{width:"180"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticStyle:{"text-align":"right"}},[e._v(" "+e._s(1==i.row.is_official?"魔盒":"玩家")+" ")])]}}],null,!1,2594864838)},[t("template",{slot:"header"},[t("div",{staticClass:"u-table-cell_right"},[e._v("来源")])])],2),t("el-table-column",{attrs:{width:"180"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",round:""},on:{click:function(t){return e.deleteItem(i.row)}}},[e._v("删除")])],1)]}}],null,!1,2359545554)},[t("template",{slot:"header"},[t("div",{staticClass:"u-table-cell_right"},[e._v("操作")])])],2)],1),t("div",{staticClass:"u-page"},[t("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next","page-size":e.queryParams.per,total:e.pageTotal},on:{"current-change":e.pageChange}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.list.length,expression:"list.length == 0"}],staticClass:"u-btn",on:{click:function(t){e.showForm=!0}}},[t("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"}),t("div",[e._v("定制方案")])])]),t("createFrom",{attrs:{show:e.showForm,currentRole:e.currentRole,pointsData:e.pointsData},on:{reloadList:e.reloadList,cancel:function(t){e.showForm=!1}}}),e.showDetail&&!e.isEmpty(e.currentRole)?t("detail",{attrs:{currentRole:e.currentRole}}):e._e()],1)}),s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"u-tips"},[e._v(" 本功能提供自定义的渡劫成就速成方案"),t("br"),e._v(" ①点击定制方案"),t("br"),e._v(" ②输出方案名称，如地图，并输入你想达到的成就点数"),t("br"),e._v(" ③在自选中，你可以通过选择总览按照分类或地图，选择相应的成就，系统将会按照难度从低到高排列生成 ")])}],c=(i("4de4"),i("14d9"),i("e9f5"),i("910d"),i("7d54"),i("159b"),i("262e")),o=i("c967"),r=(i("ac1f"),i("25f0"),i("5319"),function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"m-dj-form"},[n("el-dialog",{attrs:{title:"创建方案",visible:t.dialogTableVisible,"lock-scroll":"",width:"888px","close-on-click-modal":!1,"custom-class":"m-custom-dialog"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[n("div",{staticClass:"u-dialog-content"},[n("div",{staticClass:"u-dialog-header"},[n("div",{staticClass:"u-dialog-header_item"},[n("span",[t._v("方案名称：")]),n("el-input",{attrs:{placeholder:"请输入"},model:{value:t.leapForm.title,callback:function(e){t.$set(t.leapForm,"title",e)},expression:"leapForm.title"}})],1),n("div",{staticClass:"u-dialog-header_item"},[n("span",[t._v("目标资历：")]),n("el-input",{attrs:{placeholder:"请输入"},model:{value:t.leapForm.number,callback:function(e){t.$set(t.leapForm,"number",t._n(e))},expression:"leapForm.number"}})],1)]),n("div",{staticClass:"u-dialog-tips"},[t._v("请选择个人偏好，盒子娘将会为你制定专属渡劫方案：")]),n("div",{staticClass:"u-dialog-main"},[n("div",{staticClass:"u-dialog-main_left"},[n("div",{staticClass:"u-dialog-main_title"},[t._v("方向")]),n("div",{staticClass:"u-dialog-main_category"},[n("div",{staticClass:"u-dialog-main_category_item",class:{active:1==t.dialogQueryParams.is_official},on:{click:function(e){return t.changeCategory(1)}}},[t._v(" 推荐 ")]),n("div",{staticClass:"u-dialog-main_category_item",class:{active:0==t.dialogQueryParams.is_official},on:{click:function(e){return t.changeCategory(0)}}},[t._v(" 自选 ")])])]),n("div",{staticClass:"u-dialog-main_right"},[n("div",{staticClass:"u-dialog-main_title"},[1==t.dialogQueryParams.is_official?n("span",[t._v("推荐方案")]):n("div",{staticClass:"u-dialog-main_search"},[n("div",{staticClass:"u-dialog-main_search_title"},[t._v(" 自选方案 ")]),2==t.isSelectType?n("div",{staticClass:"u-select-input",class:{noMap:1==t.isSelectSearchType}},[n("el-autocomplete",{attrs:{placeholder:1==t.isSelectSearchType?"输入成就名称/成就描述/称号/奖励物品「回车」进行搜索":"输入地图名称「回车」进行搜索","fetch-suggestions":t.querySearch,"trigger-on-focus":!1,"value-key":"label",size:"mini","popper-class":"m-select-input_popper"},on:{select:t.handleSelect},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchHandle.apply(null,arguments)}},scopedSlots:t._u([{key:"prepend",fn:function(){return[t._t("default",(function(){return[n("el-select",{attrs:{placeholder:"请选择","popper-class":"m-select-input_type"},model:{value:t.isSelectSearchType,callback:function(e){t.isSelectSearchType=e},expression:"isSelectSearchType"}},[n("el-option",{attrs:{label:"成就",value:"1"}}),n("el-option",{attrs:{label:"地图",value:"2"}})],1)]}))]},proxy:!0}],null,!0),model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}},[1==t.isSelectSearchType?n("div",{staticClass:"u-select-input_btn",attrs:{slot:"append"},on:{click:t.searchHandle},slot:"append"},[t._v(" 搜索成就 ")]):t._e()])],1):t._e()])]),1==t.dialogQueryParams.is_official?n("div",{staticClass:"u-dialog-main_recommend"},[t.recommendList.length?t._e():n("div",{staticClass:"u-recommend-empty"},[n("img",{attrs:{src:i("9b30"),width:"300px"}})]),t.recommendList.length?n("div",{staticClass:"u-recommend-list u-common-list"},t._l(t.recommendList,(function(e){return n("div",{key:e.id,staticClass:"u-item",class:{active:e.id==t.selectRecommendItem.id},attrs:{title:e.title},on:{click:function(i){return t.selectRecommend(e)}}},[t._v(" "+t._s(e.title)+" ")])})),0):t._e(),t.recommendList.length?n("div",{staticClass:"u-recommend-desc"},[n("div",{staticClass:"u-recommend-desc_title"},[t._v(" 方案总资历点数："+t._s((null===(e=t.selectRecommendItem)||void 0===e?void 0:e.all)||0)+" ")]),n("div",{staticClass:"u-recommend-desc_source"},[t._v(" 来源："+t._s(t.selectRecommendItem?1==t.selectRecommendItem.is_official?"魔盒":"玩家":"-")+" ")]),n("div",{staticClass:"u-recommend-desc_text"},[n("span",[t._v("简介：")]),n("div",{domProps:{innerHTML:t._s(t.selectRecommendItem.desc)}})])]):t._e()]):n("div",{staticClass:"u-dialog-main_custom"},[n("div",{staticClass:"u-dialog-main_category"},[n("div",{staticClass:"u-dialog-main_category_item",class:{active:1==t.isSelectType},on:{click:function(e){return t.changeSelfCategory(1)}}},[t._v(" 总览 ")]),n("div",{staticClass:"u-dialog-main_category_item",class:{active:2==t.isSelectType},on:{click:function(e){return t.changeSelfCategory(2)}}},[t._v(" 地图 ")])]),1==t.isSelectType?n("div",{staticClass:"u-dialog-main_box"},[n("div",{staticClass:"u-dialog-main_custom_list u-common-list u-first-box"},t._l(t.menuList,(function(e){return n("div",{key:e.id,staticClass:"u-item u-first",class:{active:t.selectMenuItem.id==e.id},on:{click:function(i){return t.selectMenu(e,1)}}},[0==t.selectMenuNum(e)?n("span",[t._v(" "+t._s(e.name))]):n("el-badge",{staticClass:"u-badge-item",attrs:{value:t.selectMenuNum(e)}},[t._v(" "+t._s(e.name)+" ")])],1)})),0),n("div",{staticClass:"u-dialog-main_custom_list u-common-list"},t._l(t.selectMenuItem.children,(function(e){return n("div",{key:e.id,staticClass:"u-item",class:{active:t.selectMenuChildrenItem.id==e.id},on:{click:function(i){return t.selectMenu(e)}}},[n("el-badge",{attrs:{"is-dot":t.isSelectMenu(e)}},[t._v(" "+t._s(e.name)+" ")])],1)})),0),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAchievement,expression:"loadingAchievement"}],staticClass:"u-dialog-main_custom_list u-common-list"},[0==t.achievements.length?n("img",{attrs:{src:i("9b30"),width:"90%"}}):n("div",{staticClass:"u-item u-select-all",on:{click:function(e){return t.selectAllAchievement()}}},[t._v("全部")]),t._l(t.achievements,(function(e){return n("div",{key:e.ID,staticClass:"u-item u-select",class:{"achievement-active":t.isSelectAchievement(e)},on:{click:function(i){return t.selectAchievement(e)}}},[n("img",{attrs:{src:i("f024")}}),n("el-tooltip",{attrs:{effect:"dark",content:e.Name,placement:"top-start"}},[n("div",[t._v(t._s(e.Name))])])],1)}))],2)]):n("div",{staticClass:"u-dialog-main_box"},[n("div",{staticClass:"u-dialog-main_custom_list u-common-list u-first-box"},t._l(t.mapList,(function(e){return n("div",{key:e.value,staticClass:"u-item u-first",class:{active:t.selectMapItem.value==e.value},on:{click:function(i){return t.selectMap(e,1)}}},[0==t.selectMapNum(e)?n("span",[t._v(" "+t._s(e.label))]):n("el-badge",{staticClass:"u-badge-item",attrs:{value:t.selectMapNum(e)}},[t._v(" "+t._s(e.label)+" ")])],1)})),0),n("div",{ref:"mapChildren",staticClass:"u-dialog-main_custom_list u-common-list"},[t.isEmpty(t.selectMapChildrenItem)?n("img",{attrs:{src:i("9b30"),width:"90%"}}):t._e(),t._l(t.selectMapItem.children,(function(e){return n("div",{key:e.value,ref:"itemMap"+e.value,refInFor:!0,staticClass:"u-item",class:{active:t.selectMapChildrenItem.value==e.value},on:{click:function(i){return t.selectMap(e)}}},[n("el-badge",{attrs:{"is-dot":t.isSelectMap(e)}},[t._v(" "+t._s(e.label)+" ")])],1)}))],2),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingAchievement,expression:"loadingAchievement"}],staticClass:"u-dialog-main_custom_list u-common-list"},[0==t.achievements.length?n("img",{attrs:{src:i("9b30"),width:"90%"}}):n("div",{staticClass:"u-item u-select-all",on:{click:function(e){return t.selectAllAchievement()}}},[t._v("全部")]),t._l(t.achievements,(function(e){return n("div",{key:e.ID,staticClass:"u-item u-select",class:{"achievement-active":t.isSelectAchievement(e)},on:{click:function(i){return t.selectAchievement(e)}}},[n("img",{attrs:{src:i("f024")}}),n("el-tooltip",{attrs:{effect:"dark",content:e.Name,placement:"top-start"}},[n("div",[t._v(t._s(e.Name))])])],1)}))],2)])])])]),n("div",{staticClass:"u-filter"},[n("el-checkbox",{model:{value:t.isFilter,callback:function(e){t.isFilter=e},expression:"isFilter"}},[t._v("过滤已完成成就")])],1),n("div",{staticClass:"u-dialog-footer"},[n("div",{staticClass:"u-dialog-footer_tips"},[t._v(" 当前方案共 "),n("span",[t._v(t._s(t.leapForm.all.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历，可为你提供 "),n("span",[t._v(t._s(this.leapForm.diffNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历提升，距离目标还剩 "),n("span",[t._v(t._s(t.leapForm.remaining.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历。 ")]),n("div",{staticClass:"u-btn",on:{click:function(e){return t.submitLeap()}}},[t._v("生成方案")])])])])],1)}),u=[],d=i("2909"),m=(i("99af"),i("7db0"),i("13d5"),i("f665"),i("9485"),i("a9e3"),i("07ac"),i("4c53"),i("2ef0")),h={components:{},props:{show:{type:Boolean,default:!1},currentRole:{type:Object,default:function(){return{}}},pointsData:{type:Object,default:function(){return{}}}},watch:{show:{deep:!0,handler:function(e){e&&this.createLeap(e)}},"leapForm.number":{deep:!0,handler:function(e){this.schemeCompute()}},customList:{deep:!0,handler:function(){this.schemeCompute()}},dialogTableVisible:{handler:function(e){e||this.$emit("cancel",e)}},isFilter:{handler:function(e){this.reloadCustom()}}},data:function(){return{dialogTableVisible:!1,isFilter:!0,leapForm:{title:"",all:0,diffNum:0,remaining:0,number:0},dialogQueryParams:{is_official:1,_no_page:1},recommendList:[],selectRecommendItem:{},isSelectType:1,customList:[],menuList:[],selectMenuItem:{},selectMenuChildrenItem:{},mapList:[],selectMapItem:{},selectMapChildrenItem:{},achievements:[],loadingAchievement:!1,searchInput:"",isSelectSearchType:"2"}},created:function(){},mounted:function(){},methods:{isEmpty:m["isEmpty"],createLeap:function(e){this.getMenuList(),this.loadMapList(),this.dialogTableVisible=e,this.leapForm={title:"",all:0,diffNum:0,remaining:0,number:0},this.dialogQueryParams={is_official:1,_no_page:1},this.customList=[],this.dialogQuery()},changeCategory:function(e){this.leapForm={title:"",all:0,diffNum:0,remaining:0,number:0},this.dialogQueryParams.is_official=e,1==e&&this.dialogQuery()},reloadCustom:function(){this.initCustomList()},getAchievementProgress:function(){var e=this,t=Object(m["cloneDeep"])(this.achievements),i=[];t.forEach((function(e){i.push(e.ID)})),console.log(i),0!=i.length&&Object(o["i"])(i).then((function(i){var n,a=(null===(n=i.data)||void 0===n?void 0:n.data)||[],l=[];a.forEach((function(e,i){var n=t.find((function(t){return t.ID==e.achievement_id}));n&&(e.difficulty=e.difficulty?e.difficulty/10:0,l.push(Object.assign(n,e)))})),e.$set(e,"achievements",Object(m["sortBy"])(l,(function(e){return e.difficulty})))}))},changeSelfCategory:function(e){var t=this;this.customList.length>0&&this.isSelectType!=e?this.$confirm("切换分类将导致之前选择的数据失效，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.isSelectType=e,t.initCustomList()})):(this.isSelectType=e,this.initCustomList())},initCustomList:function(){this.customList=[],1==this.isSelectType?this.selectMenu(this.menuList[1],1):(this.selectMapItem=this.mapList[0],this.selectMapChildrenItem=this.selectMapItem.children[0],this.getMapAchievements(this.selectMapChildrenItem.value))},dialogQuery:function(){var e=this;Object(o["h"])(this.dialogQueryParams).then((function(t){var i;e.recommendList=(null===(i=t.data)||void 0===i?void 0:i.data)||[]}))},selectRecommend:function(e){this.selectRecommendItem=e;var t=this.getSchemePoints(this.selectRecommendItem.schema),i=0;this.leapForm.number>0&&this.leapForm.number>t.diffNum&&(i=this.leapForm.number-t.diffNum),this.leapForm.all=t.all,this.leapForm.diffNum=t.diffNum,this.leapForm.remaining=i},loadMapList:function(){var e=this,t=this.$store.state.client,i={client:t,_no_page:1};Object(c["g"])(i).then((function(t){var i=t.data.data||[],n=Object.values(i.reduce((function(e,t){return t.RegionName?(e[t.RegionName]||(e[t.RegionName]={value:Number(t.Region),label:t.RegionName,children:[]}),e[t.RegionName].children.push({value:Number(t.ID),label:t.MapName,parent:Number(t.Region)}),e):e}),{}));e.mapList=n}))},querySearch:function(e,t){if(1!=this.isSelectSearchType){var i=Object(m["cloneDeep"])(this.mapList),n=[];i.forEach((function(e){n.push.apply(n,Object(d["a"])(e.children))}));var a=e?n.filter((function(t){return-1!=t.label.indexOf(e)})):n;t(a)}else t([])},getMenuList:function(){var e=this;Object(c["i"])({general:1,client:this.$store.state.client}).then((function(t){var i=t.data.data.menus;e.menuList=i,e.initCustomList()}))},getSchemePoints:function(e){var t=this.pointsData,i=[];e.forEach((function(e){i.push({ID:e,Point:t[e]})}));var n=this.schemeCompute(i);return{all:n.all,diffNum:n.diffNum}},selectMenu:function(e,t){var i;1==t?(this.selectMenuItem=e,this.selectMenuChildrenItem={},0==e.achievements.length&&(this.selectMenuChildrenItem=(null===(i=e.children)||void 0===i?void 0:i[0])||{}),this.getMenuAchievements(e.sub,0==e.achievements.length?this.selectMenuChildrenItem.detail:"")):(this.selectMenuChildrenItem=e,this.getMenuAchievements(e.sub,e.detail))},getMenuAchievements:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0;this.loadingAchievement=!0,Object(c["h"])(t,i).then((function(t){var i=t.data.data.achievements||[],n=[];if(i.forEach((function(e){n.push(e),e.SeriesAchievementList&&e.SeriesAchievementList.forEach((function(e,t){t>0&&n.push(e)}))})),e.isFilter){var a=[];n.forEach((function(t){-1==e.currentRole.achievements.indexOf(t.ID)&&a.push(t)})),e.achievements=a}else e.achievements=n;e.getAchievementProgress()})).finally((function(){e.loadingAchievement=!1}))},selectMenuNum:function(e){for(var t=0,i=this.customList,n=i.length,a=0;a<n;a++)i[a].Sub==e.sub&&t++;return t},isSelectMenu:function(e,t){for(var i=!1,n=this.customList,a=n.length,l=0;l<a;l++)if(1==t){if(n[l].Sub==e.sub&&!n[l].Detail){i=!0;break}}else if(n[l].Detail==e.detail){i=!0;break}return i},isSelectAchievement:function(e){for(var t=!1,i=this.customList,n=i.length,a=0;a<n;a++)if(i[a].ID==e.ID){t=!0;break}return t},selectMap:function(e,t){var i;1==t?(this.selectMapItem=e,this.selectMapChildrenItem=(null===(i=e.children)||void 0===i?void 0:i[0])||{}):this.selectMapChildrenItem=e;this.getMapAchievements(this.selectMapChildrenItem.value)},searchHandle:function(){var e=this.searchInput;this.selectMapItem={},this.selectMapChildrenItem={},this.getMapAchievements("",e)},getMapAchievements:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={keyword:i,scene:t,client:this.$store.state.client,_no_page:1,limit:99999};Object(c["r"])(n).then((function(t){var i=t.data.data.achievements||[];if(e.isFilter){var n=[];i.forEach((function(t){-1==e.currentRole.achievements.indexOf(t.ID)&&n.push(t)})),e.achievements=n}else e.achievements=i;e.getAchievementProgress()}))},handleSelect:function(e){var t=this,i=this.mapList.find((function(t){return t.value==e.parent}));this.selectMapItem=i,this.selectMapChildrenItem=e,this.getMapAchievements(e.value),this.$nextTick((function(){var i=t.$refs["itemMap"+e.value];if(i){var n=t.$refs.mapChildren,a=i[0].offsetTop,l=(i[0].offsetHeight,a-240);n.scrollTop=l}}))},selectMapNum:function(e){var t=this,i=0;return e.children.forEach((function(e){t.customList.forEach((function(t){e.value==t.SceneID&&i++}))})),i},isSelectMap:function(e){for(var t=!1,i=this.customList,n=i.length,a=0;a<n;a++)if(i[a].SceneID==e.value){t=!0;break}return t},selectAllAchievement:function(){var e=this;1==this.isSelectType?Object(m["isEmpty"])(this.selectMenuChildrenItem)?this.isSelectMenu(this.selectMenuItem,1)?this.customList=this.customList.filter((function(t){return t.Sub!=e.selectMenuItem.sub||t.Sub==e.selectMenuItem.sub&&null!=t.Detail})):this.customList=this.customList.concat(this.achievements):this.isSelectMenu(this.selectMenuChildrenItem)?this.customList=this.customList.filter((function(t){return t.Detail!=e.selectMenuChildrenItem.detail})):this.customList=this.customList.concat(this.achievements):this.isSelectMap(this.selectMapChildrenItem)?this.customList=this.customList.filter((function(t){return t.SceneID!=e.selectMapChildrenItem.value})):this.customList=this.customList.concat(this.achievements)},selectAchievement:function(e){this.isSelectAchievement(e)?this.customList=this.customList.filter((function(t){return t.ID!=e.ID})):this.customList.push(e)},schemeCompute:function(e){var t=0,i=0,n=0,a=this,l=e||this.customList,s=l.filter((function(e){var i;return t+=e.Point,-1==(null===(i=a.currentRole.achievements)||void 0===i?void 0:i.indexOf(e.ID))||!1}));if(s.forEach((function(e){i+=e.Point})),e)return{all:t,diffNum:i};n=Number(this.leapForm.number)-this.currentRole.total-i,this.leapForm.all=t,this.leapForm.diffNum=i,this.leapForm.remaining=n>0?n:0},submitLeap:function(){var e=this,t=[];if(this.customList.forEach((function(e){t.push(e.ID)})),Object(m["isEmpty"])(this.leapForm.title))return this.$message.warning("请输入方案名称");if(!Number(this.leapForm.number))return this.$message.warning("请输入目标资历");var i={createBy:"recommend"};0==this.dialogQueryParams.is_official&&(i.createBy=1==this.isSelectType?"overview":"map");var n={title:Object(m["isEmpty"])(this.leapForm.title)?"未命名方案":this.leapForm.title,schema:t,meta:i};Object(o["a"])(n).then((function(t){e.dialogTableVisible=!1,e.$message.success("创建成功"),e.$emit("reloadList",t.data.data);var i=e.$router.resolve({name:"leap",query:{id:t.data.data.id}});window.open(i.href,"_blank")}))}}},v=h,f=(i("c2e7"),i("2877")),p=Object(f["a"])(v,r,u,!1,null,null,null),g=p.exports,_=function(){var e,t=this,i=t._self._c;return i("div",{staticClass:"m-detail"},[i("div",{staticClass:"u-detail-left"},[i("ul",{staticClass:"u-detail-left_item"},[i("li",{staticClass:"u-menu-parent u-menu-text",class:{active:null==t.detailSelectMenu},on:{click:function(e){return t.changeDetailMenu(null,0)}}},[t._v(" 全部 ")])]),"map"==(null===(e=t.detail.meta)||void 0===e?void 0:e.createBy)?i("div",t._l(t.mapList,(function(e,n){return i("div",{key:n},[e.show?i("ul",{staticClass:"u-detail-left_item"},[i("li",{staticClass:"u-menu-parent u-menu-text"},[t._v(" "+t._s(e.label)+" ")]),t._l(e.children,(function(e,n){return i("div",{key:n,on:{click:function(i){return i.stopPropagation(),t.changeDetailMenu(e,2)}}},[e.show?i("li",{staticClass:"u-menu-item_children u-menu-text",class:{active:t.detailSelectMenu==e.value}},[t._v(" "+t._s(e.label)+" ")]):t._e()])}))],2):t._e()])})),0):i("div",t._l(t.menuList,(function(e,n){return i("div",{key:n,on:{click:function(i){return t.changeDetailMenu(e,1)}}},[e.show?i("ul",{staticClass:"u-detail-left_item"},[i("li",{staticClass:"u-menu-parent u-menu-text",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.name)+" ")]),t._l(e.children,(function(e,n){return i("div",{key:n,on:{click:function(i){return i.stopPropagation(),t.changeDetailMenu(e,2)}}},[e.show?i("li",{staticClass:"u-menu-item_children u-menu-text",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.name)+" ")]):t._e()])}))],2):t._e()])})),0)]),i("div",{staticClass:"u-detail-right"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.detail.achievements||[],stripe:"",height:"100%","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[i("el-table-column",{attrs:{prop:"Name",label:"成就名称"},scopedSlots:t._u([{key:"default",fn:function(e){var n;return[i("a",{attrs:{href:t.getLink("achievement",e.row.ID),target:"_blank"}},[i("div",{staticClass:"u-achievement-name"},[i("img",{staticClass:"u-icon",attrs:{src:t.iconLink(null===(n=e.row)||void 0===n?void 0:n.IconID)}}),i("span",[t._v(t._s(e.row.Name))])])])]}}])}),i("el-table-column",{attrs:{label:"资历点数",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.Point||0)+" ")]}}])}),i("el-table-column",{attrs:{label:"完成情况",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:e.row.isCompleted?"success":"danger"}},[t._v(t._s(e.row.isCompleted?"已完成":"未完成"))])]}}])}),i("el-table-column",{attrs:{label:"难度",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-rate",{attrs:{value:e.row.difficulty,disabled:"","allow-half":"","disabled-void-color":"#574938"}})]}}])}),i("el-table-column",{attrs:{label:"奖励",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var n;return[e.row.item?i("el-tooltip",{attrs:{placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("jx3-item",{attrs:{item:e.row.item}})],1),i("img",{staticClass:"u-icon",attrs:{src:t.iconLink(null===(n=e.row.item)||void 0===n?void 0:n.IconID)}})]):t._e()]}}])})],1)],1)])},b=[],y=(i("d81d"),i("ab43"),i("b680"),i("b64b"),i("c7fa")),C=i("85e4"),w={components:{"jx3-item":y["a"]},props:{currentRole:{type:Object}},data:function(){return{menuList:[],mapList:[],detail:{},detailSelectMenu:null,loading:!1}},watch:{currentRole:{deep:!0,handler:function(e,t){console.log(e,t),this.getSchemaDetail()}}},created:function(){},mounted:function(){},methods:{iconLink:C["l"],getLink:C["f"],getSchemaDetail:function(){var e,t,i=this;if((null===(e=this.detail)||void 0===e||null===(t=e.achievements)||void 0===t?void 0:t.length)>0){for(var n,a,l,s,c,r=null===(n=this.detail)||void 0===n||null===(a=n.achievements)||void 0===a?void 0:a.length,u=null===(l=this.detail)||void 0===l?void 0:l.achievements,d=(null===(s=this.currentRole)||void 0===s||null===(c=s.achievements)||void 0===c?void 0:c.split(","))||[],h=0;h<r;h++)u[h].isCompleted=d.includes(u[h].ID.toString());return this.$set(this.detail,"achievements",u),void(this.detail.achievementsBak=Object(m["cloneDeep"])(this.detail.achievements))}Object(o["g"])(this.$route.query.id).then((function(e){var t,n,a,l,s,c,o,r,u,d;(i.detail=(null===(t=e.data)||void 0===t?void 0:t.data)||{},(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a||null===(l=a.schema)||void 0===l?void 0:l.length)>0)&&("map"==(null===(s=i.detail)||void 0===s||null===(c=s.meta)||void 0===c?void 0:c.createBy)?i.loadMapList(null===e||void 0===e||null===(o=e.data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.schema):i.getMenuList(null===e||void 0===e||null===(u=e.data)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.schema))}))},loadMapList:function(e){var t=this,i=this.$store.state.client,n={client:i,_no_page:1};Object(c["g"])(n).then((function(i){var n=i.data.data||[],a=Object.values(n.reduce((function(e,t){return t.RegionName?(e[t.RegionName]||(e[t.RegionName]={value:Number(t.Region),label:t.RegionName,children:[]}),e[t.RegionName].children.push({value:Number(t.ID),label:t.MapName,parent:Number(t.Region)}),e):e}),{}));t.mapList=a,t.getAchievements(e)}))},getMenuList:function(e){var t=this;Object(c["i"])({general:1,client:this.$store.state.client}).then((function(i){var n=i.data.data.menus;t.menuList=n,t.getAchievements(e)}))},getAchievements:function(e){var t,i=this;this.loading=!0;var n="Name,Sub,Detail,IconID,Point,ID";"map"==(null===(t=this.detail.meta)||void 0===t?void 0:t.createBy)&&(n="Name,IconID,Point,SceneID,ID"),Object(c["c"])({ids:e.toString(),attributes:n}).then((function(e){for(var t,n,a,l,s,c=(null===(t=e.data)||void 0===t?void 0:t.data)||[],o=c.length,r=(null===(n=i.currentRole)||void 0===n||null===(a=n.achievements)||void 0===a?void 0:a.split(","))||[],u=[],d=0;d<o;d++)u.push(c[d].ID),c[d].isCompleted=r.includes(c[d].ID.toString());if("map"==(null===(l=i.detail)||void 0===l||null===(s=l.meta)||void 0===s?void 0:s.createBy)){var h=Object(m["cloneDeep"])(i.mapList);h.forEach((function(e){e.children.forEach((function(t){for(var i=0;i<o;i++){var n=c.find((function(e){return e.SceneID==t.value}));n&&(t.show=!0,e.show=!0)}}))})),i.$set(i,"mapList",h)}else{var v=Object(m["cloneDeep"])(i.menuList);Object.keys(v).map((function(e){v[e].children.forEach((function(t){for(var i=0;i<o;i++)v[e].sub==c[i].Sub&&(v[e].show=!0),c[i].Detail==t.detail&&(t.show=!0)}))})),i.$set(i,"menuList",v)}i.loading=!1,i.getAchievementProgress(u,c)}))},getAchievementProgress:function(e,t){var i=this;this.loading=!0,Object(o["i"])(e).then((function(e){var n,a=(null===(n=e.data)||void 0===n?void 0:n.data)||[];i.detail.progressAndDifficulty=a;var l=[];a.forEach((function(e,i){var n=t.find((function(t){return t.ID==e.achievement_id}));n&&(e.difficulty=e.difficulty?e.difficulty/10:0,l.push(Object.assign(n,e)))})),i.$set(i.detail,"achievements",Object(m["sortBy"])(l,(function(e){return e.difficulty}))),i.detail.achievementsBak=Object(m["cloneDeep"])(i.detail.achievements),i.loading=!1}))},getDifficulty:function(){var e=this,t=[];this.detail.achievementsBak.forEach((function(i){var n=e.detail.progressAndDifficulty.find((function(e){return e.achievement_id==i.ID}));i.difficulty=((null===n||void 0===n?void 0:n.difficulty)||0)/10,i.process=((n.completed_role_count/n.total_role_count*100).toFixed(2)||0)+"%",t.push(i)})),this.$set(this.detail,"achievements",t),this.$forceUpdate()},changeDetailMenu:function(e,t){var i,n;if(0==t)return this.detailSelectMenu=null,void(this.detail.achievements=Object(m["cloneDeep"])(this.detail.achievementsBak));"map"==(null===(i=this.detail.meta)||void 0===i?void 0:i.createBy)&&(this.detailSelectMenu=e.value),"map"==(null===(n=this.detail.meta)||void 0===n?void 0:n.createBy)?this.detailSelectMenu=e.value:this.detailSelectMenu=e.id;for(var a=[],l=this.detail.achievementsBak,s=l.length,c=0;c<s;c++){var o;"map"==(null===(o=this.detail.meta)||void 0===o?void 0:o.createBy)?l[c].SceneID==e.value&&a.push(l[c]):(1==t&&l[c].Sub==e.sub||2==t&&l[c].Detail==e.detail)&&a.push(l[c])}this.detail.achievements=a}}},S=w,k=(i("c953"),Object(f["a"])(S,_,b,!1,null,null,null)),L=k.exports,I=i("c9d2"),D=i("1450"),M={components:{createFrom:g,detail:L},data:function(){return{currentRole:{},roleList:[],loading:!1,list:[],queryParams:{page:1,per:9},pageTotal:0,showForm:!1,pointsData:{},showDetail:!1}},watch:{},created:function(){this.loadUserRoles(),this.$route.query.id&&(this.showDetail=!0)},mounted:function(){},methods:{iconLink:C["l"],getLink:C["f"],isEmpty:m["isEmpty"],reloadList:function(){this.showForm=!1,this.getSchemaList()},loadUserRoles:function(){var e=this;I["a"].isLogin()?Object(D["a"])().then((function(t){var i,n,a,l;e.roleList=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[],e.currentRole=(null===(a=t.data)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.list[0])||{},e.getPoints()})):this.$confirm("请先登录").then((function(e){I["a"].toLogin(window.location.href)}))},getPoints:function(){var e=this;return Object(c["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.getSchemaList()}))},onChangeRole:function(e){this.getRoleGameAchievements(e)},getRoleGameAchievements:function(e){var t=this;Object(c["m"])((null===e||void 0===e?void 0:e.jx3id)||this.currentRole.jx3id).then((function(i){var n,a;e&&(t.currentRole=e),t.currentRole.achievements=(null===(n=i.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.achievements)||[];var l=0,s=Object(m["cloneDeep"])(t.currentRole.achievements).split(",")||[];s.forEach((function(e){l+=t.pointsData[e]||0})),t.$set(t.currentRole,"total",l)}))},pageChange:function(e){this.queryParams.page=e,this.getSchemaList(!0)},getSchemaList:function(e){var t=this;this.loading=!0,Object(o["h"])(this.queryParams).then((function(i){var n,a,l,s;t.list=(null===(n=i.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.list)||[],t.pageTotal=(null===(l=i.data)||void 0===l||null===(s=l.data)||void 0===s?void 0:s.total)||0,e||t.getRoleGameAchievements()})).finally((function(){t.loading=!1}))},getSchemePoints:function(e){var t=this.pointsData,i=[];e.forEach((function(e){i.push({ID:e,Point:t[e]})}));var n=this.schemeCompute(i);return{all:n.all,diffNum:n.diffNum}},schemeCompute:function(e){var t=0,i=0,n=this,a=e||this.customList,l=a.filter((function(e){var i;return t+=e.Point,-1==(null===(i=n.currentRole.achievements)||void 0===i?void 0:i.indexOf(e.ID))||!1}));return l.forEach((function(e){i+=e.Point})),{all:t,diffNum:i}},deleteItem:function(e){var t=this;this.$confirm("是否确定要删除方案".concat(e.title,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])(e.id).then((function(e){t.$message.success("删除成功"),t.getSchemaList()}))}))}}},R=M,j=(i("48b2"),Object(f["a"])(R,l,s,!1,null,null,null)),O=j.exports,x=function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"p-leap-mobile",class:{fold:t.isFold}},[n("div",{staticClass:"m-overview-header_mobile"},[n("div",{staticClass:"u-name"},[n("i",{class:t.isFold?"el-icon-s-unfold":"el-icon-s-fold ",on:{click:t.changeFold}}),t._v("  ")]),n("div",{staticClass:"u-select"},[n("el-dropdown",{attrs:{trigger:"click"}},[n("div",{staticClass:"u-select-btn"},[n("span",[t._v(t._s(t.currentRole.name)+" "+t._s(t.currentRole.server&&"·")+" "+t._s(t.currentRole.server))]),n("img",{attrs:{src:i("e5dd"),alt:"",width:"16px",height:"16px"}})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.roleList,(function(e){return n("el-dropdown-item",{key:e.ID},[n("div",{staticClass:"m-role-item",on:{click:function(i){return t.onChangeRole(e)}}},[n("span",[t._v(t._s(e.name))]),n("span",[t._v(t._s(e.server))])])])})),1)],1)],1)]),!t.isFold&&t.isDetail&&"map"==(null===(e=t.detail.meta)||void 0===e?void 0:e.createBy)?n("div",{staticClass:"m-achievement-tab"},[n("ul",{staticClass:"u-zl-item",class:{active:null==t.detailSelectMenu}},[n("div",{staticClass:"u-zl-item_title",on:{click:function(e){return t.changeDetailMenu(null,0)}}},[t._v("全部")])]),t._l(t.mapList,(function(e,i){return n("div",{key:i},[e.show?n("ul",{staticClass:"u-zl-item"},[n("div",{staticClass:"u-zl-item_title"},[t._v(t._s(e.label))]),t._l(e.children,(function(e,i){return n("div",{key:i,on:{click:function(i){return i.stopPropagation(),t.changeDetailMenu(e,2)}}},[e.show?n("li",{staticClass:"u-zl-item_children",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.label)+" ")]):t._e()])}))],2):t._e()])}))],2):n("div",{staticClass:"m-achievement-tab"},[n("ul",{staticClass:"u-zl-item",class:{active:null==t.detailSelectMenu}},[n("div",{staticClass:"u-zl-item_title",on:{click:function(e){return t.changeDetailMenu(null,0)}}},[t._v("全部")])]),t._l(t.menuList,(function(e,i){return n("div",{key:i,on:{click:function(i){return t.changeDetailMenu(e,1)}}},[e.show?n("ul",{staticClass:"u-zl-item",class:{active:t.detailSelectMenu==e.id}},[n("div",{staticClass:"u-zl-item_title"},[t._v(t._s(e.name))]),t._l(e.children,(function(e,i){return n("div",{key:i,on:{click:function(i){return i.stopPropagation(),t.changeDetailMenu(e,2)}}},[e.show?n("li",{staticClass:"u-zl-item_children",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.name)+" ")]):t._e()])}))],2):t._e()])}))],2),t.isDetail?n("div",{staticClass:"m-leap-detail"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.detail.achievements||[],stripe:"",height:"100%","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[n("el-table-column",{attrs:{prop:"Name",label:"成就名称"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[n("a",{attrs:{href:t.getLink("achievement",e.row.ID),target:"_blank"}},[n("div",{staticClass:"u-achievement-name"},[n("img",{staticClass:"u-icon",attrs:{src:t.iconLink(null===(i=e.row)||void 0===i?void 0:i.IconID)}}),n("span",[t._v(t._s(e.row.Name))])])])]}}])}),n("el-table-column",{attrs:{label:"资历点数",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.Point||0)+" ")]}}])}),n("el-table-column",{attrs:{label:"完成情况",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:e.row.isCompleted?"success":"danger"}},[t._v(t._s(e.row.isCompleted?"已完成":"未完成"))])]}}])}),n("el-table-column",{attrs:{label:"难度",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-rate",{attrs:{value:e.row.difficulty,disabled:"","allow-half":"","disabled-void-color":"#574938"}})]}}])}),n("el-table-column",{attrs:{label:"奖励",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[e.row.item?n("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"}},[n("div",[n("jx3-item",{attrs:{item:e.row.item}})],1),n("img",{staticClass:"u-icon",attrs:{slot:"reference",src:t.iconLink(null===(i=e.row.item)||void 0===i?void 0:i.IconID)},slot:"reference"})]):t._e()]}}])})],1)],1):n("div",{staticClass:"m-leap-main"},[n("el-table",{staticStyle:{width:"100%","max-height":"calc(100vh - 85px)"},attrs:{data:t.list,height:"100%",stripe:"","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[n("el-table-column",{attrs:{prop:"title",label:"方案名称",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("router-link",{attrs:{target:"_blank",to:{name:"leap",query:{id:e.row.id}}}},[t._v(" "+t._s(e.row.title)+" ")])]}}],null,!1,2830009994)}),n("el-table-column",{attrs:{label:"方案资历总点数",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[t._v(" "+t._s((null===(i=t.getSchemePoints(e.row.schema))||void 0===i?void 0:i.all)||0)+" ")]}}],null,!1,2162533873)}),n("el-table-column",{attrs:{label:"可提升资历点数",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[t._v(" "+t._s((null===(i=t.getSchemePoints(e.row.schema))||void 0===i?void 0:i.diffNum)||0)+" ")]}}],null,!1,1534313675)}),n("el-table-column",{attrs:{label:"来源",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1==e.row.is_official?"魔盒":"玩家")+" ")]}}],null,!1,2935795252)})],1),n("div",{staticClass:"u-page"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next","page-size":t.queryParams.per,total:t.pageTotal},on:{"current-change":t.pageChange}})],1)],1)])},N=[],A={components:{"jx3-item":y["a"]},data:function(){return{isFold:!1,isDetail:!1,currentRole:{},roleList:[],loading:!1,menuList:[],selectMenuItem:{},selectMenuChildrenItem:{},achievements:[],list:[],queryParams:{page:1,per:20},pageTotal:0,customList:[],detail:{},detailSelectMenu:null,detailPageTotal:0,mapList:[]}},created:function(){this.loadUserRoles()},mounted:function(){},methods:{changeFold:function(){this.isFold=!this.isFold,this.$store.commit("SET_STATE",{key:"is_fold",value:this.isFold})},iconLink:C["l"],getLink:C["f"],getMenuList:function(e){var t=this;Object(c["i"])({general:1,client:this.$store.state.client}).then((function(i){var n=i.data.data.menus;t.menuList=n,t.isDetail&&t.getAchievements(e)}))},loadUserRoles:function(){var e=this;I["a"].isLogin()&&Object(D["a"])().then((function(t){var i,n,a,l;e.roleList=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[],e.currentRole=(null===(a=t.data)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.list[0])||{},e.$route.query.id?(e.isDetail=!0,e.getRoleGameAchievements()):e.getPoints()}))},getPoints:function(){var e=this;return Object(c["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.getRoleGameAchievements()}))},onChangeRole:function(e){this.currentRole=e,this.getRoleGameAchievements()},getRoleGameAchievements:function(){var e=this;Object(c["m"])(this.currentRole.jx3id).then((function(t){var i,n;if(e.currentRole.achievements=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.achievements)||[],e.isDetail){var a,l;if((null===(a=e.detail)||void 0===a||null===(l=a.achievements)||void 0===l?void 0:l.length)>0){for(var s,c,o,r,u,d=null===(s=e.detail)||void 0===s||null===(c=s.achievements)||void 0===c?void 0:c.length,h=null===(o=e.detail)||void 0===o?void 0:o.achievements,v=(null===(r=e.currentRole)||void 0===r||null===(u=r.achievements)||void 0===u?void 0:u.split(","))||[],f=0;f<d;f++)h[f].isCompleted=v.includes(h[f].ID.toString());return e.$set(e.detail,"achievements",h),void(e.detail.achievementsBak=Object(m["cloneDeep"])(e.detail.achievements))}e.getSchemaDetail()}else{var p=0,g=Object(m["cloneDeep"])(e.currentRole.achievements).split(",")||[];g.forEach((function(t){p+=e.pointsData[t]||0})),e.$set(e.currentRole,"total",p)}}))},pageChange:function(e){this.queryParams.page=e,this.getSchemaList(!0)},getSchemaList:function(e){var t=this;Object(o["h"])(this.queryParams).then((function(i){var n,a,l,s;t.list=(null===(n=i.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.list)||[],t.pageTotal=(null===(l=i.data)||void 0===l||null===(s=l.data)||void 0===s?void 0:s.total)||0,e||t.getRoleGameAchievements()}))},getSchemePoints:function(e){var t=this.pointsData,i=[];e.forEach((function(e){i.push({ID:e,Point:t[e]})}));var n=this.schemeCompute(i);return{all:n.all,diffNum:n.diffNum}},getSchemaDetail:function(){var e=this;Object(o["g"])(this.$route.query.id).then((function(t){var i,n,a,l,s,c,o,r,u,d;(e.detail=(null===(i=t.data)||void 0===i?void 0:i.data)||{},(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(a=n.data)||void 0===a||null===(l=a.schema)||void 0===l?void 0:l.length)>0)&&("map"==(null===(s=e.detail)||void 0===s||null===(c=s.meta)||void 0===c?void 0:c.createBy)?e.loadMapList(null===t||void 0===t||null===(o=t.data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.schema):e.getMenuList(null===t||void 0===t||null===(u=t.data)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.schema))}))},loadMapList:function(e){var t=this,i=this.$store.state.client,n={client:i,_no_page:1};Object(c["g"])(n).then((function(i){var n=i.data.data||[],a=Object.values(n.reduce((function(e,t){return t.RegionName?(e[t.RegionName]||(e[t.RegionName]={value:Number(t.Region),label:t.RegionName,children:[]}),e[t.RegionName].children.push({value:Number(t.ID),label:t.MapName,parent:Number(t.Region)}),e):e}),{}));t.mapList=a,t.getAchievements(e)}))},getAchievements:function(e){var t,i=this;this.loading=!0;var n="Name,Sub,Detail,IconID,Point,ID";"map"==(null===(t=this.detail.meta)||void 0===t?void 0:t.createBy)&&(n="Name,IconID,Point,SceneID,ID"),Object(c["c"])({ids:e.toString(),attributes:n}).then((function(e){for(var t,n,a,l,s,c=(null===(t=e.data)||void 0===t?void 0:t.data)||[],o=c.length,r=(null===(n=i.currentRole)||void 0===n||null===(a=n.achievements)||void 0===a?void 0:a.split(","))||[],u=[],d=0;d<o;d++)u.push(c[d].ID),c[d].isCompleted=r.includes(c[d].ID.toString());if("map"==(null===(l=i.detail)||void 0===l||null===(s=l.meta)||void 0===s?void 0:s.createBy)){var h=Object(m["cloneDeep"])(i.mapList);h.forEach((function(e){e.children.forEach((function(t){for(var i=0;i<o;i++){var n=c.find((function(e){return e.SceneID==t.value}));n&&(t.show=!0,e.show=!0)}}))})),i.$set(i,"mapList",h)}else{var v=Object(m["cloneDeep"])(i.menuList);Object.keys(v).map((function(e){v[e].children.forEach((function(t){for(var i=0;i<o;i++)v[e].sub==c[i].Sub&&(v[e].show=!0),c[i].Detail==t.detail&&(t.show=!0)}))})),i.$set(i,"menuList",v)}i.loading=!1,i.getAchievementProgress(u,c)}))},getAchievementProgress:function(e,t){var i=this;Object(o["i"])(e).then((function(e){var n,a=(null===(n=e.data)||void 0===n?void 0:n.data)||[];i.detail.progressAndDifficulty=a;var l=[];a.forEach((function(e,i){var n=t.find((function(t){return t.ID==e.achievement_id}));n&&(e.difficulty=e.difficulty?e.difficulty/10:0,l.push(Object.assign(n,e)))})),i.$set(i.detail,"achievements",Object(m["sortBy"])(l,(function(e){return e.difficulty}))),i.detail.achievementsBak=Object(m["cloneDeep"])(i.detail.achievements)}))},changeDetailMenu:function(e,t){var i,n;if(0==t)return this.detailSelectMenu=null,void(this.detail.achievements=Object(m["cloneDeep"])(this.detail.achievementsBak));"map"==(null===(i=this.detail.meta)||void 0===i?void 0:i.createBy)&&(this.detailSelectMenu=e.value),"map"==(null===(n=this.detail.meta)||void 0===n?void 0:n.createBy)?this.detailSelectMenu=e.value:this.detailSelectMenu=e.id;for(var a=[],l=this.detail.achievementsBak,s=l.length,c=0;c<s;c++){var o;"map"==(null===(o=this.detail.meta)||void 0===o?void 0:o.createBy)?l[c].SceneID==e.value&&a.push(l[c]):(1==t&&l[c].Sub==e.sub||2==t&&l[c].Detail==e.detail)&&a.push(l[c])}this.detail.achievements=a},schemeCompute:function(e){var t=0,i=0,n=this,a=e||this.customList,l=a.filter((function(e){var i;return t+=e.Point,-1==(null===(i=n.currentRole.achievements)||void 0===i?void 0:i.indexOf(e.ID))||!1}));return l.forEach((function(e){i+=e.Point})),{all:t,diffNum:i}}}},P=A,F=(i("7471"),Object(f["a"])(P,x,N,!1,null,null,null)),T=F.exports,E={components:{pc:O,mobile:T},data:function(){return{}},computed:{mobile:function(){var e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipad","ipod","windows phone"];return t.some((function(t){return e.includes(t)}))}},created:function(){},mounted:function(){},methods:{}},$=E,B=(i("ee81"),Object(f["a"])($,n,a,!1,null,"221f15b6",null));t["default"]=B.exports},c8d2:function(e,t,i){"use strict";var n=i("5e77").PROPER,a=i("d039"),l=i("5899"),s="​᠎";e.exports=function(e){return a((function(){return!!l[e]()||s[e]()!==s||n&&l[e].name!==e}))}},c953:function(e,t,i){"use strict";i("8b86")},c967:function(e,t,i){"use strict";i.d(t,"j",(function(){return a})),i.d(t,"f",(function(){return l})),i.d(t,"e",(function(){return s})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return o})),i.d(t,"h",(function(){return r})),i.d(t,"a",(function(){return u})),i.d(t,"g",(function(){return d})),i.d(t,"l",(function(){return m})),i.d(t,"b",(function(){return h})),i.d(t,"i",(function(){return v})),i.d(t,"k",(function(){return f}));var n=i("41cb");function a(e){return Object(n["a"])().get("/api/cms/wiki/post/rank",{params:e})}function l(e,t){return Object(n["a"])().get("/api/cms/wiki/post/id/".concat(e),{params:t})}function s(e){return Object(n["a"])({mute:!0}).get("/api/cms/user/".concat(e,"/info"))}function c(e){return Object(n["a"])().get("/api/cms/user/kith/my")}function o(e){return Object(n["a"])().get("/api/cms/user/kith/game-roles/".concat(e))}function r(e){return Object(n["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema",{params:e})}function u(e){return Object(n["a"])().post("/api/cms/pvx/wiki_achievement_leap_schema",e)}function d(e){return Object(n["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function m(e,t){return Object(n["a"])().put("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e),t)}function h(e){return Object(n["a"])().delete("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function v(e){return Object(n["a"])().post("/api/cms/pvx/wiki_achievement_difficulty/list",e)}function f(e){return Object(n["a"])().post("/api/cms/qqbot/picture_task",e)}},d58f:function(e,t,i){"use strict";var n=i("59ed"),a=i("7b0b"),l=i("44ad"),s=i("07fa"),c=TypeError,o="Reduce of empty array with no initial value",r=function(e){return function(t,i,r,u){var d=a(t),m=l(d),h=s(d);if(n(i),0===h&&r<2)throw new c(o);var v=e?h-1:0,f=e?-1:1;if(r<2)while(1){if(v in m){u=m[v],v+=f;break}if(v+=f,e?v<0:h<=v)throw new c(o)}for(;e?v>=0:h>v;v+=f)v in m&&(u=i(u,m[v],v,d));return u}};e.exports={left:r(!1),right:r(!0)}},e5dd:function(e,t,i){e.exports=i.p+"img/toggle-user-icon.4a7a0c8b.svg"},ee81:function(e,t,i){"use strict";i("54b6")},f024:function(e,t,i){e.exports=i.p+"img/tick.d0920657.svg"}}]);
//# sourceMappingURL=chunk-383e09d6.5c9475b0.js.map