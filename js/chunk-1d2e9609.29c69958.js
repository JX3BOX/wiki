(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d2e9609"],{"049c":function(e,t,i){},"0636":function(e,t,i){e.exports=i.p+"img/tog_15.1f7bb44b.svg"},"0731":function(e,t,i){var s={"./Dark/jia.svg":"7bad","./Light/jia.svg":"e51b"};function n(e){var t=a(e);return i(t)}function a(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=a,e.exports=n,n.id="0731"},"07cb":function(e,t,i){e.exports=i.p+"img/tog_12.eb4b8e89.svg"},"0a8a":function(e,t,i){e.exports=i.p+"img/tog_41.e54c1e63.svg"},"0c74":function(e,t,i){e.exports=i.p+"img/tog_9.63ff7127.svg"},"13d5":function(e,t,i){"use strict";var s=i("23e7"),n=i("d58f").left,a=i("a640"),o=i("1212"),r=i("9adc"),c=!r&&o>79&&o<83,l=c||!a("reduce");s({target:"Array",proto:!0,forced:l},{reduce:function(e){var t=arguments.length;return n(this,e,t,t>1?arguments[1]:void 0)}})},"15d3":function(e,t,i){"use strict";i("be5e")},"1b89":function(e,t,i){e.exports=i.p+"img/tog_17.5c8b5a5e.svg"},2372:function(e,t,i){e.exports=i.p+"img/tog_7.d065990e.svg"},"2a83":function(e,t,i){"use strict";i("c0f0")},"33a5":function(e){e.exports=JSON.parse('{"0":"江湖","1":"天策","2":"万花","3":"纯阳","4":"七秀","5":"少林","6":"藏剑","7":"丐帮","8":"明教","9":"五毒","10":"唐门","18":"苍云","19":"长歌","20":"霸刀","21":"蓬莱","22":"凌雪","23":"衍天","24":"药宗","26":"刀宗","29":"万灵","38":"段氏","39":"无相"}')},3822:function(e,t,i){e.exports=i.p+"img/tog_4.ae3c48b4.svg"},3835:function(e,t,i){"use strict";function s(e){if(Array.isArray(e))return e}i.d(t,"a",(function(){return r}));i("a4d3"),i("e01a"),i("d28b"),i("14d9"),i("d3b7"),i("3ca3"),i("ddb0");function n(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var s,n,a,o,r=[],c=!0,l=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(s=a.call(i)).done)&&(r.push(s.value),r.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=i["return"]&&(o=i["return"](),Object(o)!==o))return}finally{if(l)throw n}}return r}}var a=i("06c5");i("d9e2");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){return s(e)||n(e,t)||Object(a["a"])(e,t)||o()}},"3ba9":function(e,t,i){var s={"./Dark/comparison.svg":"c5bf","./Dark/count.svg":"ac83","./Dark/improvement.svg":"6886","./Dark/jia.svg":"7bad","./Dark/quan.svg":"d3fa","./Dark/right.svg":"fb970","./Dark/search.svg":"dfcb","./Dark/shaixuan.svg":"ea5b","./Dark/sum.svg":"7176","./Dark/tog_1.svg":"7a8e","./Dark/tog_10.svg":"852b","./Dark/tog_11.svg":"8029","./Dark/tog_12.svg":"984b","./Dark/tog_13.svg":"2cfb","./Dark/tog_15.svg":"9ca0","./Dark/tog_16.svg":"be26","./Dark/tog_17.svg":"0768","./Dark/tog_2.svg":"1aa3","./Dark/tog_3.svg":"bbdc","./Dark/tog_4.svg":"484b","./Dark/tog_40.svg":"fc87","./Dark/tog_41.svg":"27aa","./Dark/tog_5.svg":"d1be","./Dark/tog_6.svg":"2681","./Dark/tog_7.svg":"b4e8","./Dark/tog_8.svg":"d1e9","./Dark/tog_9.svg":"45e1","./Light/comparison.svg":"fb2b","./Light/count.svg":"8fe4","./Light/improvement.svg":"ac01","./Light/jia.svg":"e51b","./Light/quan.svg":"a8cd","./Light/right.svg":"5904","./Light/search.svg":"9bd5","./Light/shaixuan.svg":"a106","./Light/sum.svg":"f1ba","./Light/tog_1.svg":"680e","./Light/tog_10.svg":"88a5","./Light/tog_11.svg":"4828","./Light/tog_12.svg":"07cb","./Light/tog_13.svg":"f312","./Light/tog_15.svg":"0636","./Light/tog_16.svg":"d168","./Light/tog_17.svg":"1b89","./Light/tog_2.svg":"63ee","./Light/tog_3.svg":"8c41","./Light/tog_4.svg":"3822","./Light/tog_40.svg":"45f1","./Light/tog_41.svg":"0a8a","./Light/tog_5.svg":"a299","./Light/tog_6.svg":"9edd","./Light/tog_7.svg":"2372","./Light/tog_8.svg":"4ead","./Light/tog_9.svg":"0c74","./finish.svg":"11f9","./search_black.svg":"3a30","./unfinished.svg":"2b7a","./warning.svg":"5720"};function n(e){var t=a(e);return i(t)}function a(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=a,e.exports=n,n.id="3ba9"},"450f":function(e,t,i){var s={"./Dark/quan.svg":"d3fa","./Light/quan.svg":"a8cd"};function n(e){var t=a(e);return i(t)}function a(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=a,e.exports=n,n.id="450f"},"45f1":function(e,t,i){e.exports=i.p+"img/tog_40.8f4e8cc1.svg"},4828:function(e,t,i){e.exports=i.p+"img/tog_11.57cbcc0f.svg"},"4ead":function(e,t,i){e.exports=i.p+"img/tog_8.bc15415d.svg"},5720:function(e,t,i){e.exports=i.p+"img/warning.c59d3be8.svg"},5904:function(e,t,i){e.exports=i.p+"img/right.258873ca.svg"},"63ee":function(e,t,i){e.exports=i.p+"img/tog_2.6d3d6ed7.svg"},"680e":function(e,t,i){e.exports=i.p+"img/tog_1.93447118.svg"},6886:function(e,t,i){e.exports=i.p+"img/improvement.c17a031c.svg"},7176:function(e,t,i){e.exports=i.p+"img/sum.2d38a1fd.svg"},"7bad":function(e,t,i){e.exports=i.p+"img/jia.a4ed607e.svg"},"88a5":function(e,t,i){e.exports=i.p+"img/tog_10.4bea69ad.svg"},"8c41":function(e,t,i){e.exports=i.p+"img/tog_3.e4ec62c3.svg"},"8fe4":function(e,t,i){e.exports=i.p+"img/count.6033f8f4.svg"},"96c1":function(e,t,i){"use strict";i("049c")},"9edd":function(e,t,i){e.exports=i.p+"img/tog_6.19bcab65.svg"},a299:function(e,t,i){e.exports=i.p+"img/tog_5.b1775791.svg"},a8cd:function(e,t,i){e.exports=i.p+"img/quan.b9b6f7b4.svg"},ac01:function(e,t,i){e.exports=i.p+"img/improvement.5709fa8f.svg"},ac83:function(e,t,i){e.exports=i.p+"img/count.e9081d68.svg"},be5e:function(e,t,i){},c0f0:function(e,t,i){},c5bf:function(e,t,i){e.exports=i.p+"img/comparison.dfcc1cad.svg"},c740:function(e,t,i){"use strict";var s=i("23e7"),n=i("b727").findIndex,a=i("44d2"),o="findIndex",r=!0;o in[]&&Array(1)[o]((function(){r=!1})),s({target:"Array",proto:!0,forced:r},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},c967:function(e,t,i){"use strict";i.d(t,"i",(function(){return n})),i.d(t,"e",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return r})),i.d(t,"g",(function(){return c})),i.d(t,"a",(function(){return l})),i.d(t,"f",(function(){return u})),i.d(t,"k",(function(){return d})),i.d(t,"b",(function(){return v})),i.d(t,"h",(function(){return g})),i.d(t,"j",(function(){return f}));var s=i("41cb");function n(e){return Object(s["a"])().get("/api/cms/wiki/post/rank",{params:e})}function a(e,t){return Object(s["a"])().get("/api/cms/wiki/post/id/".concat(e),{params:t})}function o(e){return Object(s["a"])().get("/api/cms/user/kith/my")}function r(e){return Object(s["a"])().get("/api/cms/user/kith/game-roles/".concat(e))}function c(e){return Object(s["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema",{params:e})}function l(e){return Object(s["a"])().post("/api/cms/pvx/wiki_achievement_leap_schema",e)}function u(e){return Object(s["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function d(e,t){return Object(s["a"])().put("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e),t)}function v(e){return Object(s["a"])().delete("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function g(e){return Object(s["a"])().post("/api/cms/pvx/wiki_achievement_difficulty/list",e)}function f(e){return Object(s["a"])().post("/api/cms/qqbot/picture_task",e)}},d168:function(e,t,i){e.exports=i.p+"img/tog_16.7901e7f6.svg"},d3fa:function(e,t,i){e.exports=i.p+"img/quan.f7959a84.svg"},d58f:function(e,t,i){"use strict";var s=i("59ed"),n=i("7b0b"),a=i("44ad"),o=i("07fa"),r=TypeError,c="Reduce of empty array with no initial value",l=function(e){return function(t,i,l,u){var d=n(t),v=a(d),g=o(d);if(s(i),0===g&&l<2)throw new r(c);var f=e?g-1:0,h=e?-1:1;if(l<2)while(1){if(f in v){u=v[f],f+=h;break}if(f+=h,e?f<0:g<=f)throw new r(c)}for(;e?f>=0:g>f;f+=h)f in v&&(u=i(u,v[f],f,d));return u}};e.exports={left:l(!1),right:l(!0)}},e51b:function(e,t,i){e.exports=i.p+"img/jia.748a1596.svg"},f1ba:function(e,t,i){e.exports=i.p+"img/sum.a2f21be4.svg"},f312:function(e,t,i){e.exports=i.p+"img/tog_13.5711bcbb.svg"},fb2b:function(e,t,i){e.exports=i.p+"img/comparison.389bdb0c.svg"},fb970:function(e,t,i){e.exports=i.p+"img/right.b843a32f.svg"},fdd8:function(e,t,i){"use strict";i.r(t);i("b0c0"),i("4c53");var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"p-mini-leap"},[t("div",{ref:"infoTop",staticClass:"m-info-top"},[t("div",{staticClass:"m-avatar-list"},[e._m(0),e._l(e.compareRoles,(function(i,s){return t("div",{key:"role"+s,staticClass:"m-avatar-item",on:{click:function(t){return e.handleDeleteRole(i)}}},[t("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:i.mount,body_type:i.body_type}}),t("div",{staticClass:"m-avatar-info"},[t("div",{staticClass:"u-avatar-name"},[e._v(e._s(i.name))]),t("div",{staticClass:"u-avatar-server"},[e._v(e._s(i.server))])])],1)})),e._l(3-e.compareRoles.length,(function(s){return t("div",{key:"add"+s,staticClass:"m-avatar-item m-avatar-item--add",on:{click:function(t){return e.addFriendRole(s)}}},[t("img",{staticClass:"u-avatar-add-quan",attrs:{src:i("450f")("./".concat(e.isDark?"Dark":"Light","/quan.svg")),"svg-inline":""}}),t("img",{staticClass:"u-avatar-add-icon",attrs:{src:i("0731")("./".concat(e.isDark?"Dark":"Light","/jia.svg")),"svg-inline":""}})])}))],2),t("div",{staticClass:"m-progress-section m-progress-section--total"},[t("div",{staticClass:"u-progress-label"},[e._v("总进度")]),e._l(e.compareRoles,(function(i,s){return t("div",{key:s,staticClass:"m-progress-value"},[t("div",{staticClass:"u-value-text"},[e._v(e._s(i.totalProgress))]),t("div",{staticClass:"u-percent-symbol"},[e._v("%")])])}))],2),t("div",{staticClass:"m-progress-section m-progress-section--achievement"},[t("div",{staticClass:"u-progress-label"},[e._v("成就数")]),e._l(e.compareRoles,(function(i,s){return t("div",{key:s,staticClass:"m-progress-value"},[t("span",{staticClass:"u-value-text"},[e._v(e._s(i.totalOwnAchievements))])])}))],2),t("div",{staticClass:"m-progress-section m-progress-section--seniority"},[t("div",{staticClass:"u-progress-label"},[e._v("总资历")]),e._l(e.compareRoles,(function(i,s){return t("div",{key:s,staticClass:"m-progress-value"},[t("span",{staticClass:"u-value-text w"},[e._v(e._s(e.setNumber(i.totalOwnPoints,"w")))]),t("span",{staticClass:"u-value-text"},[e._v(e._s(e.setNumber(i.totalOwnPoints)))])])}))],2),t("Search",{on:{submit:e.handleSearchClick}})],1),t("div",{staticClass:"m-category-section",style:{height:e.categoryHeight+"px"}},e._l(e.list,(function(i,s){return t("div",{key:s,staticClass:"m-category-card",on:{click:function(t){return e.handleCategoryClick(i)}}},[t("div",{staticClass:"m-category-box"},[t("div",{staticClass:"u-category-icon"},[i.sub?t("img",{staticClass:"u-category-icon-img",attrs:{src:e.getIconPath(i.sub)}}):e._e()]),t("div",{staticClass:"u-category-title"},[e._v(e._s(i.name))])]),e._l(i.roleAchievements,(function(i,s){return t("div",{key:s,staticClass:"m-category-box"},[t("span",{staticClass:"u-value-text"},[e._v(e._s(i.progress))]),t("span",{staticClass:"u-percent-symbol"},[e._v("%")])])}))],2)})),0),t("AddFriend",{attrs:{visible:e.drawerVisible},on:{"update:visible":function(t){e.drawerVisible=t},confirmSelection:e.handleConfirmSelection}}),t("DeleteRole",{attrs:{visible:e.delDrawerVisible,role:e.deleteRoleInfo},on:{"update:visible":function(t){e.delDrawerVisible=t},deleteRole:e.handleDeleteRoleConfirm}}),t("CataloguePop",{attrs:{visible:e.drawerCatalogueVisible,category:e.currentCategory,compareRoles:e.compareRoles},on:{"update:visible":function(t){e.drawerCatalogueVisible=t},handleDetailClick:e.handleDetailClick}})],1)},n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-avatar-item"},[t("div",{staticClass:"u-avatar-placeholder"}),t("div",{staticClass:"m-avatar-info"},[t("div",{staticClass:"u-avatar-name"},[e._v("亲友对比")])])])}],a=i("5530"),o=i("c7eb"),r=i("1da1"),c=(i("99af"),i("7db0"),i("c740"),i("caad"),i("a15b"),i("d81d"),i("14d9"),i("13d5"),i("fb6a"),i("a434"),i("b680"),i("b64b"),i("d3b7"),i("25f0"),i("2532"),i("159b"),function(){var e=this,t=e._self._c;return t("el-drawer",{staticClass:"c-role-list-drawer",attrs:{title:e.title,visible:e.drawerVisible,direction:"btt",size:"420px"},on:{close:e.handleClose}},[t("div",{staticClass:"role-list-wrapper"},[t("div",{ref:"roleListContainer",staticClass:"role-list-container"},[1==e.currentStep?t("div",{staticClass:"role-items"},e._l(e.step1Options,(function(i,s){return t("div",{key:s,staticClass:"role-item",class:{selected:e.selectCurrentStep==i.value},on:{click:function(t){return e.selectRoleType(i)}}},[t("div",{staticClass:"u-img"},[t("div",{staticClass:"role-name"},[e._v(e._s(i.name))])]),t("div",{staticClass:"role-info",domProps:{innerHTML:e._s("<".concat(i.info,">"))}})])})),0):e._e(),2==e.currentStep||4==e.currentStep?t("div",{staticClass:"role-items"},e._l(e.roles,(function(i,s){return t("div",{key:s,staticClass:"role-item",class:{selected:e.selectedRole&&e.selectedRole.jx3id==i.jx3id},on:{click:function(t){return e.selectRole(i)}}},[t("div",{staticClass:"u-img"},[t("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:i.mount,body_type:i.body_type}}),t("div",{staticClass:"role-name"},[e._v(e._s(i.name))])],1),t("div",{staticClass:"role-info",domProps:{innerHTML:e._s("<".concat(i.server,">"))}})])})),0):e._e(),3==e.currentStep?t("div",{staticClass:"role-items"},e._l(e.friends,(function(i,s){var n;return t("div",{key:s,staticClass:"role-item",class:{selected:e.selectedFriend&&e.selectedFriend.kith_id==i.kith_id},on:{click:function(t){return e.selectFriend(i)}}},[t("div",{staticClass:"u-img"},[t("div",{staticClass:"role-name"},[e._v(e._s(null===(n=i.kith_info)||void 0===n?void 0:n.display_name))])]),t("div",{staticClass:"role-info",domProps:{innerHTML:e._s("<".concat("亲友UID"+i.kith_id,">"))}})])})),0):e._e()]),t("div",{staticClass:"role-button-group"},[t("div",{staticClass:"u-reset",on:{click:e.resetSelection}},[e._v("重置")]),t("div",{staticClass:"u-submit",on:{click:e.confirmSelection}},[e._v("确定")])]),e.showMask?t("div",{staticClass:"bottom-mask"}):e._e()])])}),l=[],u=i("c967"),d=i("85e4"),v=i("a01f"),g={name:"AddFriend",components:{RoleAvatar:v["a"]},props:{visible:{type:Boolean,default:!1}},computed:{drawerVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},title:function(){return 1==this.currentStep?"选择角色":2==this.currentStep?"我的角色":"亲友的角色"}},data:function(){return{currentStep:1,selectCurrentStep:1,step1Options:[{name:"我的角色",value:2,info:"从我的角色里面进行选择"},{name:"亲友的角色",value:3,info:"从亲友的角色里面进行选择"}],roles:[],friends:[],selectedFriend:null,friendRoles:[],selectedRole:null,showMask:!1}},watch:{drawerVisible:function(e){var t=this;this.currentStep=1,this.selectCurrentStep=1,this.selectedRole=null,e?this.$nextTick((function(){t.$refs.roleListContainer&&(t.$refs.roleListContainer.addEventListener("scroll",t.checkScrollPosition),t.checkScrollPosition())})):this.removeScrollListener()}},beforeDestroy:function(){this.removeScrollListener()},created:function(){},methods:{showSchoolIcon:d["s"],removeScrollListener:function(){this.$refs.roleListContainer&&this.$refs.roleListContainer.removeEventListener("scroll",this.checkScrollPosition)},selectRoleType:function(e){this.selectCurrentStep=e.value},getSelfRoles:function(){try{this.roles=JSON.parse(sessionStorage.getItem("wiki_my_roles"))||[]}catch(e){console.error("获取自己的角色列表失败:",e),this.roles=[]}},getMyFriends:function(){var e=this;Object(u["c"])().then((function(t){e.friends=t.data.data}))},selectFriend:function(e){this.selectedFriend=e},getSelectedFriendRole:function(){var e=this;Object(u["d"])(this.selectedFriend.kith_id).then((function(t){0!==t.data.data.length?(e.currentStep=2,e.roles=t.data.data):e.$message("该亲友暂无同步游戏角色")}))},selectRole:function(e){this.selectedRole=e},resetSelection:function(){this.selectedRole=this.currentRole},confirmSelection:function(){switch(this.currentStep){case 1:if(1===this.selectCurrentStep)return void this.$message("请先选择一个角色类型");2===this.selectCurrentStep?this.getSelfRoles():3===this.selectCurrentStep&&this.getMyFriends(),this.currentStep=this.selectCurrentStep;break;case 2:null!==this.selectedRole&&(this.$emit("confirmSelection",this.selectedRole),this.drawerVisible=!1);break;case 3:this.getSelectedFriendRole();break}},handleClose:function(){this.drawerVisible=!1},checkScrollPosition:function(){if(this.$refs.roleListContainer){var e=this.$refs.roleListContainer,t=e.scrollHeight,i=e.clientHeight,s=e.scrollTop,n=t-(i+s);this.showMask=n>40}}}},f=g,h=(i("15d3"),i("2877")),m=Object(h["a"])(f,c,l,!1,null,null,null),p=m.exports,b=function(){var e=this,t=e._self._c;return t("el-drawer",{staticClass:"c-role-delete-drawer",attrs:{visible:e.visible,direction:"btt",size:"auto"},on:{close:e.handleClose}},[e.role&&1==e.step?t("div",{staticClass:"m-delete-role_first"},[t("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:e.role.mount,body_type:e.role.body_type}}),t("div",{staticClass:"m-avatar-info"},[t("div",{staticClass:"u-avatar-name"},[e._v(e._s(e.role.name))]),t("div",{staticClass:"u-avatar-server"},[e._v(" "+e._s(e.xfName)+" · "+e._s(e.role.server)+" ")])]),t("div",{staticClass:"u-first-btn",on:{click:function(t){e.step=2}}},[e._v(" 删除角色 ")])],1):e._e(),2==e.step?t("div",{staticClass:"m-delete-role_second"},[t("img",{staticClass:"u-warning-icon",attrs:{width:"90",src:i("5720")}}),t("div",{staticClass:"u-tips"},[e._v("即将从对比中删除")]),t("div",{staticClass:"u-role-info"},[e._v(e._s(e.role.name)+"@"+e._s(e.role.server))]),t("div",{staticClass:"u-btns"},[t("div",{staticClass:"u-btn-item",on:{click:e.handleClose}},[e._v("取消")]),t("div",{staticClass:"u-btn-item",on:{click:e.handleDelete}},[e._v("确定")])])]):e._e()])},_=[],C=i("33a5"),k=i("65c2"),w={components:{RoleAvatar:v["a"]},props:{role:{type:Object,default:function(){}},visible:{type:Boolean,default:!1}},computed:{xfName:function(){return this.role.mount&&C[this.role.mount]||""},mpAvatar:function(){return this.role.mount?k["__cdn"]+"design/vector/school/".concat(this.role.mount,".svg"):null}},data:function(){return{step:1}},created:function(){},mounted:function(){},methods:{handleClose:function(){this.step=1,this.$emit("update:visible",!1)},handleDelete:function(){this.handleClose(),this.$emit("deleteRole",this.role)}}},y=w,x=(i("2a83"),Object(h["a"])(y,b,_,!1,null,null,null)),D=x.exports,R=i("fa1f"),j=i("0dee"),O=i("138d"),L=i("2ef0"),S=i("7720"),A={name:"Compare",components:{AddFriend:p,RoleAvatar:v["a"],DeleteRole:D,CataloguePop:R["a"],Search:j["a"]},data:function(){return{loading:!1,categoryHeight:0,drawerVisible:!1,roles:[],compareRoles:[],menuList:[],pointsData:{},compareAchievements:[],list:[],deleteRoleInfo:null,delDrawerVisible:!1,currentCategory:null,drawerCatalogueVisible:!1}},computed:{isDark:function(){var e=window.matchMedia("(prefers-color-scheme: dark)");return e.matches}},created:function(){document.title="亲友对比",this.init()},mounted:function(){this.categoryHeight=document.querySelector("body").offsetHeight-document.querySelector(".m-info-top").offsetHeight},methods:{init:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){var i,s,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(O["b"])(e.$store.state.client);case 3:return i=t.sent,e.menuList=i.menuList||[],e.pointsData=i.pointsList||[],t.next=8,Object(O["d"])();case 8:return e.roles=t.sent,s=e.$route.query.jx3id,s?(n=e.roles.find((function(e){return e.jx3id==s})),n&&e.compareRoles.push(n)):e.roles.length>0&&e.compareRoles.push(e.roles[0]),t.next=13,e.loadRoleAchievements(e.compareRoles[0].jx3id);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t)})))()},getIconPath:function(e){return i("3ba9")("./".concat(this.isDark?"Dark":"Light","/tog_").concat(e,".svg"))},setNumber:function(e,t){if(!e)return"";var i=e.toString();return"w"==t?i.length>4?i.slice(0,-4):"":i.length>4?i.slice(-4):i},addFriendRole:function(e){this.drawerVisible=!0},handleConfirmSelection:function(e){this.compareRoles.find((function(t){return t.jx3id==e.jx3id}))?this.$message({message:"已添加该角色",type:"warning"}):(this.compareRoles.push(e),this.loadRoleAchievements(e.jx3id),this.drawerVisible=!1)},handleDeleteRole:function(e){1!=this.compareRoles.length?(this.deleteRoleInfo=e,this.delDrawerVisible=!0):this.$message({message:"至少保留一个角色",type:"warning"})},handleDeleteRoleConfirm:function(){var e=this,t=this.compareRoles.findIndex((function(t){return t.jx3id==e.deleteRoleInfo.jx3id}));-1!=t&&(this.compareRoles.splice(t,1),this.list=this.list.map((function(e){return e.roleAchievements.splice(t,1),e}))),this.delDrawerVisible=!1},handleCategoryClick:function(e){this.currentCategory=e,this.drawerCatalogueVisible=!0},handleDetailClick:function(){this.drawerCatalogueVisible=!1;var e=[];this.compareRoles.forEach((function(t,i){e.push("".concat(t.jx3id,"|").concat(t.server,"|").concat(t.mount,"|").concat(t.body_type,"|").concat(t.name))})),Object(S["b"])(this.$router.resolve({name:"compare/catalogue",query:{roles:e.join(","),menuId:this.currentCategory.sub}}).href)},handleSearchClick:function(e){var t=[];this.compareRoles.forEach((function(e,i){t.push("".concat(e.jx3id,"|").concat(e.server,"|").concat(e.mount,"|").concat(e.body_type,"|").concat(e.name))}));var i=e.params||{};Object(S["b"])(this.$router.resolve({name:"compare/achievement",query:{source:1,roles:t.join(","),keyword:i.keyword||"",scene:i.scene||""}}).href)},loadRoleAchievements:function(e){var t=this;return Object(r["a"])(Object(o["a"])().mark((function i(){var s;return Object(o["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,Object(O["c"])(e);case 2:s=i.sent,t.compareAchievements=s.list,t.getRenderList(e);case 5:case"end":return i.stop()}}),i)})))()},getRenderList:function(e){var t=this,i=Object(L["cloneDeep"])(this.menuList),s=this.compareRoles.findIndex((function(t){return t.jx3id==e})),n=this.compareAchievements,o=Object.keys(i).map((function(t){var s=i[t],a=Object(O["a"])(s,n),o=[];return o.push({jx3id:e,allAchievements:a.allAchievements,ownAchievements:a.ownAchievements,ownPoints:a.ownPoints,progress:(a.ownPoints/a.allPoints*100).toFixed(2)}),{sub:s.sub,detail:s.detail,name:s.name,children:s.children,allPoints:a.allPoints,roleAchievements:o}}));this.list.length>0?this.list=Object(L["cloneDeep"])(this.list).map((function(e,t){return Object(a["a"])(Object(a["a"])({},e),{},{roleAchievements:e.roleAchievements.concat(o[t].roleAchievements)})})):this.list=o;var r=0;o.forEach((function(e){r+=e.roleAchievements[0].ownAchievements.length})),this.compareRoles[s].totalOwnAchievements=r,this.compareRoles[s].totalAllPoints=o.reduce((function(e,t){return e+t.allPoints}),0),this.compareRoles[s].totalOwnPoints=this.compareAchievements.reduce((function(e,i){return e+(t.pointsData[i]||0)}),0),this.compareRoles[s].totalProgress=(this.compareRoles[s].totalOwnPoints/this.compareRoles[s].totalAllPoints*100).toFixed(2)},getAllAchievementsData:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{allPoints:0,ownPoints:0},a=this.compareAchievements;return e.achievements.forEach((function(e){Array.isArray(e)?e.forEach((function(e){t.pointsData[e]&&(n.allPoints+=t.pointsData[e],i.push(e),a.includes(String(e))&&(n.ownPoints+=t.pointsData[e],s.push(e)))})):t.pointsData[e]&&(n.allPoints+=t.pointsData[e],i.push(e),a.includes(String(e))&&(n.ownPoints+=t.pointsData[e],s.push(e)))})),e.children&&e.children.forEach((function(e){t.getAllAchievementsData(e,i,s,n)})),{allAchievements:i,allPoints:n.allPoints,ownAchievements:s,ownPoints:n.ownPoints}}}},P=A,F=(i("96c1"),Object(h["a"])(P,s,n,!1,null,"d86c19bc",null));t["default"]=F.exports}}]);