(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44660f54"],{"0636":function(t,e,s){t.exports=s.p+"img/tog_15.1f7bb44b.svg"},"0768":function(t,e,s){t.exports=s.p+"img/tog_17.6d3efb0a.svg"},"07cb":function(t,e,s){t.exports=s.p+"img/tog_12.eb4b8e89.svg"},"0a8a":function(t,e,s){t.exports=s.p+"img/tog_41.e54c1e63.svg"},"0c74":function(t,e,s){t.exports=s.p+"img/tog_9.63ff7127.svg"},"13d5":function(t,e,s){"use strict";var i=s("23e7"),o=s("d58f").left,n=s("a640"),a=s("1212"),r=s("9adc"),c=!r&&a>79&&a<83,l=c||!n("reduce");i({target:"Array",proto:!0,forced:l},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},1450:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));var i=s("41cb"),o=function(){return Object(i["f"])().get("api/team/my-game-roles?nopage&custom=0")}},"1aa3":function(t,e,s){t.exports=s.p+"img/tog_2.8ae213ab.svg"},"1b89":function(t,e,s){t.exports=s.p+"img/tog_17.5c8b5a5e.svg"},2372:function(t,e,s){t.exports=s.p+"img/tog_7.d065990e.svg"},2681:function(t,e,s){t.exports=s.p+"img/tog_6.fd7052b7.svg"},"27aa":function(t,e,s){t.exports=s.p+"img/tog_41.867bbf38.svg"},"2cfb":function(t,e,s){t.exports=s.p+"img/tog_13.741ac369.svg"},"33a5":function(t){t.exports=JSON.parse('{"0":"江湖","1":"天策","2":"万花","3":"纯阳","4":"七秀","5":"少林","6":"藏剑","7":"丐帮","8":"明教","9":"五毒","10":"唐门","18":"苍云","19":"长歌","20":"霸刀","21":"蓬莱","22":"凌雪","23":"衍天","24":"药宗","26":"刀宗","29":"万灵","38":"段氏","39":"无相"}')},3822:function(t,e,s){t.exports=s.p+"img/tog_4.ae3c48b4.svg"},3835:function(t,e,s){"use strict";function i(t){if(Array.isArray(t))return t}s.d(e,"a",(function(){return r}));s("a4d3"),s("e01a"),s("d28b"),s("14d9"),s("d3b7"),s("3ca3"),s("ddb0");function o(t,e){var s=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=s){var i,o,n,a,r=[],c=!0,l=!1;try{if(n=(s=s.call(t)).next,0===e){if(Object(s)!==s)return;c=!1}else for(;!(c=(i=n.call(s)).done)&&(r.push(i.value),r.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=s["return"]&&(a=s["return"](),Object(a)!==a))return}finally{if(l)throw o}}return r}}var n=s("06c5");s("d9e2");function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){return i(t)||o(t,e)||Object(n["a"])(t,e)||a()}},"3ba9":function(t,e,s){var i={"./Dark/count.svg":"ac83","./Dark/shaixuan.svg":"ea5b","./Dark/sum.svg":"7176","./Dark/tog_1.svg":"7a8e","./Dark/tog_10.svg":"852b","./Dark/tog_11.svg":"8029","./Dark/tog_12.svg":"984b","./Dark/tog_13.svg":"2cfb","./Dark/tog_15.svg":"9ca0","./Dark/tog_16.svg":"be26","./Dark/tog_17.svg":"0768","./Dark/tog_2.svg":"1aa3","./Dark/tog_3.svg":"bbdc","./Dark/tog_4.svg":"484b","./Dark/tog_40.svg":"fc87","./Dark/tog_41.svg":"27aa","./Dark/tog_5.svg":"d1be","./Dark/tog_6.svg":"2681","./Dark/tog_7.svg":"b4e8","./Dark/tog_8.svg":"d1e9","./Dark/tog_9.svg":"45e1","./Light/count.svg":"8fe4","./Light/shaixuan.svg":"a106","./Light/sum.svg":"f1ba","./Light/tog_1.svg":"680e","./Light/tog_10.svg":"88a5","./Light/tog_11.svg":"4828","./Light/tog_12.svg":"07cb","./Light/tog_13.svg":"f312","./Light/tog_15.svg":"0636","./Light/tog_16.svg":"d168","./Light/tog_17.svg":"1b89","./Light/tog_2.svg":"63ee","./Light/tog_3.svg":"8c41","./Light/tog_4.svg":"3822","./Light/tog_40.svg":"45f1","./Light/tog_41.svg":"0a8a","./Light/tog_5.svg":"a299","./Light/tog_6.svg":"9edd","./Light/tog_7.svg":"2372","./Light/tog_8.svg":"4ead","./Light/tog_9.svg":"0c74"};function o(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}o.keys=function(){return Object.keys(i)},o.resolve=n,t.exports=o,o.id="3ba9"},"45e1":function(t,e,s){t.exports=s.p+"img/tog_9.b91da4f4.svg"},"45f1":function(t,e,s){t.exports=s.p+"img/tog_40.8f4e8cc1.svg"},"478d":function(t,e,s){},4828:function(t,e,s){t.exports=s.p+"img/tog_11.57cbcc0f.svg"},"484b":function(t,e,s){t.exports=s.p+"img/tog_4.cc4bee1c.svg"},"4ead":function(t,e,s){t.exports=s.p+"img/tog_8.bc15415d.svg"},"63ee":function(t,e,s){t.exports=s.p+"img/tog_2.6d3d6ed7.svg"},"680e":function(t,e,s){t.exports=s.p+"img/tog_1.93447118.svg"},"7a8e":function(t,e,s){t.exports=s.p+"img/tog_1.ee8ab329.svg"},8029:function(t,e,s){t.exports=s.p+"img/tog_11.fe0a7d76.svg"},"852b":function(t,e,s){t.exports=s.p+"img/tog_10.2f0ed734.svg"},"88a5":function(t,e,s){t.exports=s.p+"img/tog_10.4bea69ad.svg"},"8c41":function(t,e,s){t.exports=s.p+"img/tog_3.e4ec62c3.svg"},9473:function(t,e,s){},"984b":function(t,e,s){t.exports=s.p+"img/tog_12.f3a07dcf.svg"},"9a1b":function(t,e,s){"use strict";s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return n}));var i=s("41cb");function o(){return Object(i["a"])().get("/api/cms/user/my/info").then((function(t){return t.data.data}))}function n(t){return Object(i["a"])().post("/api/cms/system/common/reporter")}},"9ca0":function(t,e,s){t.exports=s.p+"img/tog_15.2b6a6cf7.svg"},"9edd":function(t,e,s){t.exports=s.p+"img/tog_6.19bcab65.svg"},a01f:function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;return e("img",{attrs:{src:t.showAvatar(t.mount,t.body_type)}})},o=[],n=s("01ea"),a={name:"roleAvatar",props:["mount","body_type"],components:{},data:function(){return{}},computed:{},methods:{showAvatar:function(t,e){return n["c"]+"design/avatar/xisai/"+t+"-"+e+".png"}},filters:{},created:function(){},mounted:function(){}},r=a,c=s("2877"),l=Object(c["a"])(r,i,o,!1,null,null,null);e["a"]=l.exports},a299:function(t,e,s){t.exports=s.p+"img/tog_5.b1775791.svg"},b4e8:function(t,e,s){t.exports=s.p+"img/tog_7.0dea2d20.svg"},bbdc:function(t,e,s){t.exports=s.p+"img/tog_3.a580ed01.svg"},bc1f:function(t,e,s){"use strict";s("478d")},be26:function(t,e,s){t.exports=s.p+"img/tog_16.ffa7d0d0.svg"},d168:function(t,e,s){t.exports=s.p+"img/tog_16.7901e7f6.svg"},d1be:function(t,e,s){t.exports=s.p+"img/tog_5.40c9a70c.svg"},d1e9:function(t,e,s){t.exports=s.p+"img/tog_8.df78604c.svg"},d58f:function(t,e,s){"use strict";var i=s("59ed"),o=s("7b0b"),n=s("44ad"),a=s("07fa"),r=TypeError,c="Reduce of empty array with no initial value",l=function(t){return function(e,s,l,u){var g=o(e),d=n(g),v=a(g);if(i(s),0===v&&l<2)throw new r(c);var f=t?v-1:0,h=t?-1:1;if(l<2)while(1){if(f in d){u=d[f],f+=h;break}if(f+=h,t?f<0:v<=f)throw new r(c)}for(;t?f>=0:v>f;f+=h)f in d&&(u=s(u,d[f],f,g));return u}};t.exports={left:l(!1),right:l(!0)}},e256:function(t,e,s){"use strict";s.r(e);s("b0c0"),s("4c53");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mini-program-overview"},[e("div",{staticClass:"user-info-section"},[e("div",{staticClass:"avatar-container"},[e("div",{staticClass:"avatar-bg"},[t.avatar_frame?e("img",{staticClass:"u-avatar-border",attrs:{src:t.avatar_frame,alt:"头像边框"}}):t._e(),e("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:t.currentRole.mount,body_type:t.currentRole.body_type}})],1)]),e("div",{staticClass:"user-name",on:{click:t.openRoleDrawer}},[t._v(t._s(t.currentRole.name))]),e("div",{staticClass:"user-detail"},[e("img",{staticClass:"hb-icon",attrs:{width:"30",height:"30",src:t.mpAvatar}}),e("span",[t._v(" "+t._s(t.xfName)+" ")]),e("span",[t._v(" "+t._s(t.currentRole.server)+" ")])])]),e("div",{staticClass:"total-progress"},[e("div",{staticClass:"progress-info"},[e("span",{staticClass:"progress-percentage"},[t._v(t._s(t.totalProgress)),e("span",[t._v("%")])]),e("span",{staticClass:"progress-value"},[t._v(" "+t._s(t.ownPointsCountW)),e("span",[t._v(t._s(t.ownPointsCountOther))])])]),e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-fill",style:{width:t.totalProgress+"%"}})])]),e("div",{staticClass:"progress-overview"},[t._m(0),e("div",{staticClass:"category-progress"},t._l(t.list,(function(i,o){return e("div",{key:o,staticClass:"progress-card",on:{click:function(e){return t.handleClick(i)}}},[e("div",{staticClass:"u-top-detailed"},[e("div",{staticClass:"u-name"},[t._v(t._s(i.name))]),e("div",{staticClass:"progress-bar-small"},[e("div",{staticClass:"progress-fill",style:{width:t.getCurrentProgress(i.ownPoints,i.allPoints)+"%"}})]),e("div",{staticClass:"progress-percentage-small"},[t._v(" "+t._s(t.getCurrentProgress(i.ownPoints,i.allPoints))+"% ")]),e("div",{staticClass:"u-info"},[e("div",{staticClass:"u-num"},[e("img",{attrs:{width:"14",height:"14",src:s("4eaf")("./".concat(t.isDark?"Dark":"Light","/count.svg")),alt:"成就logo"}}),t._v(" "+t._s(i.ownAchievements.length)+"/"+t._s(i.allAchievements.length)+" ")]),e("div",{staticClass:"u-num"},[e("img",{attrs:{width:"14",height:"14",src:s("e00d")("./".concat(t.isDark?"Dark":"Light","/sum.svg")),alt:"资历logo"}}),t._v(" "+t._s(i.ownPoints)+"/"+t._s(i.allPoints)+" ")])])]),e("div",{staticClass:"u-icon"},[e("img",{staticClass:"hb-icon",attrs:{src:t.getIconPath(i.sub),alt:"","svg-inline":""}})])])})),0)]),e("el-drawer",{staticClass:"c-mode-list-drawer",attrs:{title:"显示模式",visible:t.drawerModeVisible,direction:"btt",size:"280px"},on:{close:t.handleModeClose}},[e("div",{staticClass:"mode-list-container"},t._l(t.modeType,(function(s,i){return e("div",{key:i,staticClass:"mode-item",class:{selected:t.isSimpleModeSelect==s.value},on:{click:function(e){return t.toggleMode(s.value)}}},[e("div",{staticClass:"mode-name"},[t._v(t._s(s.name))]),e("div",{staticClass:"mode-detail"},[t._v(t._s(s.detail))])])})),0),e("div",{staticClass:"mode-button-group"},[e("el-button",{staticClass:"u-reset",on:{click:t.resetMode}},[t._v("重置")]),e("el-button",{staticClass:"u-submit",on:{click:t.confirmMode}},[t._v("确定")])],1)]),e("RoleListVue",{attrs:{visible:t.drawerVisible,roles:t.roleList,currentRole:t.currentRole},on:{"update:visible":function(e){t.drawerVisible=e},confirmSelection:t.handleConfirmSelection}})],1)},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-header"},[e("div",{staticClass:"section-title"},[t._v("进度概览")])])}],n=(s("99af"),s("7db0"),s("caad"),s("d81d"),s("14d9"),s("13d5"),s("fb6a"),s("e9c4"),s("b680"),s("b64b"),s("d3b7"),s("25f0"),s("2532"),s("159b"),s("c9d2")),a=s("85e4"),r=s("33a5"),c=s("262e"),l=s("1450"),u=s("9a1b"),g=s("01ea"),d=s("65c2"),v=s("a01f"),f=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"c-role-list-drawer",attrs:{title:"选择角色",visible:t.drawerVisible,direction:"btt",size:"420px"},on:{close:t.handleClose}},[e("div",{staticClass:"role-list-wrapper"},[e("div",{ref:"roleListContainer",staticClass:"role-list-container"},[e("div",{staticClass:"role-items"},t._l(t.roles,(function(s,i){return e("div",{key:i,staticClass:"role-item",class:{selected:t.selectedRole.jx3id==s.jx3id},on:{click:function(e){return t.selectRole(s)}}},[e("div",{staticClass:"u-img"},[e("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:s.mount,body_type:s.body_type}}),e("div",{staticClass:"role-name"},[t._v(t._s(s.name))])],1),e("div",{staticClass:"role-info",domProps:{innerHTML:t._s("<".concat(s.server,">"))}})])})),0)]),e("div",{staticClass:"role-button-group"},[e("el-button",{staticClass:"u-reset",on:{click:t.resetSelection}},[t._v("重置")]),e("el-button",{staticClass:"u-submit",on:{click:t.confirmSelection}},[t._v("确定")])],1),t.showMask?e("div",{staticClass:"bottom-mask"}):t._e()])])},h=[],m={name:"RoleList",components:{RoleAvatar:v["a"]},props:{visible:{type:Boolean,default:!1},roles:{type:Array,default:function(){return[]}},currentRole:{type:Object,default:function(){return{}}}},computed:{drawerVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{selectedRole:null,showMask:!1}},watch:{drawerVisible:function(t){var e=this;t?this.$nextTick((function(){e.$refs.roleListContainer&&(e.$refs.roleListContainer.addEventListener("scroll",e.checkScrollPosition),e.checkScrollPosition())})):this.removeScrollListener()},currentRole:{handler:function(t){t&&(this.selectedRole=t)},deep:!0,immediate:!0}},beforeDestroy:function(){this.removeScrollListener()},methods:{showSchoolIcon:a["s"],removeScrollListener:function(){this.$refs.roleListContainer&&this.$refs.roleListContainer.removeEventListener("scroll",this.checkScrollPosition)},selectRole:function(t){this.selectedRole=t},resetSelection:function(){this.selectedRole=this.currentRole},confirmSelection:function(){null!==this.selectedRole&&(this.$emit("confirmSelection",this.selectedRole),this.drawerVisible=!1)},handleClose:function(){this.drawerVisible=!1},checkScrollPosition:function(){if(this.$refs.roleListContainer){var t=this.$refs.roleListContainer,e=t.scrollHeight,s=t.clientHeight,i=t.scrollTop,o=e-(s+i);this.showMask=o>40}}}},p=m,b=(s("bc1f"),s("2877")),_=Object(b["a"])(p,f,h,!1,null,null,null),C=_.exports,w=s("7720"),k={name:"OverviewMiniProgram",components:{RoleAvatar:v["a"],RoleListVue:C},data:function(){return{userInfo:{},roleList:[],currentRole:{},drawerVisible:!1,isSimpleMode:!1,isSimpleModeSelect:!0,drawerModeVisible:!1,modeType:[{name:"简略模式",detail:"<只显示百分比进度>",value:!0},{name:"详细模式",detail:"<显示成就数和资历数>",value:!1}],achievementData:[],pointsData:{},list:[],allPointsCount:0,ownPointsCount:0,ownPointsCountW:null,ownPointsCountOther:0}},computed:{isDark:function(){var t=window.matchMedia("(prefers-color-scheme: dark)");return t.matches},avatar_frame:function(){if(this.userInfo){var t=this.userInfo.user_avatar_frame;if(t)return g["e"]+"avatar/images/".concat(t,"/").concat(t,".svg")}return null},totalProgress:function(){return this.ownPointsCount||this.allPointsCount?(this.ownPointsCount/this.allPointsCount*100).toFixed(2):0},xfName:function(){return this.currentRole.mount&&r[this.currentRole.mount]||""},mpAvatar:function(){return this.currentRole.mount?d["__cdn"]+"design/vector/school/".concat(this.currentRole.mount,".svg"):null}},watch:{currentRole:{deep:!0,immediate:!0,handler:function(t){if(t){console.log("juse",t);var e=t.jx3id;e&&(this.$store.commit("SET_STATE",{key:"achievementsVirtual",value:[]}),this.loadRoleAchievements(e))}}}},created:function(){document.title="资历宝典",this.getUserInfo()},methods:{showSchoolIcon:a["s"],handleClick:function(t){localStorage.setItem("category_data",JSON.stringify(t||{})),Object(w["b"])(this.$router.resolve({name:"catalogue",query:{}}).href)},getIconPath:function(t){return s("3ba9")("./".concat(this.isDark?"Dark":"Light","/tog_").concat(t,".svg"))},toggleMode:function(t){this.isSimpleModeSelect=t},handleModeClose:function(){this.drawerModeVisible=!1},resetMode:function(){this.isSimpleModeSelect=!0},confirmMode:function(){this.isSimpleMode=this.isSimpleModeSelect,this.drawerModeVisible=!1},getUserInfo:function(){var t=this;n["a"].isLogin()?Object(u["a"])().then((function(e){t.userInfo=e,t.getList()})):this.$confirm("请先登录再使用")},loadUserRoles:function(){var t=this;Object(l["a"])().then((function(e){var s,i;t.roleList=(null===(s=e.data)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.list)||[];var o=localStorage.getItem("wiki_last_sync");o&&"0"!==o?t.currentRole=t.roleList.find((function(t){return t.jx3id==o}))||"":t.roleList.length&&(t.currentRole=t.roleList[0],localStorage.setItem("wiki_last_sync",t.currentRole.jx3id||0),t.$store.commit("SET_STATE",{key:"role",value:t.currentRole}))}))},loadRoleAchievements:function(t){var e=this;Object(c["m"])(t).then((function(t){var s,i,o,n,a=(null===(s=t.data)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.achievements)||"",r=null===(o=t.data)||void 0===o||null===(n=o.data)||void 0===n?void 0:n.jx3id;e.isSync=!!r;var c=a.split(",");e.$store.commit("SET_STATE",{key:"achievements",value:c,isSession:!0}),localStorage.setItem("achievements",JSON.stringify(c||[])),e.getRenderList()}))},openRoleDrawer:function(){this.drawerVisible=!0},handleConfirmSelection:function(t){console.log(t),this.currentRole=t,this.drawerVisible=!1},getList:function(){var t=this;Object(c["i"])({general:1,client:this.$store.state.client}).then((function(e){var s=e.data.data.menus;t.achievementData=s,t.getPoints()}))},getPoints:function(){var t=this;Object(c["b"])().then((function(e){var s=e.data.data.points;t.pointsData=s,localStorage.setItem("points_data",JSON.stringify(s||{})),t.loadUserRoles()}))},getAllAchievementsData:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{allPoints:0,ownPoints:0},n=this.$store.state.achievements;return t.achievements.forEach((function(t){Array.isArray(t)?t.forEach((function(t){e.pointsData[t]&&(o.allPoints+=e.pointsData[t],s.push(t),n.includes(String(t))&&(o.ownPoints+=e.pointsData[t],i.push(t)))})):e.pointsData[t]&&(o.allPoints+=e.pointsData[t],s.push(t),n.includes(String(t))&&(o.ownPoints+=e.pointsData[t],i.push(t)))})),t.children&&t.children.forEach((function(t){e.getAllAchievementsData(t,s,i,o)})),{allAchievements:s,allPoints:o.allPoints,ownAchievements:i,ownPoints:o.ownPoints}},getRenderList:function(t){var e=this;t=t||this.achievementData;var s=Object.keys(t).map((function(s){var i=t[s],o=e.getAllAchievementsData(i);return{sub:i.sub,detail:i.detail,name:i.name,allAchievements:o.allAchievements,ownAchievements:o.ownAchievements,children:i.children,allPoints:o.allPoints,ownPoints:o.ownPoints}}));this.list=s,this.allPointsCount=s.reduce((function(t,e){return t+e.allPoints}),0);var i=this.$store.state.achievements;this.ownPointsCount=i.reduce((function(t,s){return t+(e.pointsData[s]||0)}),0);var o=this.ownPointsCount.toString();o.length>4?(this.ownPointsCountW=o.slice(0,-4),this.ownPointsCountOther=o.slice(-4)):(this.ownPointsCountW="",this.ownPointsCountOther=o)},getCurrentProgress:function(t,e){return(t/e*100).toFixed(2)}}},y=k,x=(s("f1b0"),Object(b["a"])(y,i,o,!1,null,null,null));e["default"]=x.exports},f1b0:function(t,e,s){"use strict";s("9473")},f312:function(t,e,s){t.exports=s.p+"img/tog_13.5711bcbb.svg"},fc87:function(t,e,s){t.exports=s.p+"img/tog_40.ef7c5acf.svg"}}]);