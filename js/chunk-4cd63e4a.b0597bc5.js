(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4cd63e4a"],{"0768":function(e,t,s){e.exports=s.p+"img/tog_17.6d3efb0a.svg"},"07ac":function(e,t,s){"use strict";var i=s("23e7"),a=s("6f53").values;i({target:"Object",stat:!0},{values:function(e){return a(e)}})},"0dee":function(e,t,s){"use strict";s("4c53");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"c-search-section"},[t("div",{staticClass:"u-search-box",on:{click:e.handleSearchClick}},[t("img",{staticClass:"u-search-icon",attrs:{src:s("46b2")("./".concat(e.isDark?"Dark":"Light","/search.svg"))}}),t("span",{staticClass:"u-search-text"},[e._v(e._s(e.placeholder||"搜索"))])]),e.showFilter?t("div",{staticClass:"u-filter-box",on:{click:function(t){return e.handleFilterClick()}}},[t("img",{staticClass:"u-search-icon",attrs:{src:s("5710")("./".concat(e.isDark?"Dark":"Light","/shaixuan.svg"))}}),t("span",{staticClass:"u-search-text"},[e._v("筛选")])]):e._e(),t("el-drawer",{staticClass:"p-search-drawer",attrs:{visible:e.drawerSearchVisible,direction:"btt",size:"420px"},on:{close:e.handleClose}},[t("template",{slot:"title"},[t("div",{staticClass:"u-search-title"},[e._v(e._s(e.title)),e.sub_title&&1!=e.step?t("span",[e._v("  - "+e._s(e.sub_title))]):e._e()])]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-list-wrapper"},[1==e.step?t("div",{staticClass:"search-step"},[t("div",{staticClass:"u-map-box"},[t("div",{staticClass:"search-step-content u-first-map",on:{click:function(t){return e.handleMapClick(null,1)}}},[e._v(" "+e._s(e.selectMapName||"请选择地图")+" ")]),t("div",{staticClass:"search-step-content u-two-map",style:{opacity:e.selectMapId?1:.5},on:{click:function(t){return e.handleMapClick(null,2)}}},[e._v(" "+e._s(e.selectSubName||"请选择地图")+" ")])]),t("div",{staticClass:"u-search-title"},[e._v("关键词")]),t("div",{staticClass:"search-step-content"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKeyword,expression:"searchKeyword"}],attrs:{type:"text",placeholder:"输入成就名称/成就描述/称号/奖励物品"},domProps:{value:e.searchKeyword},on:{input:function(t){t.target.composing||(e.searchKeyword=t.target.value)}}})]),t("div",{staticClass:"search-button-group"},[e.searchKeyword||e.selectMapId?t("div",{staticClass:"u-reset",on:{click:e.resetSelection}},[e._v("清空搜索项")]):e._e(),t("div",{staticClass:"u-submit",on:{click:function(t){return e.handleKeywordSearch()}}},[t("img",{staticClass:"u-search-icon",attrs:{src:s("3a30")}}),t("span",[e._v("搜索")])])])]):t("div",{staticClass:"search-step"},[t("div",{ref:"searchListContainer",staticClass:"search-list-container",class:{crosswise:2==e.step}},e._l(2==e.step?e.mapList:e.childrenList,(function(s){return t("div",{key:s.value,staticClass:"search-item",class:{selected:s.value==(2==e.step?e.selectMapId:e.selectSubId)},on:{click:function(t){return e.handleMapClick(s,3)}}},[t("div",{staticClass:"search-name"},[e._v(e._s(s.label))])])})),0),t("div",{staticClass:"search-button-group"},[t("div",{staticClass:"u-reset",on:{click:e.handleReset}},[e._v("重置")]),t("div",{staticClass:"u-submit",on:{click:e.handleSubmit}},[e._v("确定")])])]),e.showMask?t("div",{staticClass:"bottom-mask"}):e._e()])],2),t("el-drawer",{staticClass:"p-search-drawer",attrs:{visible:e.drawerFilterVisible,direction:"btt",size:"420px"},on:{close:e.handleCloseFilter}},[t("template",{slot:"title"},[t("div",{staticClass:"u-search-title"},[e._v("筛选")])]),t("div",{staticClass:"search-list-wrapper"},[t("div",{staticClass:"search-step"},[t("div",{ref:"filterListContainer",staticClass:"search-list-container"},e._l(e.filterOptions,(function(s){return t("div",{key:s.value,staticClass:"search-item",class:{selected:s.value==e.selectFilterId},on:{click:function(t){return e.handleFilterClick(s)}}},[t("div",{staticClass:"search-name"},[e._v(e._s(s.label)+" "),t("div",{staticClass:"search-sub"},[e._v(e._s(s.sub))])]),"已完成"===s.sub?t("div",{staticClass:"search-server"},[t("span",{domProps:{innerHTML:e._s("<隐藏掉[".concat(s.label,"]未完成的成就>"))}})]):"未完成"===s.sub?t("div",{staticClass:"search-server"},[t("span",{domProps:{innerHTML:e._s("<隐藏[".concat(s.label,"]已完成的成就>"))}})]):e._e()])})),0),t("div",{staticClass:"search-button-group"},[t("div",{staticClass:"u-reset",on:{click:e.handleFilterReset}},[e._v("重置")]),t("div",{staticClass:"u-submit",on:{click:e.handleFilterSubmit}},[e._v("确定")])])]),e.showFilterMask?t("div",{staticClass:"bottom-mask"}):e._e()])],2)],1)},a=[],n=(s("99af"),s("7db0"),s("14d9"),s("13d5"),s("b0c0"),s("a9e3"),s("d3b7"),s("07ac"),s("159b"),s("262e")),c=s("2ef0"),l={name:"CompareSearch",components:{},props:{showFilter:{type:Boolean,default:!1},roles:{type:Array,default:function(){return[]}}},computed:{isDark:function(){var e=window.matchMedia("(prefers-color-scheme: dark)");return e.matches}},watch:{step:function(e,t){var s=this;1!==e?this.$nextTick((function(){s.$refs.searchListContainer&&(s.$refs.searchListContainer.addEventListener("scroll",s.checkScrollPosition),s.checkScrollPosition())})):this.removeScrollListener()},drawerFilterVisible:function(e,t){var s=this;e?this.$nextTick((function(){s.$refs.filterListContainer&&(s.$refs.filterListContainer.addEventListener("scroll",s.checkScrollPosition),s.checkScrollPosition())})):this.removeScrollListener()},roles:function(e,t){e.length>0&&this.handleRoleFilter()}},beforeDestroy:function(){this.removeScrollListener()},data:function(){return{loading:!1,placeholder:"搜索",title:"地图",drawerSearchVisible:!1,showMask:!1,step:1,sub_title:null,searchKeyword:null,mapList:[],mapChildList:[],selectMapId:null,selectMapName:null,selectSubId:null,selectSubName:null,savedFilterOptions:{},filterOptions:[],selectFilterId:null,savedFilterId:null,drawerFilterVisible:!1,showFilterMask:!1}},created:function(){this.loadMapList()},mounted:function(){},methods:{removeScrollListener:function(){this.$refs.searchListContainer&&this.$refs.searchListContainer.removeEventListener("scroll",this.checkScrollPosition),this.$refs.filterListContainer&&this.$refs.filterListContainer.removeEventListener("scroll",this.checkFilterScrollPosition)},checkScrollPosition:function(){if(this.$refs.searchListContainer){var e=this.$refs.searchListContainer,t=e.scrollHeight,s=e.clientHeight,i=e.scrollTop,a=t-(s+i);this.showMask=a>40}if(this.$refs.filterListContainer){var n=this.$refs.filterListContainer,c=n.scrollHeight,l=n.clientHeight,r=n.scrollTop,o=c-(l+r);this.showFilterMask=o>40}},handleRoleFilter:function(){var e=[{label:"全部",value:null}];this.roles.forEach((function(t){e.push({label:t.name,server:t.server,sub:"已完成",value:t.jx3id+"_completed"}),e.push({label:t.name,server:t.server,sub:"未完成",value:t.jx3id+"_uncompleted"})})),this.filterOptions=e},handleFilterClick:function(e){e?this.selectFilterId=e.value:this.drawerFilterVisible=!0},handleCloseFilter:function(){this.selectFilterId=this.savedFilterId,this.drawerFilterVisible=!1},handleFilterReset:function(){this.selectFilterId=null},handleFilterSubmit:function(){var e=this,t=this.filterOptions.find((function(t){return t.value==e.selectFilterId}));this.$emit("filterSubmit",{filterId:this.selectFilterId,filterLabel:((null===t||void 0===t?void 0:t.label)||"")+((null===t||void 0===t?void 0:t.sub)||"")}),this.savedFilterId=Object(c["cloneDeep"])(this.selectFilterId),this.handleCloseFilter()},resetSelection:function(){this.searchKeyword=null,this.selectMapId=null,this.selectMapName=null,this.selectSubId=null,this.selectSubName=null,this.placeholder="搜索"},handleSearchClick:function(){this.step=1,this.drawerSearchVisible=!0},handleKeywordSearch:function(){this.getSearchAchievements()},handleClose:function(){this.searchKeyword=Object(c["cloneDeep"])(this.savedFilterOptions.searchKeyword),this.selectMapId=Object(c["cloneDeep"])(this.savedFilterOptions.selectMapId),this.selectMapName=Object(c["cloneDeep"])(this.savedFilterOptions.selectMapName),this.selectSubId=Object(c["cloneDeep"])(this.savedFilterOptions.selectSubId),this.selectSubName=Object(c["cloneDeep"])(this.savedFilterOptions.selectSubName),this.sub_title=Object(c["cloneDeep"])(this.savedFilterOptions.sub_title),this.childrenList=Object(c["cloneDeep"])(this.savedFilterOptions.childrenList),this.placeholder=Object(c["cloneDeep"])(this.savedFilterOptions.placeholder),this.drawerSearchVisible=!1},handleMapClick:function(e,t){return e||1!=t?!e&&2==t&&this.selectMapId?this.step=3:(2==this.step&&(this.selectMapId=e.value,this.sub_title=e.label,this.selectMapName=e.label,this.childrenList=e.children||[],this.childrenList.length>0&&(this.selectSubId=this.childrenList[0].value,this.selectSubName=this.childrenList[0].label)),void(3==this.step&&(this.selectSubId=e.value,this.selectSubName=e.label))):this.step=2},handleReset:function(){2==this.step&&(this.selectMapId=null,this.selectMapName=null,this.selectSubId=null,this.selectSubName=null,this.sub_title=null,this.childrenList=[]),3==this.step&&(this.selectSubId=this.childrenList[0].value,this.selectSubName=this.childrenList[0].label)},handleSubmit:function(){this.step=1},loadMapList:function(){var e=this,t=this.$store.state.client||"std",s={client:t,_no_page:1};Object(n["g"])(s).then((function(t){var s=t.data.data||[],i=Object.values(s.reduce((function(e,t){return t.RegionName?(e[t.RegionName]||(e[t.RegionName]={value:Number(t.Region),label:t.RegionName,children:[]}),e[t.RegionName].children.push({value:Number(t.ID),label:t.MapName,parent:Number(t.Region)}),e):e}),{}));e.mapList=i}))},getSearchAchievements:function(){var e=this,t={keyword:this.searchKeyword,scene:this.selectSubId,client:this.$store.state.client||"std",_no_page:1,limit:99999};this.loading=!0,Object(n["r"])(t).then((function(s){e.loading=!1;var i=s.data.data.achievements||[],a=[];i.forEach((function(e){a.push(e),e.SeriesAchievementList&&e.SeriesAchievementList.forEach((function(e,t){t>0&&a.push(e)}))})),e.$emit("submit",{data:a,params:t}),e.placeholder="".concat(e.selectMapName||"").concat(e.selectSubName?"/"+e.selectSubName:"").concat(e.searchKeyword?"/"+e.searchKeyword:""),e.drawerSearchVisible=!1,e.savedFilterOptions={searchKeyword:Object(c["cloneDeep"])(e.searchKeyword),selectMapId:Object(c["cloneDeep"])(e.selectMapId),selectMapName:Object(c["cloneDeep"])(e.selectMapName),selectSubId:Object(c["cloneDeep"])(e.selectSubId),selectSubName:Object(c["cloneDeep"])(e.selectSubName),sub_title:Object(c["cloneDeep"])(e.sub_title),childrenList:Object(c["cloneDeep"])(e.childrenList),placeholder:Object(c["cloneDeep"])(e.placeholder)}})).finally((function(){e.loading=!1}))},handleOtherSearch:function(e){this.searchKeyword=e.keyword||"",this.selectSubId=e.scene||"",this.getSearchAchievements()}}},r=l,o=(s("6de2"),s("2877")),u=Object(o["a"])(r,i,a,!1,null,null,null);t["a"]=u.exports},"11f9":function(e,t,s){e.exports=s.p+"img/finish.c82022e3.svg"},"1aa3":function(e,t,s){e.exports=s.p+"img/tog_2.8ae213ab.svg"},2681:function(e,t,s){e.exports=s.p+"img/tog_6.fd7052b7.svg"},"27aa":function(e,t,s){e.exports=s.p+"img/tog_41.867bbf38.svg"},"2b7a":function(e,t,s){e.exports=s.p+"img/unfinished.e9a234a5.svg"},"2cfb":function(e,t,s){e.exports=s.p+"img/tog_13.741ac369.svg"},"3a30":function(e,t,s){e.exports=s.p+"img/search_black.8d2ab45b.svg"},"45e1":function(e,t,s){e.exports=s.p+"img/tog_9.b91da4f4.svg"},"46b2":function(e,t,s){var i={"./Dark/search.svg":"dfcb","./Light/search.svg":"9bd5"};function a(e){var t=n(e);return s(t)}function n(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=n,e.exports=a,a.id="46b2"},"484b":function(e,t,s){e.exports=s.p+"img/tog_4.cc4bee1c.svg"},5710:function(e,t,s){var i={"./Dark/shaixuan.svg":"ea5b","./Light/shaixuan.svg":"a106"};function a(e){var t=n(e);return s(t)}function n(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=n,e.exports=a,a.id="5710"},"6de2":function(e,t,s){"use strict";s("fd83")},"6f53":function(e,t,s){"use strict";var i=s("83ab"),a=s("d039"),n=s("e330"),c=s("e163"),l=s("df75"),r=s("fc6a"),o=s("d1e7").f,u=n(o),d=n([].push),h=i&&a((function(){var e=Object.create(null);return e[2]=2,!u(e,2)})),v=function(e){return function(t){var s,a=r(t),n=l(a),o=h&&null===c(a),v=n.length,p=0,f=[];while(v>p)s=n[p++],i&&!(o?s in a:u(a,s))||d(f,e?[s,a[s]]:a[s]);return f}};e.exports={entries:v(!0),values:v(!1)}},"7a8e":function(e,t,s){e.exports=s.p+"img/tog_1.ee8ab329.svg"},8029:function(e,t,s){e.exports=s.p+"img/tog_11.fe0a7d76.svg"},"852b":function(e,t,s){e.exports=s.p+"img/tog_10.2f0ed734.svg"},"8f5e":function(e,t,s){"use strict";s("9e9b")},"984b":function(e,t,s){e.exports=s.p+"img/tog_12.f3a07dcf.svg"},"9bd5":function(e,t,s){e.exports=s.p+"img/search.781ce470.svg"},"9ca0":function(e,t,s){e.exports=s.p+"img/tog_15.2b6a6cf7.svg"},"9e9b":function(e,t,s){},a01f:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("img",{attrs:{src:e.showAvatar(e.mount,e.body_type)}})},a=[],n=s("01ea"),c={name:"roleAvatar",props:["mount","body_type"],components:{},data:function(){return{}},computed:{},methods:{showAvatar:function(e,t){return n["c"]+"design/avatar/xisai/"+e+"-"+t+".png"}},filters:{},created:function(){},mounted:function(){}},l=c,r=s("2877"),o=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=o.exports},b4e8:function(e,t,s){e.exports=s.p+"img/tog_7.0dea2d20.svg"},bbdc:function(e,t,s){e.exports=s.p+"img/tog_3.a580ed01.svg"},be26:function(e,t,s){e.exports=s.p+"img/tog_16.ffa7d0d0.svg"},d1be:function(e,t,s){e.exports=s.p+"img/tog_5.40c9a70c.svg"},d1e9:function(e,t,s){e.exports=s.p+"img/tog_8.df78604c.svg"},da83:function(e,t,s){var i={"./tog_1.svg":"7a8e","./tog_10.svg":"852b","./tog_11.svg":"8029","./tog_12.svg":"984b","./tog_13.svg":"2cfb","./tog_15.svg":"9ca0","./tog_16.svg":"be26","./tog_17.svg":"0768","./tog_2.svg":"1aa3","./tog_3.svg":"bbdc","./tog_4.svg":"484b","./tog_40.svg":"fc87","./tog_41.svg":"27aa","./tog_5.svg":"d1be","./tog_6.svg":"2681","./tog_7.svg":"b4e8","./tog_8.svg":"d1e9","./tog_9.svg":"45e1"};function a(e){var t=n(e);return s(t)}function n(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=n,e.exports=a,a.id="da83"},dfcb:function(e,t,s){e.exports=s.p+"img/search.4918b175.svg"},fa1f:function(e,t,s){"use strict";s("b0c0"),s("4c53");var i=function(){var e=this,t=e._self._c;return t("el-drawer",{staticClass:"c-catalogue-pop",attrs:{visible:e.visible,direction:"btt",size:"auto"},on:{close:e.handleClose},scopedSlots:e._u([{key:"title",fn:function(){return[e.visible?t("div",{staticClass:"u-category-title"},[t("img",{staticClass:"u-category-icon-img",attrs:{src:e.getIconPath(e.category.sub)}}),t("span",{staticClass:"u-category-name"},[e._v(e._s(e.category.name))])]):e._e()]},proxy:!0}])},[e.visible?t("div",{ref:"infoTop",staticClass:"m-info-top"},[t("div",{staticClass:"m-avatar-list"},[t("div",{staticClass:"m-avatar-item"},[t("div",{staticClass:"u-avatar-placeholder"}),t("div",{staticClass:"m-avatar-info"})]),e._l(e.compareRoles,(function(s){return t("div",{key:s.jx3id,staticClass:"m-avatar-item"},[t("RoleAvatar",{staticClass:"u-avatar-img",attrs:{mount:s.mount,body_type:s.body_type}}),t("div",{staticClass:"m-avatar-info"},[t("div",{staticClass:"u-avatar-name"},[e._v(e._s(s.name))]),t("div",{staticClass:"u-avatar-server"},[e._v(e._s(s.server))])])],1)})),e._l(3-e.compareRoles.length,(function(e){return t("div",{key:e,staticClass:"m-avatar-item m-avatar-item--add"})}))],2),t("div",{staticClass:"m-progress-section m-progress-section--total"},[t("div",{staticClass:"u-progress-label"},[e._v("总进度")]),e._l(e.category.roleAchievements||[],(function(s,i){return t("div",{key:i,staticClass:"m-progress-value"},[t("div",{staticClass:"u-value-text"},[e._v(e._s(s.progress))]),t("div",{staticClass:"u-percent-symbol"},[e._v("%")])])}))],2),t("div",{staticClass:"m-progress-section m-progress-section--achievement"},[t("div",{staticClass:"u-progress-label"},[e._v("成就数")]),e._l(e.category.roleAchievements||[],(function(s,i){var a;return t("div",{key:i,staticClass:"m-progress-value"},[t("span",{staticClass:"u-value-text"},[e._v(e._s((null===s||void 0===s||null===(a=s.ownAchievements)||void 0===a?void 0:a.length)||s.achievementCount||0))])])}))],2),t("div",{staticClass:"m-progress-section m-progress-section--seniority"},[t("div",{staticClass:"u-progress-label"},[e._v("总资历")]),e._l(e.category.roleAchievements||[],(function(s,i){return t("div",{key:i,staticClass:"m-progress-value"},[t("span",{staticClass:"u-value-text w"},[e._v(e._s(e.setNumber(s.ownPoints,"w")))]),t("span",{staticClass:"u-value-text"},[e._v(e._s(e.setNumber(s.ownPoints)))])])}))],2),e.showDetailBtn?t("div",{staticClass:"u-btn",on:{click:e.handleDetailClick}},[e._v(" 查看详情 ")]):e._e()]):e._e()])},a=[],n=(s("fb6a"),s("d3b7"),s("25f0"),s("a01f")),c={components:{RoleAvatar:n["a"]},props:{category:{type:Object,default:function(){}},compareRoles:{type:Array,default:function(){}},visible:{type:Boolean,default:!1},showDetailBtn:{type:Boolean,default:!0}},computed:{isDark:function(){var e=window.matchMedia("(prefers-color-scheme: dark)");return e.matches}},data:function(){return{title:"",list:[]}},created:function(){},mounted:function(){},methods:{handleClose:function(){this.$emit("update:visible",!1)},getIconPath:function(e){return e?s("da83")("./tog_".concat(e,".svg")):""},setNumber:function(e,t){if(!e)return"";var s=e.toString();return"w"==t?s.length>4?s.slice(0,-4):"":s.length>4?s.slice(-4):s},handleDetailClick:function(){this.$emit("handleDetailClick")}}},l=c,r=(s("8f5e"),s("2877")),o=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=o.exports},fc87:function(e,t,s){e.exports=s.p+"img/tog_40.ef7c5acf.svg"},fd83:function(e,t,s){}}]);