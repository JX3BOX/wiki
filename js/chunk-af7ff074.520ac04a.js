(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-af7ff074"],{"07ac":function(e,t,i){"use strict";var n=i("23e7"),a=i("6f53").values;n({target:"Object",stat:!0},{values:function(e){return a(e)}})},"13d5":function(e,t,i){"use strict";var n=i("23e7"),a=i("d58f").left,s=i("a640"),c=i("1212"),o=i("9adc"),l=!o&&c>79&&c<83,r=l||!s("reduce");n({target:"Array",proto:!0,forced:r},{reduce:function(e){var t=arguments.length;return a(this,e,t,t>1?arguments[1]:void 0)}})},1450:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("41cb"),a=function(){return Object(n["f"])().get("api/team/my-game-roles?nopage&custom=0")}},2788:function(e,t,i){},3908:function(e,t,i){"use strict";i("d38c")},"3d43":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-compare-main"},[e.mobile?t("mobile"):t("pc")],1)},a=[],s=(i("caad"),i("d3b7"),i("2532"),i("b0c0"),i("4c53"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-compare"},[t("div",{staticClass:"u-title"},[t("div",{staticClass:"u-label"},[e._v("亲友对比")]),t("div",{staticClass:"u-tip"},[t("el-input",{staticClass:"u-search-input",attrs:{placeholder:"输入成就名称/成就描述/称号/奖励物品「回车」进行搜索"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandle.apply(null,arguments)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[e._t("default",(function(){return[t("el-cascader",{staticClass:"u-cascader",attrs:{options:e.mapList,"show-all-levels":!1,clearable:""},on:{change:e.searchHandle},model:{value:e.searchMap,callback:function(t){e.searchMap=t},expression:"searchMap"}})]}))]},proxy:!0}],null,!0),model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}},[t("el-button",{staticClass:"u-btn",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchHandle},slot:"append"})],1)],1),t("div",{staticClass:"u-radio"},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":"",clearable:""},on:{change:e.selectTabChange},model:{value:e.selectTab,callback:function(t){e.selectTab=t},expression:"selectTab"}},e._l(e.selectOptions,(function(i){return t("el-option",{key:i.type,attrs:{label:i.name,value:i.type,disabled:e.isSelectDisabled(i.type)}})})),1)],1)]),t("div",{staticClass:"m-main"},[t("div",{staticClass:"u-left"},e._l(e.menuList,(function(i,n){return t("ul",{key:n,staticClass:"u-zl-item",class:{active:i.sub==e.activeIndex,show:i.sub==e.activeIndex&&!e.activeShow},on:{click:function(t){return e.setActiveIndex(i.sub)}}},[t("div",{staticClass:"u-zl-item_title"},[e._v(" "+e._s(i.name)+" "),t("i",{class:i.sub==e.activeIndex&&e.activeShow?"el-icon-caret-top":"el-icon-caret-bottom",on:{click:function(t){return t.stopPropagation(),e.setActiveShow(i.sub)}}})]),e._l(i.children,(function(n,a){return t("li",{key:a,staticClass:"u-zl-item_children",class:{active:n.detail==e.activeIndexChildren},on:{click:function(t){return t.stopPropagation(),e.setActiveIndex(i.sub,n.detail)}}},[e._v(" "+e._s(n.name)+" ")])}))],2)})),0),t("div",{staticClass:"u-right"},[t("div",{staticClass:"u-zl-box"},[t("div",{staticClass:"u-zl_table",style:"width:"+200*(e.contrastKith.length+1)+"px"},[t("div",{staticClass:"u-table_label ps"},[e._v("成就名称")]),e._l(e.contrastKith,(function(i,n){return t("div",{key:n,staticClass:"u-table_label kith"},[t("div",{staticClass:"u-name",attrs:{title:i.name+"·"+i.server}},[e._v(" "+e._s(i.name)+"·"+e._s(i.server)+" ")]),t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.delRole(i,n)}}})])}))],2),t("div",{staticClass:"u-zl-number_table",style:"width:"+200*(e.contrastKith.length+1)+"px"},[t("div",{staticClass:"u-table_label ps"},[e._v("总资历")]),e._l(e.contrastKith,(function(i,n){return t("div",{key:n,staticClass:"u-table_label kith"},[t("div",{staticClass:"u-name",attrs:{title:i.name+"·"+i.server+"总资历："+i.number}},[e._v(" "+e._s(i.number)+" ")])])}))],2),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.achievementsLoading,expression:"achievementsLoading"}],staticClass:"u-zl_cell",style:"width:"+200*(e.contrastKith.length+1)+"px"},[t("div",{staticClass:"u-zl-list ps"},e._l(e.achievements,(function(i,n){return t("div",{key:n,staticClass:"u-zl-list_item"},[t("el-tooltip",{attrs:{effect:"dark",content:i.Desc,placement:"top"}},[t("a",{attrs:{href:e.get_link(i.ID),target:"_blank"}},[t("div",{staticClass:"u-zl-list_item_box"},[t("img",{staticClass:"u-icon",attrs:{src:e.icon_url(null===i||void 0===i?void 0:i.IconID)}}),t("span",{staticClass:"u-name"},[e._v(e._s(null===i||void 0===i?void 0:i.Name))])])])])],1)})),0),e._l(e.contrastKith,(function(i,n){return t("div",{key:n,staticClass:"u-zl-list"},e._l(i.achievements,(function(e,i){return t("div",{key:i,staticClass:"u-zl-list_item kith"},[t("div",{staticClass:"u-self-checked",class:{finish:"-1"!=e.value}},[t("i",{staticClass:"el-icon-check"})])])})),0)}))],2)]),t("div",{staticClass:"u-zl-add_item",on:{click:e.addRole}},[t("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"}),t("div",[e._v("添加角色")])])])]),t("el-dialog",{attrs:{title:"添加角色",visible:e.showAddRole,width:"420px",draggable:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.showAddRole=t}}},[t("el-form",{ref:"roleRef",attrs:{model:e.kithForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"角色类型",prop:"roleType"}},[t("el-radio-group",{on:{input:function(t){e.kithForm.userId="",e.kithForm.jx3Id=[]}},model:{value:e.kithForm.roleType,callback:function(t){e.$set(e.kithForm,"roleType",t)},expression:"kithForm.roleType"}},[t("el-radio",{attrs:{label:"1"}},[e._v("自身")]),t("el-radio",{attrs:{label:"2"}},[e._v("亲友")])],1)],1),2==e.kithForm.roleType?t("el-form-item",{attrs:{label:"我的亲友",prop:"uid"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getKithRolesList},model:{value:e.kithForm.uid,callback:function(t){e.$set(e.kithForm,"uid",t)},expression:"kithForm.uid"}},e._l(e.myKith,(function(e,i){var n;return t("el-option",{key:i,attrs:{label:(null===e||void 0===e||null===(n=e.kith_info)||void 0===n?void 0:n.display_name)||"-",value:e.kith_id}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"对应角色",prop:"jx3Id"}},[t("el-select",{attrs:{placeholder:"请选择对应角色",multiple:""},on:{change:e.setRoleInfo},model:{value:e.kithForm.jx3Id,callback:function(t){e.$set(e.kithForm,"jx3Id",t)},expression:"kithForm.jx3Id"}},e._l(1==e.kithForm.roleType?e.roleList:e.myKithRoles,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.jx3id}})})),1)],1)],1),t("div",{staticClass:"u-tips"},[t("div",[t("i",{staticClass:"el-icon-info"}),e._v(" 提示")]),e._v(" 1. 添加亲友角色后，可对比亲友角色与自身角色的成就进度。"),t("br"),e._v(" 2. 去"),t("a",{attrs:{href:"https://www.jx3box.com/dashboard/privacy?tab=whitelist",target:"_blank"}},[e._v("添加亲友")])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showAddRole=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addRoleConfirm}},[e._v("确 定")])],1)],1)],1)}),c=[],o=i("53ca"),l=i("5530"),r=(i("4de4"),i("7db0"),i("d81d"),i("14d9"),i("13d5"),i("a434"),i("e9f5"),i("910d"),i("f665"),i("7d54"),i("ab43"),i("9485"),i("a9e3"),i("07ac"),i("25f0"),i("159b"),i("262e")),u=i("c967"),h=i("85e4"),d=i("c9d2"),v=i("1450"),f=i("2ef0"),m={components:{},data:function(){return{currentRole:{},menuList:[],selectTab:[],selectOptions:[{name:"共同未完成的",value:1,type:"1,1"}],activeIndex:1,activeShow:!0,activeIndexChildren:null,achievements:[],achievements_bak:[],achievementsLoading:!1,showAddRole:!1,myKith:[],myKithRoles:[],roleList:[],kithForm:{uid:"",jx3Id:[]},rules:{roleType:{required:!0,message:"请选择类型",trigger:"change"},uid:{required:!0,message:"请选择亲友",trigger:"change"},jx3Id:{required:!0,message:"请选择角色",trigger:"change"}},contrastKith:[],contrastKith_bak:[],pointsData:[],searchKeyword:"",searchMap:"",mapList:[]}},created:function(){this.loadUserRoles(),this.loadMapList()},mounted:function(){},methods:{get_link:function(e){return Object(h["f"])("achievement",e)},icon_url:function(e){return Object(h["l"])(e)},setActiveShow:function(e){this.activeIndex!=e?this.setActiveIndex(e):this.activeShow=!this.activeShow},setActiveIndex:function(e,t){this.achievementsLoading||(this.activeIndex==e||t||(this.activeShow=!0),this.activeIndex=e,this.activeIndexChildren=t||null,this.getMenuAchievements(e,t))},loadMapList:function(){var e=this,t=this.$store.state.client,i={client:t,_no_page:1};Object(r["g"])(i).then((function(t){var i=t.data.data||[],n=Object.values(i.reduce((function(e,t){return t.RegionName?(e[t.RegionName]||(e[t.RegionName]={value:Number(t.Region),label:t.RegionName,children:[]}),e[t.RegionName].children.push({value:Number(t.ID),label:t.MapName,parent:Number(t.Region)}),e):e}),{}));e.mapList=n}))},searchHandle:function(){this.activeIndex=null,this.activeIndexChildren=null,this.getSearchAchievements()},getSearchAchievements:function(){var e=this;this.achievementsLoading=!0;var t={keyword:this.searchKeyword,scene:this.searchMap[1],client:this.$store.state.client,_no_page:1,limit:99999};Object(r["r"])(t).then((function(t){var i=t.data.data.achievements||[],n=[];i.forEach((function(e){n.push(e),e.SeriesAchievementList&&e.SeriesAchievementList.forEach((function(e,t){t>0&&n.push(e)}))})),e.achievements=n,e.achievements_bak=Object(f["cloneDeep"])(e.achievements),e.queryFinish(),e.selectTabChange()})).finally((function(){e.achievementsLoading=!1}))},getPoints:function(){var e=this;return Object(r["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.getList()}))},getList:function(){var e=this;Object(r["i"])({general:1,client:this.$store.state.client}).then((function(t){var i=t.data.data.menus;e.menuList=i,e.getMenuAchievements(1,"",1)}))},getMenuAchievements:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.achievementsLoading=!0,Object(r["h"])(t,i).then((function(t){var i,a=t.data.data.achievements||[],s=[];(a.forEach((function(e){s.push(e),e.SeriesAchievementList&&e.SeriesAchievementList.forEach((function(e,t){t>0&&s.push(e)}))})),e.achievements=s,e.achievements_bak=Object(f["cloneDeep"])(e.achievements),1!=n)?(e.queryFinish(),e.selectTabChange()):null!==(i=e.currentRole)&&void 0!==i&&i.jx3id&&e.addRoleConfirm(e.currentRole.jx3id,1)})).finally((function(){e.achievementsLoading=!1}))},addRole:function(){var e=this;this.kithForm={roleType:"1",userId:"",jx3Id:""},this.showAddRole=!0,this.$nextTick((function(){e.$refs.roleRef.clearValidate()}))},getMyKith:function(){var e=this;Object(u["c"])().then((function(t){e.myKith=t.data.data}))},loadUserRoles:function(){var e=this;d["a"].isLogin()?Object(v["a"])().then((function(t){var i,n,a,s;e.roleList=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[],e.currentRole=(null===(a=t.data)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.list[0])||{},e.getPoints(),e.getMyKith()})):this.$confirm("请先登录").then((function(e){d["a"].toLogin(window.location.href)}))},getKithRolesList:function(){var e=this;Object(u["d"])(this.kithForm.uid).then((function(t){e.myKithRoles=t.data.data,e.kithForm.jx3Id=""}))},delRole:function(e,t){this.contrastKith.splice(t,1),this.selectTab=[];var i=[],n=Object(f["cloneDeep"])(this.selectOptions);n.forEach((function(t,n){t.value!==e.jx3id&&i.push(t)})),this.selectOptions=i,this.selectTabChange(!0)},setRoleInfo:function(e){var t=this;e.map((function(e,i){if(1==t.kithForm.roleType){var n=t.roleList.find((function(t){return t.jx3id==e}));t.kithForm.info[i]=n}else{var a=t.myKithRoles.find((function(t){return t.jx3id==e}));t.kithForm.info[i]=a}}))},addRoleConfirm:function(e,t){var i=this;1==t?this.addRoleAndInfo(e,t):this.kithForm.jx3Id.forEach((function(e){var n=null;n=1==i.kithForm.roleType?i.roleList.find((function(t){return t.jx3id==e})):i.myKithRoles.find((function(t){return t.jx3id==e}));var a=!1;i.contrastKith.forEach((function(t){t.jx3id!=e||(a=!0)})),!a&&i.addRoleAndInfo(e,t,n)})),this.showAddRole=!1},addRoleAndInfo:function(e,t,i){var n=this;Object(r["m"])(e).then((function(e){var a,s,c=((null===(a=e.data)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.achievements)||"").split(","),o={},r=0;c.forEach((function(e){r+=n.pointsData[e]||0})),o=t?Object(l["a"])(Object(l["a"])({},n.currentRole),{},{my_achievements:c,achievements:[],number:r}):Object(l["a"])(Object(l["a"])({},i),{},{my_achievements:c,achievements:[],number:r}),n.selectOptions.push({value:o.jx3id,name:o.name+"未完成",type:"".concat(o.jx3id,",1")}),n.selectOptions.push({value:o.jx3id,name:o.name+"已完成",type:"".concat(o.jx3id,",2")}),1==t&&n.contrastKith[0]?n.$set(n.contrastKith,0,o):n.contrastKith.push(o),n.achievements=Object(f["cloneDeep"])(n.achievements_bak),n.queryFinish(),n.selectTabChange()}))},queryFinish:function(e){var t=this,i=this.contrastKith,n=this.achievements;i.forEach((function(e,i){t.contrastKith[i].achievements=[],n.forEach((function(n,a){e.my_achievements.includes(n.ID.toString())?t.contrastKith[i].achievements.push({key:a,value:n.ID.toString()}):t.contrastKith[i].achievements.push({key:a,value:"-1"})}))})),e||(this.contrastKith_bak=Object(f["cloneDeep"])(this.contrastKith))},getIntersectionByKey:function(e,t){if(0===e.length)return[];var i=e.map((function(e){return e.map((function(e){return e[t]}))}));return i.reduce((function(e,t){return e.filter((function(e){return t.includes(e)}))}))},isSelectDisabled:function(e){var t=Object(f["cloneDeep"])(this.selectTab),i=e.split(","),n=!1;return t.forEach((function(e,t){var a=e.split(",");a[0]==i[0]&&a[1]!=i[1]&&(n=!0)})),n},selectTabChange:function(){var e=this,t=Object(f["cloneDeep"])(this.selectTab),i="",n=Object(f["cloneDeep"])(this.achievements_bak),a=Object(f["cloneDeep"])(this.contrastKith_bak);if(0==t.length)return this.achievements=n,void this.queryFinish();var s="1,1";t[t.length-1]==s&&(i=s,t=[s]),1==t.length&&t[0]!=s&&(i=t[0]),t.length>1&&t[0]==s&&(i=t[t.length-1],t=[i]),t.length>1&&(t[0]!=s||t[t.length-1]!=s)&&(i=t),this.selectTab=t;var c=[],l=[];"string"==typeof i&&(l=i.split(",")),a.forEach((function(e,t){var n=[],a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e.forEach((function(e,i){("-1"==e.value&&1==t||"-1"!=e.value&&2==t)&&n.push({key:e.key,value:e.value})})),c.push(n)};i==s||e.jx3id==l[0]?a(e.achievements,l[1]):"object"==Object(o["a"])(i)&&i instanceof Array&&i.forEach((function(t){var i=t.split(",");e.jx3id==i[0]&&a(e.achievements,i[1])})),e.achievements=n}));var r=this.getIntersectionByKey(c,"key"),u=[];r.map((function(t){e.achievements_bak[t]&&u.push(e.achievements_bak[t])})),this.achievements=u,this.queryFinish(!0)}}},p=m,b=(i("52b1"),i("2877")),g=Object(b["a"])(p,s,c,!1,null,"80357eda",null),k=g.exports,_=(i("fb6a"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-compare-mobile",class:{fold:e.isFold}},[t("div",{staticClass:"m-overview-header_mobile"},[t("div",{staticClass:"u-name"},[t("i",{class:e.isFold?"el-icon-s-unfold":"el-icon-s-fold ",on:{click:e.changeFold}}),e._v("  ")]),t("div",{staticClass:"u-select"},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":"",clearable:""},on:{change:e.selectTabChange},model:{value:e.selectTab,callback:function(t){e.selectTab=t},expression:"selectTab"}},e._l(e.selectOptions,(function(i){return t("el-option",{key:i.type,attrs:{label:i.name,value:i.type,disabled:e.isSelectDisabled(i.type)}})})),1)],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFold,expression:"!isFold"}],staticClass:"m-achievement-tab"},e._l(e.menuList,(function(i,n){return t("ul",{key:n,staticClass:"u-zl-item",class:{active:i.sub==e.activeIndex,show:i.sub==e.activeIndex&&!e.activeShow},on:{click:function(t){return e.setActiveIndex(i.sub)}}},[t("div",{staticClass:"u-zl-item_title"},[e._v(" "+e._s(i.name)+" "),t("i",{class:i.sub==e.activeIndex&&e.activeShow?"el-icon-caret-top":"el-icon-caret-bottom",on:{click:function(t){return t.stopPropagation(),e.setActiveShow(i.sub)}}})]),e._l(i.children,(function(n,a){return t("li",{key:a,staticClass:"u-zl-item_children",class:{active:n.detail==e.activeIndexChildren},on:{click:function(t){return t.stopPropagation(),e.setActiveIndex(i.sub,n.detail)}}},[e._v(" "+e._s(n.name)+" ")])}))],2)})),0),t("div",{staticClass:"m-compare-main"},[t("div",{staticClass:"u-zl-box"},[t("div",{staticClass:"u-zl_table",style:"max-width:"+60*(e.contrastKith.length+1)+"120px"},[e._m(0),e._l(e.contrastKith,(function(i,n){return t("div",{key:n,staticClass:"u-table_label kith"},[t("el-dropdown",{attrs:{trigger:"click"}},[t("div",{staticClass:"u-name"},[e._v(e._s(i.name.slice(0,1)))]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("div",{on:{click:function(t){return e.delRole(i,n)}}},[e._v("删除")])])],1)],1)],1)})),t("div",{staticClass:"u-table_label add",on:{click:e.addRole}},[t("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"})])],2),t("div",{staticClass:"u-zl_cell",style:"max-width:"+60*(e.contrastKith.length+1)+"120px"},[t("div",{staticClass:"u-zl-list ps"},e._l(e.achievements,(function(i,n){return t("div",{key:n,staticClass:"u-zl-list_item"},[t("span",{staticClass:"u-name"},[e._v("["+e._s(null===i||void 0===i?void 0:i.Name)+"]")])])})),0),e._l(e.contrastKith,(function(i,n){return t("div",{key:n,staticClass:"u-zl-list"},e._l(i.achievements,(function(e,i){return t("div",{key:i,staticClass:"u-zl-list_item kith"},[t("div",{staticClass:"u-self-checked",class:{finish:"-1"!=e.value}},[t("i",{staticClass:"el-icon-check"})])])})),0)})),t("div",{staticClass:"u-zl-list add"},e._l(e.achievements,(function(e,i){return t("div",{key:i,staticClass:"u-zl-list_item kith"})})),0)],2)])]),t("el-dialog",{attrs:{title:"添加角色",visible:e.showAddRole,width:"400px",draggable:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.showAddRole=t}}},[t("el-form",{ref:"roleRef",attrs:{model:e.kithForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"角色类型",prop:"roleType"}},[t("el-radio-group",{on:{input:function(t){e.kithForm.userId="",e.kithForm.jx3Id=""}},model:{value:e.kithForm.roleType,callback:function(t){e.$set(e.kithForm,"roleType",t)},expression:"kithForm.roleType"}},[t("el-radio",{attrs:{label:"1"}},[e._v("自身")]),t("el-radio",{attrs:{label:"2"}},[e._v("亲友")])],1)],1),2==e.kithForm.roleType?t("el-form-item",{attrs:{label:"我的亲友",prop:"uid"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getKithRolesList},model:{value:e.kithForm.uid,callback:function(t){e.$set(e.kithForm,"uid",t)},expression:"kithForm.uid"}},e._l(e.myKith,(function(e,i){var n;return t("el-option",{key:i,attrs:{label:(null===e||void 0===e||null===(n=e.kith_info)||void 0===n?void 0:n.display_name)||"-",value:e.kith_id}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"对应角色",prop:"jx3Id"}},[t("el-select",{attrs:{placeholder:"请选择对应角色"},on:{change:e.setRoleInfo},model:{value:e.kithForm.jx3Id,callback:function(t){e.$set(e.kithForm,"jx3Id",t)},expression:"kithForm.jx3Id"}},e._l(1==e.kithForm.roleType?e.roleList:e.myKithRoles,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.jx3id}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showAddRole=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addRoleConfirm}},[e._v("确 定")])],1)],1)],1)}),y=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"u-table_label ps"},[t("span",{staticClass:"u-compare-title"},[e._v("亲友对比")])])}],x={components:{},data:function(){return{isFold:!1,currentRole:{},menuList:[],selectTab:[],selectTabName:"请选择筛选条件",selectOptions:[{name:"共同未完成的",value:1,type:"1,1"}],activeIndex:1,activeShow:!0,activeIndexChildren:null,achievements:[],achievements_bak:[],showAddRole:!1,myKith:[],myKithRoles:[],roleList:[],kithForm:{uid:"",jx3Id:""},rules:{roleType:{required:!0,message:"请选择类型",trigger:"change"},uid:{required:!0,message:"请选择亲友",trigger:"change"},jx3Id:{required:!0,message:"请选择角色",trigger:"change"}},contrastKith:[],contrastKith_bak:[]}},created:function(){this.loadUserRoles()},mounted:function(){},methods:{changeFold:function(){this.isFold=!this.isFold,this.$store.commit("SET_STATE",{key:"is_fold",value:this.isFold})},icon_url:function(e){return Object(h["l"])(e)},setActiveShow:function(e){this.activeIndex!=e?this.setActiveIndex(e):this.activeShow=!this.activeShow},setActiveIndex:function(e,t){this.achievementsLoading||(this.activeIndex==e||t||(this.activeShow=!0),this.activeIndex=e,this.activeIndexChildren=t||null,this.getMenuAchievements(e,t))},getPoints:function(){var e=this;return Object(r["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.getList()}))},getList:function(){var e=this;Object(r["i"])({general:1,client:this.$store.state.client}).then((function(t){var i=t.data.data.menus;e.menuList=i,e.getMenuAchievements(1,"",1)}))},getMenuAchievements:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;Object(r["h"])(t,i).then((function(t){var i,a=t.data.data.achievements||[],s=[];(a.forEach((function(e){s.push(e),e.SeriesAchievementList&&e.SeriesAchievementList.forEach((function(e,t){t>0&&s.push(e)}))})),e.achievements=s,e.achievements_bak=Object(f["cloneDeep"])(e.achievements),1!=n)?(e.queryFinish(),e.selectTabChange()):null!==(i=e.currentRole)&&void 0!==i&&i.jx3id&&e.addRoleConfirm(e.currentRole.jx3id,1)}))},addRole:function(){var e=this;this.kithForm={roleType:"1",userId:"",jx3Id:""},this.showAddRole=!0,this.$nextTick((function(){e.$refs.roleRef.clearValidate()}))},getMyKith:function(){var e=this;Object(u["c"])().then((function(t){e.myKith=t.data.data}))},loadUserRoles:function(){var e=this;d["a"].isLogin()?Object(v["a"])().then((function(t){var i,n,a,s;e.roleList=(null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list)||[],e.currentRole=(null===(a=t.data)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.list[0])||{},e.getPoints(),e.getMyKith()})):this.$confirm("请先登录").then((function(e){d["a"].toLogin(window.location.href)}))},getKithRolesList:function(){var e=this;Object(u["d"])(this.kithForm.uid).then((function(t){e.myKithRoles=t.data.data,e.kithForm.jx3Id=""}))},delRole:function(e,t){this.contrastKith.splice(t,1),this.selectTab=[];var i=[],n=Object(f["cloneDeep"])(this.selectOptions);n.forEach((function(t,n){t.value!==e.jx3id&&i.push(t)})),this.selectOptions=i,this.selectTabChange()},setRoleInfo:function(e){if(1==this.kithForm.roleType){var t=this.roleList.find((function(t){return t.jx3id==e}));this.kithForm.info=t}else{var i=this.myKithRoles.find((function(t){return t.jx3id==e}));this.kithForm.info=i}},addRoleConfirm:function(e,t){var i=this,n=!1;this.contrastKith.forEach((function(a){a.jx3id==(1==t?e:i.kithForm.jx3Id)&&(n=!0)})),n?this.$message.warning("该角色已存在"):Object(r["m"])(1==t?e:this.kithForm.jx3Id).then((function(e){var n,a,s=((null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.achievements)||"").split(","),c={},o=0;s.forEach((function(e){o+=i.pointsData[e]||0})),c=t?Object(l["a"])(Object(l["a"])({},i.currentRole),{},{my_achievements:s,achievements:[],number:o}):Object(l["a"])(Object(l["a"])({},i.kithForm.info),{},{my_achievements:s,achievements:[],number:o}),i.selectOptions.push({value:c.jx3id,name:c.name+"未完成",type:"".concat(c.jx3id,",1")}),i.selectOptions.push({value:c.jx3id,name:c.name+"已完成",type:"".concat(c.jx3id,",2")}),1==t&&i.contrastKith[0]?i.$set(i.contrastKith,0,c):i.contrastKith.push(c),i.achievements=Object(f["cloneDeep"])(i.achievements_bak),i.queryFinish(),i.showAddRole=!1,i.selectTabChange()}))},queryFinish:function(e){var t=this,i=this.contrastKith,n=this.achievements;i.forEach((function(e,i){t.contrastKith[i].achievements=[],n.forEach((function(n,a){e.my_achievements.includes(n.ID.toString())?t.contrastKith[i].achievements.push({key:a,value:n.ID.toString()}):t.contrastKith[i].achievements.push({key:a,value:"-1"})}))})),e||(this.contrastKith_bak=Object(f["cloneDeep"])(this.contrastKith))},getIntersectionByKey:function(e,t){if(0===e.length)return[];var i=e.map((function(e){return e.map((function(e){return e[t]}))}));return i.reduce((function(e,t){return e.filter((function(e){return t.includes(e)}))}))},isSelectDisabled:function(e){var t=Object(f["cloneDeep"])(this.selectTab),i=e.split(","),n=!1;return t.forEach((function(e,t){var a=e.split(",");a[0]==i[0]&&a[1]!=i[1]&&(n=!0)})),n},selectTabChange:function(){var e=this,t=Object(f["cloneDeep"])(this.selectTab),i="",n=Object(f["cloneDeep"])(this.achievements_bak),a=Object(f["cloneDeep"])(this.contrastKith_bak);if(0==t.length)return this.achievements=n,void this.queryFinish();var s="1,1";t[t.length-1]==s&&(i=s,t=[s]),1==t.length&&t[0]!=s&&(i=t[0]),t.length>1&&t[0]==s&&(i=t[t.length-1],t=[i]),t.length>1&&(t[0]!=s||t[t.length-1]!=s)&&(i=t),this.selectTab=t;var c=[],l=[];"string"==typeof i&&(l=i.split(",")),a.forEach((function(e,t){var n=[],a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e.forEach((function(e,i){("-1"==e.value&&1==t||"-1"!=e.value&&2==t)&&n.push({key:e.key,value:e.value})})),c.push(n)};i==s||e.jx3id==l[0]?a(e.achievements,l[1]):"object"==Object(o["a"])(i)&&i instanceof Array&&i.forEach((function(t){var i=t.split(",");e.jx3id==i[0]&&a(e.achievements,i[1])})),e.achievements=n})),console.log(c);var r=this.getIntersectionByKey(c,"key"),u=[];r.map((function(t){e.achievements_bak[t]&&u.push(e.achievements_bak[t])})),this.achievements=u,this.queryFinish(!0)}}},j=x,C=(i("3908"),Object(b["a"])(j,_,y,!1,null,"4e16fd34",null)),w=C.exports,O={components:{pc:k,mobile:w},data:function(){return{}},computed:{mobile:function(){var e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipad","ipod","windows phone"];return t.some((function(t){return e.includes(t)}))}},created:function(){},mounted:function(){},methods:{}},I=O,R=(i("d46d"),Object(b["a"])(I,n,a,!1,null,"543fc175",null));t["default"]=R.exports},"4c53":function(e,t,i){"use strict";var n=i("23e7"),a=i("857a"),s=i("af03");n({target:"String",proto:!0,forced:s("sub")},{sub:function(){return a(this,"sub","","")}})},"52b1":function(e,t,i){"use strict";i("a633")},"6f53":function(e,t,i){"use strict";var n=i("83ab"),a=i("d039"),s=i("e330"),c=i("e163"),o=i("df75"),l=i("fc6a"),r=i("d1e7").f,u=s(r),h=s([].push),d=n&&a((function(){var e=Object.create(null);return e[2]=2,!u(e,2)})),v=function(e){return function(t){var i,a=l(t),s=o(a),r=d&&null===c(a),v=s.length,f=0,m=[];while(v>f)i=s[f++],n&&!(r?i in a:u(a,i))||h(m,e?[i,a[i]]:a[i]);return m}};e.exports={entries:v(!0),values:v(!1)}},9485:function(e,t,i){"use strict";var n=i("23e7"),a=i("2266"),s=i("59ed"),c=i("825a"),o=i("46c4"),l=i("2a62"),r=i("f99f"),u=i("2ba4"),h=i("d039"),d=TypeError,v=h((function(){[].keys().reduce((function(){}),void 0)})),f=!v&&r("reduce",d);n({target:"Iterator",proto:!0,real:!0,forced:v||f},{reduce:function(e){c(this);try{s(e)}catch(h){l(this,"throw",h)}var t=arguments.length<2,i=t?void 0:arguments[1];if(f)return u(f,this,t?[e]:[e,i]);var n=o(this),r=0;if(a(n,(function(n){t?(t=!1,i=n):i=e(i,n,r),r++}),{IS_RECORD:!0}),t)throw new d("Reduce of empty iterator with no initial value");return i}})},a633:function(e,t,i){},c967:function(e,t,i){"use strict";i.d(t,"j",(function(){return a})),i.d(t,"f",(function(){return s})),i.d(t,"e",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"h",(function(){return r})),i.d(t,"a",(function(){return u})),i.d(t,"g",(function(){return h})),i.d(t,"l",(function(){return d})),i.d(t,"b",(function(){return v})),i.d(t,"i",(function(){return f})),i.d(t,"k",(function(){return m}));var n=i("41cb");function a(e){return Object(n["a"])().get("/api/cms/wiki/post/rank",{params:e})}function s(e,t){return Object(n["a"])().get("/api/cms/wiki/post/id/".concat(e),{params:t})}function c(e){return Object(n["a"])({mute:!0}).get("/api/cms/user/".concat(e,"/info"))}function o(e){return Object(n["a"])().get("/api/cms/user/kith/my")}function l(e){return Object(n["a"])().get("/api/cms/user/kith/game-roles/".concat(e))}function r(e){return Object(n["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema",{params:e})}function u(e){return Object(n["a"])().post("/api/cms/pvx/wiki_achievement_leap_schema",e)}function h(e){return Object(n["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function d(e,t){return Object(n["a"])().put("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e),t)}function v(e){return Object(n["a"])().delete("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function f(e){return Object(n["a"])().post("/api/cms/pvx/wiki_achievement_difficulty/list",e)}function m(e){return Object(n["a"])().post("/api/cms/qqbot/picture_task",e)}},d38c:function(e,t,i){},d46d:function(e,t,i){"use strict";i("2788")},d58f:function(e,t,i){"use strict";var n=i("59ed"),a=i("7b0b"),s=i("44ad"),c=i("07fa"),o=TypeError,l="Reduce of empty array with no initial value",r=function(e){return function(t,i,r,u){var h=a(t),d=s(h),v=c(h);if(n(i),0===v&&r<2)throw new o(l);var f=e?v-1:0,m=e?-1:1;if(r<2)while(1){if(f in d){u=d[f],f+=m;break}if(f+=m,e?f<0:v<=f)throw new o(l)}for(;e?f>=0:v>f;f+=m)f in d&&(u=i(u,d[f],f,h));return u}};e.exports={left:r(!1),right:r(!0)}}}]);
//# sourceMappingURL=chunk-af7ff074.520ac04a.js.map