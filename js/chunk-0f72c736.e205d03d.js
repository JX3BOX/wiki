(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f72c736"],{"0705":function(e,t,i){},1450:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var a=i("41cb"),n=function(){return Object(a["f"])().get("api/team/my-game-roles?nopage&custom=0")}},1925:function(e,t,i){"use strict";i("0705")},"498a":function(e,t,i){"use strict";var a=i("23e7"),n=i("58a8").trim,s=i("c8d2");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return n(this)}})},"4c53":function(e,t,i){"use strict";var a=i("23e7"),n=i("857a"),s=i("af03");a({target:"String",proto:!0,forced:s("sub")},{sub:function(){return n(this,"sub","","")}})},"4db0":function(e,t,i){"use strict";i("fa82")},"54b6":function(e,t,i){},"9b30":function(e,t,i){e.exports=i.p+"img/leap_empty.6e4af458.png"},b85c:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));i("a4d3"),i("e01a"),i("d28b"),i("d9e2"),i("d3b7"),i("3ca3"),i("ddb0");var a=i("06c5");function n(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Object(a["a"])(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return c=e.done,e},e:function(e){o=!0,l=e},f:function(){try{c||null==i["return"]||i["return"]()}finally{if(o)throw l}}}}},c30e:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-leap-main"},[e.mobile?t("mobile"):t("pc")],1)},n=[],s=(i("caad"),i("d3b7"),i("2532"),i("b0c0"),i("ac1f"),i("25f0"),i("5319"),function(){var e,t=this,a=t._self._c;return a("div",{staticClass:"p-leap-pc"},[a("div",{staticClass:"m-title"},[a("div",{staticClass:"u-label-box"},[a("div",{staticClass:"u-label"},[t._v("渡劫方案")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"u-btn-created",on:{click:t.createLeap}},[a("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"}),t._v("定制方案 ")])]),a("div",{staticClass:"m-info-user",style:{opacity:t.currentRole?1:.5}},[a("span",{staticClass:"u-name"},[t._v(t._s(t.currentRole.name)+" "+t._s(t.currentRole.server&&"·")+" "+t._s(t.currentRole.server))]),a("el-dropdown",{attrs:{trigger:"click"}},[a("div",{staticClass:"u-toggle-btn"},[a("img",{attrs:{src:i("e5dd"),alt:""}})]),a("el-dropdown-menu",{staticClass:"m-role-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.roleList,(function(e){return a("el-dropdown-item",{key:e.ID},[a("div",{staticClass:"m-role-item",class:{active:e.jx3id===t.currentRole.jx3id},on:{click:function(i){return t.onChangeRole(e)}}},[a("span",[t._v(t._s(e.name))]),a("span",[t._v(t._s(e.server))])])])})),1)],1),a("div",{staticClass:"u-user-all_achievement"},[t._v(" 当前资历："),a("span",[t._v(t._s(t.currentRole.total||0))])])],1)]),t.showDetail?t._e():a("div",{staticClass:"m-main"},[a("div",{staticClass:"m-tables"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:"","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[a("el-table-column",{attrs:{prop:"title"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{target:"_blank",to:{name:"leap",query:{id:e.row.id}}}},[a("div",{staticStyle:{"text-align":"left",height:"24px"}},[t._v(t._s(e.row.title))])])]}}],null,!1,1018025156)},[a("template",{slot:"header"},[a("div",{staticClass:"u-table-cell_left"},[t._v("方案名称")])])],2),a("el-table-column",{attrs:{label:"方案资历总点数",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[t._v(" "+t._s((null===(i=t.getSchemePoints(e.row.schema))||void 0===i?void 0:i.all)||0)+" ")]}}],null,!1,2162533873)}),a("el-table-column",{attrs:{width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[a("div",{staticStyle:{"text-align":"right"}},[t._v(t._s((null===(i=t.getSchemePoints(e.row.schema))||void 0===i?void 0:i.diffNum)||0))])]}}],null,!1,4223628313)},[a("template",{slot:"header"},[a("div",{staticClass:"u-table-cell_right"},[t._v("可提升资历点数")])])],2),a("el-table-column",{attrs:{width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(1==e.row.is_official?"魔盒":"玩家")+" ")])]}}],null,!1,2594864838)},[a("template",{slot:"header"},[a("div",{staticClass:"u-table-cell_right"},[t._v("来源")])])],2)],1),a("div",{staticClass:"u-page"},[a("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next",total:t.pageTotal},on:{"current-change":t.pageChange}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.list.length,expression:"list.length == 0"}],staticClass:"u-btn",on:{click:t.createLeap}},[a("i",{staticClass:"el-icon-circle-plus-outline u-add-icon"}),a("div",[t._v("定制方案")])])]),t.showDetail?a("div",{staticClass:"m-detail"},[a("div",{staticClass:"u-detail-left"},[a("ul",{staticClass:"u-detail-left_item"},[a("li",{staticClass:"u-menu-parent u-menu-text",class:{active:null==t.detailSelectMenu},on:{click:function(e){return t.changeDetailMenu(null,0)}}},[t._v(" 全部 ")])]),t._l(t.menuList,(function(e,i){return a("div",{key:i,on:{click:function(i){return t.changeDetailMenu(e,1)}}},[e.show?a("ul",{staticClass:"u-detail-left_item"},[a("li",{staticClass:"u-menu-parent u-menu-text",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.name)+" ")]),t._l(e.children,(function(e,i){return a("div",{key:i,on:{click:function(i){return i.stopPropagation(),t.changeDetailMenu(e,2)}}},[e.show?a("li",{staticClass:"u-menu-item_children u-menu-text",class:{active:t.detailSelectMenu==e.id}},[t._v(" "+t._s(e.name)+" ")]):t._e()])}))],2):t._e()])}))],2),a("div",{staticClass:"u-detail-right"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.detail.achievements||[],stripe:"",height:"100%","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[a("el-table-column",{attrs:{prop:"Name",label:"成就名称"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[a("a",{attrs:{href:t.getLink("achievement",e.row.ID),target:"_blank"}},[a("div",{staticClass:"u-achievement-name"},[a("img",{staticClass:"u-icon",attrs:{src:t.iconLink(null===(i=e.row)||void 0===i?void 0:i.IconID)}}),a("span",[t._v(t._s(e.row.Name))])])])]}}],null,!1,1386175746)}),a("el-table-column",{attrs:{label:"资历点数",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.Point||0)+" ")]}}],null,!1,2769844481)}),a("el-table-column",{attrs:{label:"全服完成度",width:"260"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"u-process-box"},[a("div",{staticClass:"u-process-item",style:{width:e.row.process}}),a("div",{staticClass:"u-process-text"},[t._v(t._s(e.row.process))])])]}}],null,!1,2731956328)}),a("el-table-column",{attrs:{label:"难度",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-rate",{attrs:{value:e.row.difficulty,disabled:"","allow-half":"","disabled-void-color":"#574938"}})]}}],null,!1,1061623576)}),a("el-table-column",{attrs:{label:"奖励",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var i;return[e.row.item?a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("jx3-item",{attrs:{item:e.row.item}})],1),a("img",{staticClass:"u-icon",attrs:{src:t.iconLink(null===(i=e.row.item)||void 0===i?void 0:i.IconID)}})]):t._e()]}}],null,!1,2231464350)})],1)],1)]):t._e(),a("el-dialog",{attrs:{title:"创建方案",visible:t.dialogTableVisible,"lock-scroll":"","close-on-click-modal":!1,"custom-class":"m-custom-dialog"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("div",{staticClass:"u-dialog-content"},[a("div",{staticClass:"u-dialog-header"},[a("div",{staticClass:"u-dialog-header_item"},[a("span",[t._v("方案名称：")]),a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.leapForm.title,callback:function(e){t.$set(t.leapForm,"title",e)},expression:"leapForm.title"}})],1),a("div",{staticClass:"u-dialog-header_item"},[a("span",[t._v("目标资历：")]),a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.leapForm.number,callback:function(e){t.$set(t.leapForm,"number",t._n(e))},expression:"leapForm.number"}})],1)]),a("div",{staticClass:"u-dialog-tips"},[t._v("请选择个人偏好，盒子娘将会为你制定专属渡劫方案：")]),a("div",{staticClass:"u-dialog-main"},[a("div",{staticClass:"u-dialog-main_left"},[a("div",{staticClass:"u-dialog-main_title"},[t._v("方向")]),a("div",{staticClass:"u-dialog-main_category"},[a("div",{staticClass:"u-dialog-main_category_item",class:{active:1==t.dialogQueryParams.is_official},on:{click:function(e){return t.changeCategory(1)}}},[t._v(" 推荐 ")]),a("div",{staticClass:"u-dialog-main_category_item",class:{active:0==t.dialogQueryParams.is_official},on:{click:function(e){return t.changeCategory(0)}}},[t._v(" 自选 ")])])]),a("div",{staticClass:"u-dialog-main_right"},[a("div",{staticClass:"u-dialog-main_title"},[t._v(" "+t._s(1==t.dialogQueryParams.is_official?"推荐方案":"自选方案")+" ")]),1==t.dialogQueryParams.is_official?a("div",{staticClass:"u-dialog-main_recommend"},[t.recommendList.length?t._e():a("div",{staticClass:"u-recommend-empty"},[a("img",{attrs:{src:i("9b30"),width:"300px"}})]),t.recommendList.length?a("div",{staticClass:"u-recommend-list u-common-list"},t._l(t.recommendList,(function(e){return a("div",{key:e.id,staticClass:"u-item",class:{active:e.id==t.selectRecommendItem.id},attrs:{title:e.title},on:{click:function(i){return t.selectRecommend(e)}}},[t._v(" "+t._s(e.title)+" ")])})),0):t._e(),t.recommendList.length?a("div",{staticClass:"u-recommend-desc"},[a("div",{staticClass:"u-recommend-desc_title"},[t._v(" 方案总资历点数："+t._s((null===(e=t.selectRecommendItem)||void 0===e?void 0:e.all)||0)+" ")]),a("div",{staticClass:"u-recommend-desc_source"},[t._v(" 来源："+t._s(t.selectRecommendItem?1==t.selectRecommendItem.is_official?"魔盒":"玩家":"-")+" ")]),a("div",{staticClass:"u-recommend-desc_text"},[a("span",[t._v("简介：")]),a("div",{domProps:{innerHTML:t._s(t.selectRecommendItem.desc)}})])]):t._e()]):a("div",{staticClass:"u-dialog-main_custom"},[a("div",{staticClass:"u-dialog-main_custom_list u-common-list u-first-box"},t._l(t.menuList,(function(e){return a("div",{key:e.id,staticClass:"u-item u-first",class:{active:t.selectMenuItem.id==e.id},on:{click:function(i){return t.selectMenu(e,1)}}},[a("el-badge",{staticClass:"u-badge-item",attrs:{value:t.selectMenuNum(e)}},[t._v(" "+t._s(e.name)+" ")])],1)})),0),a("div",{staticClass:"u-dialog-main_custom_list u-common-list"},t._l(t.selectMenuItem.children,(function(e){return a("div",{key:e.id,staticClass:"u-item",class:{active:t.selectMenuChildrenItem.id==e.id},on:{click:function(i){return t.selectMenuChildren(e)}}},[a("el-badge",{attrs:{"is-dot":t.isSelectMenuChildren(e)}},[t._v(" "+t._s(e.name)+" ")])],1)})),0),a("div",{staticClass:"u-dialog-main_custom_list u-common-list"},[a("div",{staticClass:"u-item u-select-all",on:{click:function(e){return t.selectAllAchievement()}}},[t._v("全部")]),t._l(t.achievements,(function(e){return a("div",{key:e.ID,staticClass:"u-item u-select",class:{"achievement-active":t.isSelectAchievement(e)},on:{click:function(i){return t.selectAchievement(e)}}},[a("img",{attrs:{src:i("f024")}}),a("el-tooltip",{attrs:{effect:"dark",content:e.Name,placement:"top-start"}},[a("div",[t._v(t._s(e.Name))])])],1)}))],2)])])]),a("div",{staticClass:"u-dialog-footer"},[a("div",{staticClass:"u-dialog-footer_tips"},[t._v(" 当前方案共 "),a("span",[t._v(t._s(t.leapForm.all.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历，可为你提供 "),a("span",[t._v(t._s(this.leapForm.diffNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历提升，距离目标还剩 "),a("span",[t._v(t._s(t.leapForm.remaining.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")))]),t._v(" 资历。 ")]),a("div",{staticClass:"u-btn",on:{click:function(e){return t.submitLeap()}}},[t._v("生成方案")])])])])],1)}),l=[],c=(i("99af"),i("4de4"),i("7db0"),i("d81d"),i("14d9"),i("b680"),i("b64b"),i("4c53"),i("0643"),i("2382"),i("fffc"),i("4e3e"),i("a573"),i("159b"),i("262e")),o=i("c967"),r=i("c7fa"),u=i("85e4"),d=i("c9d2"),m=i("1450"),h=i("2ef0"),v={components:{"jx3-item":r["a"]},data:function(){return{currentRole:{},roleList:[],showDetail:!1,loading:!1,list:[],queryParams:{page:1,per:20},pageTotal:0,dialogTableVisible:!1,leapForm:{title:"",all:0,diffNum:0,remaining:0,number:0},pointsData:[],dialogQueryParams:{is_official:1,_no_page:1},recommendList:[],selectRecommendItem:{},customList:[],menuList:[],selectMenuItem:{},selectMenuChildrenItem:{},achievements:[],detail:{},detailSelectMenu:null,detailPageTotal:0}},watch:{customList:{deep:!0,handler:function(){this.schemeCompute()}},"leapForm.number":{deep:!0,handler:function(){this.schemeCompute()}}},created:function(){this.$route.query.id&&(this.showDetail=!0),this.loadUserRoles(),this.getMenuList()},mounted:function(){},methods:{iconLink:u["k"],getLink:u["f"],loadUserRoles:function(){var e=this;d["a"].isLogin()&&Object(m["a"])().then((function(t){var i,a,n,s;e.roleList=(null===(i=t.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.list)||[],e.currentRole=(null===(n=t.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.list[0])||{},e.getPoints()}))},getPoints:function(){var e=this;return Object(c["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.$route.query.id?e.getRoleGameAchievements():e.getSchemaList()}))},onChangeRole:function(e){this.currentRole=e,this.getRoleGameAchievements()},getRoleGameAchievements:function(){var e=this;Object(c["m"])(this.currentRole.jx3id).then((function(t){var i,a;e.currentRole.achievements=(null===(i=t.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.achievements)||[];var n=0,s=Object(h["cloneDeep"])(e.currentRole.achievements).split(",")||[];s.forEach((function(t){n+=e.pointsData[t]||0})),e.$set(e.currentRole,"total",n)}))},pageChange:function(e){this.queryParams.page=e,this.getSchemaList(!0)},getSchemaList:function(e){var t=this;Object(o["g"])(this.queryParams).then((function(i){var a,n,s,l;t.list=(null===(a=i.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.list)||[],t.pageTotal=(null===(s=i.data)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.total)||0,e||t.getRoleGameAchievements()}))},getSchemePoints:function(e){var t=this.pointsData,i=[];e.forEach((function(e){i.push({ID:e,Point:t[e]})}));var a=this.schemeCompute(i);return{all:a.all,diffNum:a.diffNum}},getSchemaDetail:function(){var e=this;Object(o["f"])(this.$route.query.id).then((function(t){var i,a,n;e.detail=(null===(i=t.data)||void 0===i?void 0:i.data)||{},e.getAchievements(null===(a=t.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.schema)}))},getAchievements:function(e){var t=this;this.loading=!0,Object(c["c"])({ids:e.toString(),attributes:"Name,Sub,Detail,IconID,Item,Point,ID"}).then((function(i){var a;t.detail.achievements=(null===(a=i.data)||void 0===a?void 0:a.data)||[],t.detail.achievementsBak=Object(h["cloneDeep"])(t.detail.achievements);var n=Object(h["cloneDeep"])(t.menuList);Object.keys(n).map((function(e){n[e].children.forEach((function(i){t.detail.achievements.forEach((function(t){n[e].sub==t.Sub&&(n[e].show=!0),t.Detail==i.detail&&(i.show=!0)}))}))})),t.loading=!1,t.$set(t,"menuList",n),t.getAchievementProgress(e)}))},getAchievementProgress:function(e){var t=this;Object(o["h"])(e).then((function(e){var i;t.detail.progressAndDifficulty=(null===(i=e.data)||void 0===i?void 0:i.data)||[],t.getDifficulty()}))},getDifficulty:function(){var e=this,t=[];this.detail.achievementsBak.forEach((function(i){var a=e.detail.progressAndDifficulty.find((function(e){return e.achievement_id==i.ID}));i.difficulty=((null===a||void 0===a?void 0:a.difficulty)||0)/10,i.process=((a.completed_role_count/a.total_role_count*100).toFixed(2)||0)+"%",t.push(i)})),this.$set(this.detail,"achievements",t),this.$forceUpdate()},changeDetailMenu:function(e,t){if(0==t)return this.detailSelectMenu=null,void(this.detail.achievements=Object(h["cloneDeep"])(this.detail.achievementsBak));this.detailSelectMenu=e.id;var i=[];this.detail.achievementsBak.forEach((function(a){1==t&&a.Sub==e.sub&&i.push(a),2==t&&a.Detail==e.detail&&i.push(a)})),this.detail.achievements=i},createLeap:function(){this.dialogTableVisible=!0,this.leapForm={title:"",all:0,diffNum:0,remaining:0,number:0},this.dialogQueryParams={is_official:1,_no_page:1},this.customList=[],this.dialogQuery()},changeCategory:function(e){this.leapForm={title:"",all:0,diffNum:0,remaining:0,number:0},this.dialogQueryParams.is_official=e,1==e&&this.dialogQuery()},dialogQuery:function(){var e=this;Object(o["g"])(this.dialogQueryParams).then((function(t){var i;e.recommendList=(null===(i=t.data)||void 0===i?void 0:i.data)||[]}))},selectRecommend:function(e){this.selectRecommendItem=e;var t=this.getSchemePoints(this.selectRecommendItem.schema),i=0;this.leapForm.number>0&&this.leapForm.number>t.diffNum&&(i=this.leapForm.number-t.diffNum),this.leapForm.all=t.all,this.leapForm.diffNum=t.diffNum,this.leapForm.remaining=i},getMenuList:function(){var e=this;Object(c["i"])({general:1,client:"std"}).then((function(t){var i=t.data.data.menus;e.menuList=i,e.$route.query.id?e.getSchemaDetail():(e.selectMenuItem=i[1],e.selectMenuChildrenItem={},e.getMenuAchievements())}))},selectMenu:function(e){var t;this.selectMenuItem=e,this.selectMenuChildrenItem={},0==e.achievements.length&&(this.selectMenuChildrenItem=(null===(t=e.children)||void 0===t?void 0:t[0])||{}),this.getMenuAchievements(e.sub,0==e.achievements.length?this.selectMenuChildrenItem.detail:"")},selectMenuChildren:function(e){this.selectMenuChildrenItem=e,this.getMenuAchievements(e.sub,e.detail)},getMenuAchievements:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0;Object(c["h"])(t,i).then((function(t){e.achievements=t.data.data.achievements||[]}))},selectMenuNum:function(e){for(var t=0,i=0;i<this.customList.length;i++)this.customList[i].Sub==e.sub&&t++;return t},isSelectMenu:function(e){for(var t=!1,i=0;i<this.customList.length;i++)if(this.customList[i].Sub==e.sub&&!this.customList[i].Detail){t=!0;break}return t},isSelectMenuChildren:function(e){for(var t=!1,i=0;i<this.customList.length;i++)if(this.customList[i].Detail==e.detail){t=!0;break}return t},isSelectAchievement:function(e){for(var t=!1,i=0;i<this.customList.length;i++)if(this.customList[i].ID==e.ID){t=!0;break}return t},selectAllAchievement:function(){var e=this;Object(h["isEmpty"])(this.selectMenuChildrenItem)?this.isSelectMenu(this.selectMenuItem)?this.customList=this.customList.filter((function(t){return t.Sub!=e.selectMenuItem.sub||t.Sub==e.selectMenuItem.sub&&null!=t.Detail})):this.customList=this.customList.concat(this.achievements):this.isSelectMenuChildren(this.selectMenuChildrenItem)?this.customList=this.customList.filter((function(t){return t.Detail!=e.selectMenuChildrenItem.detail})):this.customList=this.customList.concat(this.achievements)},selectAchievement:function(e){console.log(e),this.isSelectAchievement(e)?this.customList=this.customList.filter((function(t){return t.ID!=e.ID})):this.customList.push(e)},schemeCompute:function(e){var t=0,i=0,a=0,n=this,s=e||this.customList,l=s.filter((function(e){var i;return t+=e.Point,-1==(null===(i=n.currentRole.achievements)||void 0===i?void 0:i.indexOf(e.ID))||!1}));if(l.forEach((function(e){i+=e.Point})),e)return{all:t,diffNum:i};this.leapForm.number>0&&this.leapForm.number>i&&(a=this.leapForm.number-i),this.leapForm.all=t,this.leapForm.diffNum=i,this.leapForm.remaining=a},submitLeap:function(){var e=this,t=[];this.customList.forEach((function(e){t.push(e.ID)}));var i={title:Object(h["isEmpty"])(this.leapForm.title)?"未命名方案":this.leapForm.title,schema:t};Object(o["a"])(i).then((function(t){e.dialogTableVisible=!1,e.getSchemaList(),e.$message.success("创建成功")}))}}},f=v,p=(i("4db0"),i("2877")),g=Object(p["a"])(f,s,l,!1,null,null,null),_=g.exports,b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-leap-mobile",class:{fold:e.isFold}},[t("div",{staticClass:"m-overview-header_mobile"},[t("div",{staticClass:"u-name"},[t("i",{class:e.isFold?"el-icon-s-unfold":"el-icon-s-fold ",on:{click:e.changeFold}}),e._v("  ")]),t("div",{staticClass:"u-select"},[t("el-dropdown",{attrs:{trigger:"click"}},[t("div",{staticClass:"u-select-btn"},[t("span",[e._v(e._s(e.currentRole.name)+" "+e._s(e.currentRole.server&&"·")+" "+e._s(e.currentRole.server))]),t("img",{attrs:{src:i("e5dd"),alt:"",width:"16px",height:"16px"}})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.roleList,(function(i){return t("el-dropdown-item",{key:i.ID},[t("div",{staticClass:"m-role-item",on:{click:function(t){return e.onChangeRole(i)}}},[t("span",[e._v(e._s(i.name))]),t("span",[e._v(e._s(i.server))])])])})),1)],1)],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFold&&e.isDetail,expression:"!isFold && isDetail"}],staticClass:"m-achievement-tab"},[t("ul",{staticClass:"u-zl-item",class:{active:null==e.detailSelectMenu}},[t("div",{staticClass:"u-zl-item_title",on:{click:function(t){return e.changeDetailMenu(null,0)}}},[e._v("全部")])]),e._l(e.menuList,(function(i,a){return t("div",{key:a,on:{click:function(t){return e.changeDetailMenu(i,1)}}},[i.show?t("ul",{staticClass:"u-zl-item",class:{active:e.detailSelectMenu==i.id}},[t("div",{staticClass:"u-zl-item_title"},[e._v(e._s(i.name))]),e._l(i.children,(function(i,a){return t("div",{key:a,on:{click:function(t){return t.stopPropagation(),e.changeDetailMenu(i,2)}}},[i.show?t("li",{staticClass:"u-zl-item_children",class:{active:e.detailSelectMenu==i.id}},[e._v(" "+e._s(i.name)+" ")]):e._e()])}))],2):e._e()])}))],2),e.isDetail?t("div",{staticClass:"m-leap-detail"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.detail.achievements||[],stripe:"",height:"100%","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[t("el-table-column",{attrs:{prop:"Name",label:"成就名称"},scopedSlots:e._u([{key:"default",fn:function(i){var a;return[t("a",{attrs:{href:e.getLink("achievement",i.row.ID),target:"_blank"}},[t("div",{staticClass:"u-achievement-name"},[t("img",{staticClass:"u-icon",attrs:{src:e.iconLink(null===(a=i.row)||void 0===a?void 0:a.IconID)}}),t("span",[e._v(e._s(i.row.Name))])])])]}}])}),t("el-table-column",{attrs:{label:"资历点数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.Point||0)+" ")]}}])}),t("el-table-column",{attrs:{label:"难度",width:"140"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-rate",{attrs:{value:e.row.difficulty,disabled:"","allow-half":"","disabled-void-color":"#574938"}})]}}])}),t("el-table-column",{attrs:{label:"奖励",width:"60"},scopedSlots:e._u([{key:"default",fn:function(i){var a;return[i.row.item?t("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"}},[t("div",[t("jx3-item",{attrs:{item:i.row.item}})],1),t("img",{staticClass:"u-icon",attrs:{slot:"reference",src:e.iconLink(null===(a=i.row.item)||void 0===a?void 0:a.IconID)},slot:"reference"})]):e._e()]}}])})],1)],1):t("div",{staticClass:"m-leap-main"},[t("el-table",{staticStyle:{width:"100%","max-height":"calc(100vh - 85px)"},attrs:{data:e.list,height:"100%",stripe:"","row-class-name":"u-table-row","cell-class-name":"u-table-cell","header-row-class-name":"u-table-header_row","header-cell-class-name":"u-table-header_cell"}},[t("el-table-column",{attrs:{prop:"title",label:"方案名称",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("router-link",{attrs:{target:"_blank",to:{name:"leap",query:{id:i.row.id}}}},[e._v(" "+e._s(i.row.title)+" ")])]}}],null,!1,2830009994)}),t("el-table-column",{attrs:{label:"方案资历总点数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i;return[e._v(" "+e._s((null===(i=e.getSchemePoints(t.row.schema))||void 0===i?void 0:i.all)||0)+" ")]}}],null,!1,2162533873)}),t("el-table-column",{attrs:{label:"可提升资历点数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i;return[e._v(" "+e._s((null===(i=e.getSchemePoints(t.row.schema))||void 0===i?void 0:i.diffNum)||0)+" ")]}}],null,!1,1534313675)}),t("el-table-column",{attrs:{label:"来源",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row.is_official?"魔盒":"玩家")+" ")]}}],null,!1,2935795252)})],1),t("div",{staticClass:"u-page"},[t("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next",total:e.pageTotal},on:{"current-change":e.pageChange}})],1)],1)])},w=[],C={components:{"jx3-item":r["a"]},data:function(){return{isFold:!1,isDetail:!1,currentRole:{},roleList:[],loading:!1,menuList:[],selectMenuItem:{},selectMenuChildrenItem:{},achievements:[],list:[],queryParams:{page:1,per:20},pageTotal:0,customList:[],detail:{},detailSelectMenu:null,detailPageTotal:0}},created:function(){this.$route.query.id&&(this.isDetail=!0,this.getMenuList()),this.loadUserRoles()},mounted:function(){},methods:{changeFold:function(){this.isFold=!this.isFold,this.$store.commit("SET_STATE",{key:"is_fold",value:this.isFold})},iconLink:u["k"],getLink:u["f"],getMenuList:function(){var e=this;Object(c["i"])({general:1,client:"std"}).then((function(t){var i=t.data.data.menus;e.menuList=i,e.getSchemaDetail()}))},loadUserRoles:function(){var e=this;d["a"].isLogin()&&Object(m["a"])().then((function(t){var i,a,n,s;e.roleList=(null===(i=t.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.list)||[],e.currentRole=(null===(n=t.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.list[0])||{},e.getPoints()}))},getPoints:function(){var e=this;return Object(c["b"])().then((function(t){var i=t.data.data.points;e.pointsData=i,e.$route.query.id?e.getRoleGameAchievements():e.getSchemaList()}))},onChangeRole:function(e){this.currentRole=e,this.getRoleGameAchievements()},getRoleGameAchievements:function(){var e=this;Object(c["m"])(this.currentRole.jx3id).then((function(t){var i,a;e.currentRole.achievements=(null===(i=t.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.achievements)||[];var n=0,s=Object(h["cloneDeep"])(e.currentRole.achievements).split(",")||[];s.forEach((function(t){n+=e.pointsData[t]||0})),e.$set(e.currentRole,"total",n)}))},pageChange:function(e){this.queryParams.page=e,this.getSchemaList(!0)},getSchemaList:function(e){var t=this;Object(o["g"])(this.queryParams).then((function(i){var a,n,s,l;t.list=(null===(a=i.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.list)||[],t.pageTotal=(null===(s=i.data)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.total)||0,e||t.getRoleGameAchievements()}))},getSchemePoints:function(e){var t=this.pointsData,i=[];e.forEach((function(e){i.push({ID:e,Point:t[e]})}));var a=this.schemeCompute(i);return{all:a.all,diffNum:a.diffNum}},getSchemaDetail:function(){var e=this;Object(o["f"])(this.$route.query.id).then((function(t){var i,a,n;e.detail=(null===(i=t.data)||void 0===i?void 0:i.data)||{},e.getAchievements(null===(a=t.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.schema)}))},getAchievements:function(e){var t=this;this.loading=!0,Object(c["c"])({ids:e.toString(),attributes:"Name,Sub,Detail,IconID,Item,Point,ID"}).then((function(i){var a;t.detail.achievements=(null===(a=i.data)||void 0===a?void 0:a.data)||[],t.detail.achievementsBak=Object(h["cloneDeep"])(t.detail.achievements);var n=Object(h["cloneDeep"])(t.menuList);Object.keys(n).map((function(e){n[e].children.forEach((function(i){t.detail.achievements.forEach((function(t){n[e].sub==t.Sub&&(n[e].show=!0),t.Detail==i.detail&&(i.show=!0)}))}))})),t.loading=!1,t.$set(t,"menuList",n),t.getAchievementProgress(e)}))},getAchievementProgress:function(e){var t=this;Object(o["h"])(e).then((function(e){var i;t.detail.progressAndDifficulty=(null===(i=e.data)||void 0===i?void 0:i.data)||[],t.getDifficulty()}))},getDifficulty:function(){var e=this,t=[];this.detail.achievementsBak.forEach((function(i){var a=e.detail.progressAndDifficulty.find((function(e){return e.achievement_id==i.ID}));i.difficulty=((null===a||void 0===a?void 0:a.difficulty)||0)/10,i.process=((a.completed_role_count/a.total_role_count*100).toFixed(2)||0)+"%",t.push(i)})),this.$set(this.detail,"achievements",t),this.$forceUpdate()},changeDetailMenu:function(e,t){if(0==t)return this.detailSelectMenu=null,void(this.detail.achievements=Object(h["cloneDeep"])(this.detail.achievementsBak));this.detailSelectMenu=e.id;var i=[];this.detail.achievementsBak.forEach((function(a){1==t&&a.Sub==e.sub&&i.push(a),2==t&&a.Detail==e.detail&&i.push(a)})),this.detail.achievements=i},schemeCompute:function(e){var t=0,i=0,a=this,n=e||this.customList,s=n.filter((function(e){var i;return t+=e.Point,-1==(null===(i=a.currentRole.achievements)||void 0===i?void 0:i.indexOf(e.ID))||!1}));return s.forEach((function(e){i+=e.Point})),{all:t,diffNum:i}}}},y=C,k=(i("1925"),Object(p["a"])(y,b,w,!1,null,null,null)),S=k.exports,L={components:{pc:_,mobile:S},data:function(){return{}},computed:{mobile:function(){var e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipad","ipod","windows phone"];return t.some((function(t){return e.includes(t)}))}},created:function(){},mounted:function(){},methods:{}},D=L,I=(i("ee81"),Object(p["a"])(D,a,n,!1,null,"221f15b6",null));t["default"]=I.exports},c8d2:function(e,t,i){"use strict";var a=i("5e77").PROPER,n=i("d039"),s=i("5899"),l="​᠎";e.exports=function(e){return n((function(){return!!s[e]()||l[e]()!==l||a&&s[e].name!==e}))}},c967:function(e,t,i){"use strict";i.d(t,"i",(function(){return n})),i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"g",(function(){return r})),i.d(t,"a",(function(){return u})),i.d(t,"f",(function(){return d})),i.d(t,"h",(function(){return m}));var a=i("41cb");function n(e){return Object(a["a"])().get("/api/cms/wiki/post/rank",{params:e})}function s(e,t){return Object(a["a"])().get("/api/cms/wiki/post/id/".concat(e),{params:t})}function l(e){return Object(a["a"])({mute:!0}).get("/api/cms/user/".concat(e,"/info"))}function c(e){return Object(a["a"])().get("/api/cms/user/kith/my")}function o(e){return Object(a["a"])().get("/api/cms/user/kith/game-roles/".concat(e))}function r(e){return Object(a["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema",{params:e})}function u(e){return Object(a["a"])().post("/api/cms/pvx/wiki_achievement_leap_schema",e)}function d(e){return Object(a["a"])().get("/api/cms/pvx/wiki_achievement_leap_schema/".concat(e))}function m(e){return Object(a["a"])().post("/api/cms/pvx/wiki_achievement_difficulty/list",e)}},e5dd:function(e,t,i){e.exports=i.p+"img/toggle-user-icon.4a7a0c8b.svg"},ee81:function(e,t,i){"use strict";i("54b6")},f024:function(e,t,i){e.exports=i.p+"img/tick.d0920657.svg"},fa82:function(e,t,i){}}]);
//# sourceMappingURL=chunk-0f72c736.e205d03d.js.map