(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ab8ba00"],{1527:function(t,n,e){"use strict";var i=function(){var t=this,n=t._self._c;return n("div",[n("el-drawer",t._b({staticClass:"c-var",staticStyle:{width:"100%"},attrs:{visible:t.visible,direction:"btt","show-close":!1,"with-header":!1,"custom-class":"add-item-plan-drawer","append-to-body":"",size:"400"},on:{close:t.onClose},scopedSlots:t._u([{key:"default",fn:function(){var e;return[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-var m-add-item-plan-drawer"},[n("div",{staticClass:"m-drawer-content"},[n("div",{staticClass:"m-user-select__title"},[t._v("加入物品")]),n("ItemCardVue",{attrs:{"item-id":t.item_id,data:t.item}}),n("div",{staticClass:"m-count-edit"},[n("i",{staticClass:"el-icon-minus",on:{click:function(n){t.current_count--}}}),n("el-input",{model:{value:t.current_count,callback:function(n){t.current_count=t._n(n)},expression:"current_count"}}),n("i",{staticClass:"el-icon-plus",on:{click:function(n){t.current_count++}}})],1),t.fixed_plan?t._e():n("div",{staticClass:"m-user-select__title"},[t._v("选择清单")]),t.fixed_plan?t._e():n("div",{staticClass:"u-menu",on:{click:t.onSelectPlan}},[t._v(" "+t._s((null===(e=t.current_plan)||void 0===e?void 0:e.title)||"请选择")+" ")]),t.current_plan?[n("div",{staticClass:"m-user-select__title"},[t._v("选择分组")]),n("div",{staticClass:"u-menu",on:{click:t.onSelectGroup}},[t._v(t._s(t.current_group_title||"请选择"))])]:t._e()],2),n("div",{staticClass:"m-op"},[n("button",{staticClass:"u-confirm",on:{click:t.onConfirm}},[t._v("确定")])])])]},proxy:!0}])},"el-drawer",t.$attrs,!1)),n("SelectDrawer",{ref:"plan-select"})],1)},c=[],a=e("2909"),r=e("5530"),s=(e("99af"),e("d81d"),e("d3b7"),e("8a28")),o=e("ace4e"),u=e("dc8a"),l={name:"AddItemPlanDrawer",components:{SelectDrawer:o["a"],ItemCardVue:u["a"]},data:function(){return{visible:!1,item_id:null,item:void 0,plan_list:[],loading:!1,current_plan_id:null,current_plan:null,current_group_index:null,current_count:1,fixed_plan:!1,callback:{}}},computed:{client:function(){return this.$store.state.client},current_group_title:function(){var t,n;if(null!==this.current_group_index){var e=null===(t=this.current_plan)||void 0===t||null===(n=t.relation[this.current_group_index])||void 0===n?void 0:n.title;return"(".concat(this.current_group_index+1,") ").concat(e)}}},watch:{current_plan_id:function(t){t&&this.loadPlan()},current_count:function(t){(t<1||isNaN(t))&&(this.current_count=1)}},methods:{loadPlan:function(){var t=this;this.loading=!0,Object(s["c"])(this.current_plan_id).then((function(n){t.current_plan=n||{}})).finally((function(){t.loading=!1}))},loadPlans:function(){var t=this;this.loading=!0,Object(s["e"])({no_page:1,_no_cache:1}).then((function(n){t.plan_list=n||[]})).finally((function(){t.loading=!1}))},onSelectPlan:function(){var t=this;this.$refs["plan-select"].open({options:this.plan_list.map((function(t){return{value:t.id,label:t.title}})),title:"请选择清单"}).then((function(n){t.current_plan_id=n})).catch((function(){}))},onSelectGroup:function(){var t=this;this.$refs["plan-select"].open({options:this.current_plan.relation.map((function(t,n){return{value:n,label:"(".concat(n+1,") ").concat(t.title)}})),title:"请选择分组"}).then((function(n){t.current_group_index=n})).catch((function(){}))},open:function(t){var n=this,e=t.item_id,i=t.item,c=t.plan;return this.visible=!0,this.item_id=e,i&&(this.item=i),c?(this.current_plan_id=c.id,this.current_plan=c,this.fixed_plan=!0):this.loadPlans(),new Promise((function(t,e){n.callback={resolve:t,reject:e}}))},onClose:function(){this.visible=!1,this.current_plan_id=null,this.current_plan=null,this.current_group_index=null,this.current_count=1},onConfirm:function(){var t=this;this.loading=!0,Object(s["f"])(this.current_plan_id,{relation:this.current_plan.relation.map((function(n,e){return e!=t.current_group_index?n:Object(r["a"])(Object(r["a"])({},n),{},{data:[].concat(Object(a["a"])(n.data),[{id:t.item_id,count:t.current_count}])})}))}).then((function(){t.callback.resolve(),t.onClose()})).finally((function(){t.loading=!1}))}}},d=l,f=(e("61a1"),e("2877")),p=Object(f["a"])(d,i,c,!1,null,null,null);n["a"]=p.exports},"18cb":function(t,n,e){"use strict";e("d03b")},"1a92":function(t,n,e){},"3cfe":function(t,n,e){"use strict";e("7e63")},"61a1":function(t,n,e){"use strict";e("1a92")},"7e63":function(t,n,e){},"8a28":function(t,n,e){"use strict";e.d(n,"d",(function(){return c})),e.d(n,"c",(function(){return a})),e.d(n,"b",(function(){return r})),e.d(n,"e",(function(){return s})),e.d(n,"f",(function(){return o})),e.d(n,"a",(function(){return u}));var i=e("41cb");function c(t){return Object(i["a"])().get("/api/cms/app/item-plan",{params:t}).then((function(t){return t.data.data}))}function a(t){return Object(i["a"])().get("/api/cms/app/item-plan/".concat(t)).then((function(t){return t.data.data}))}function r(t){return Object(i["a"])().delete("/api/cms/app/item-plan/".concat(t))}function s(t){return Object(i["a"])().get("/api/cms/app/item-plan/mine",{params:t}).then((function(t){return t.data.data}))}function o(t,n){return Object(i["a"])().put("/api/cms/app/item-plan/".concat(t),n)}function u(t){return Object(i["a"])().post("/api/cms/app/item-plan",t)}},ace4e:function(t,n,e){"use strict";var i=function(){var t=this,n=t._self._c;return n("div",[n("el-drawer",t._b({staticClass:"c-var",staticStyle:{width:"100%"},attrs:{visible:t.visible,direction:"btt","show-close":!1,"with-header":!1,"custom-class":"select-drawer","append-to-body":"",size:"400"},on:{close:t.onClose},scopedSlots:t._u([{key:"default",fn:function(){return[n("div",{staticClass:"c-var m-select-drawer"},[n("div",{staticClass:"m-user-select__title"},[t._v(t._s(t.title))]),n("div",{staticClass:"m-options-list"},t._l(t.options,(function(e,i){return n("div",{key:i,staticClass:"m-options-item",class:{"is-active":e.value===t.value},on:{click:function(n){t.value=e.value}}},[t._v(" "+t._s(e.label)+" "),n("div",{staticClass:"w-mp-checkbox__icon"},[n("div",{staticClass:"w-mp-checkbox__checkmark"})])])})),0),n("div",{staticClass:"m-op"},[n("button",{staticClass:"u-confirm",on:{click:t.onConfirm}},[t._v("确定")])])])]},proxy:!0}])},"el-drawer",t.$attrs,!1))],1)},c=[],a=(e("d3b7"),{name:"SelectDrawer",components:{},props:["menus"],data:function(){return{visible:!1,title:"请选择",options:[],value:null,callback:{}}},computed:{},methods:{open:function(t){var n=this,e=t.options,i=t.title;return this.visible=!0,this.options=e||[],this.title=i||"请选择",new Promise((function(t,e){n.callback={resolve:t,reject:e}}))},onClose:function(){this.visible=!1,this.callback.reject()},onConfirm:function(){this.visible=!1,this.callback.resolve(this.value)}}}),r=a,s=(e("18cb"),e("2877")),o=Object(s["a"])(r,i,c,!1,null,null,null);n["a"]=o.exports},b78a:function(t,n,e){"use strict";e.d(n,"g",(function(){return a})),e.d(n,"a",(function(){return r})),e.d(n,"f",(function(){return s})),e.d(n,"m",(function(){return o})),e.d(n,"i",(function(){return u})),e.d(n,"h",(function(){return l})),e.d(n,"r",(function(){return d})),e.d(n,"j",(function(){return f})),e.d(n,"l",(function(){return p})),e.d(n,"d",(function(){return m})),e.d(n,"p",(function(){return _})),e.d(n,"k",(function(){return h})),e.d(n,"n",(function(){return v})),e.d(n,"o",(function(){return b})),e.d(n,"q",(function(){return g})),e.d(n,"e",(function(){return C})),e.d(n,"c",(function(){return w})),e.d(n,"b",(function(){return k}));e("99af"),e("a15b");var i=e("41cb"),c=Object(i["d"])({mute:!0});function a(t){return Object(i["c"])().get("api/article/favorites/my",{params:t})}function r(t){return Object(i["c"])().delete("api/article/favorites/my/".concat(t))}function s(t){return c.get("api/node/item/menus",{params:t})}function o(t){return c.get("api/node/item/count",{params:t})}function u(t){return c.get("/item/enums",{params:t})}function l(t,n){if(t)return c.get("api/node/item/".concat(t),{params:{client:null!==n&&void 0!==n?n:"std"}})}function d(t,n){if(t)return Object(i["c"])().get("api/item-price/".concat(t,"/detail"),{params:n})}function f(t){if(t.item_id)return Object(i["c"])().post("api/auction/",t)}function p(t){var n,e,i=t.ids instanceof Array?t.ids.join(","):t.ids;return c.get("/item_merged/id/".concat(i),{params:{client:null!==(n=t.client)&&void 0!==n?n:"std",per:null!==(e=t.per)&&void 0!==e?e:20}})}function m(t,n){return c.get("/item_merged/name/".concat(t),{params:n})}function _(t){var n;return c.get("/item/newest",{params:{client:null!==(n=t.client)&&void 0!==n?n:"std"}})}function h(t){return c.get("api/node/item/list",{params:t})}function v(t){return c.get("api/node/item/search",{params:t})}function b(t){return c.get("api/node/item/menu_list",{params:t})}function g(t){return Object(i["a"])().get("/api/cms/wiki/post/waiting",{params:t})}function C(t){return c.get("/manufactures",{params:t})}function w(t){return c.get("/other",{params:t})}function k(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"std";if(t)return c.get("/resource/".concat(n,"/item_merged.").concat(t))}},d03b:function(t,n,e){},dc8a:function(t,n,e){"use strict";var i=function(){var t=this,n=t._self._c;return n("div",{staticClass:"w-mobile-item-card",on:{click:function(n){return t.$emit("click")}}},[n("div",{staticClass:"m-icon-section"},[n("div",{staticClass:"u-quality",class:"quality-".concat(t.item.Quality)}),n("img",{staticClass:"u-icon",attrs:{src:t.iconLink,alt:""}})]),n("div",{staticClass:"m-content-section"},[n("div",{staticClass:"u-primary"},[n("span",{staticClass:"u-name"},[t._v(t._s(t.item.Name))]),t.count?t._e():n("span",{staticClass:"u-id"},[t._v(t._s(t.item.id))]),t.count?n("span",{staticClass:"u-count"},[t._v("x "+t._s(t.count))]):t._e()]),n("div",{staticClass:"u-secondary"},[n("span",{staticClass:"u-desc"},[n("GameText",{attrs:{text:t.item.Desc,ignoreColor:!0,client:t.final_client}})],1)])]),n("div",{staticClass:"m-actions-section",class:{"is-delete":t.showDelete,"is-edit-count":t.showEditCount},on:{click:function(n){return n.stopPropagation(),t.onActionClick.apply(null,arguments)}}},[t.showDelete?[n("i",{staticClass:"u-icon el-icon-close"})]:t.showEditCount?[n("i",{staticClass:"u-icon el-icon-edit"}),n("span",{staticClass:"u-count"},[t._v("x"+t._s(t.count))])]:t._e()],2)])},c=[],a=(e("99af"),e("e9c4"),e("a9e3"),e("b64b"),e("b78a")),r=e("85e4"),s=e("c547"),o={name:"MobileItemCard",components:{GameText:s["a"]},props:{itemId:{type:String,required:!0},client:{type:String,default:null},data:{type:Object,default:function(){}},showDelete:{type:Boolean,default:!1},count:{type:Number,default:0},showEditCount:{type:Boolean,default:!1}},data:function(){return{source:""}},computed:{final_client:function(){return this.client||this.$store.state.client},cache_key:function(){return"item-".concat(this.final_client,"-").concat(this.itemId)},iconLink:function(){var t;return Object(r["l"])(null===(t=this.item)||void 0===t?void 0:t.IconID,this.final_client)},item:function(){return this.data||this.source}},watch:{itemId:{immediate:!0,handler:function(){this.data||this.loadData()}}},methods:{onActionClick:function(){this.showDelete?this.$emit("delete"):this.showEditCount&&this.$emit("edit")},loadData:function(){var t=this;if(!this.data){var n=sessionStorage.getItem(this.cache_key);if(n)try{this.source=JSON.parse(n)}catch(e){}else Object(a["b"])(this.itemId,this.final_client).then((function(n){var e=n.data,i="{}"!==JSON.stringify(e);i?(t.source=e,sessionStorage.setItem(t.cache_key,JSON.stringify(t.source))):t.source=""}))}}}},u=o,l=(e("3cfe"),e("2877")),d=Object(l["a"])(u,i,c,!1,null,null,null);n["a"]=d.exports}}]);